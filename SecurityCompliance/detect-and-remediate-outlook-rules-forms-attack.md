---
title: Обнаружение и исправление правил Outlook и внедрений пользовательских форм в Office 365
ms.author: chrfox
author: chrfox
manager: laurawi
ms.date: 04/23/2018
ms.audience: ITPro
ms.topic: article
ms.collection:
- o365_security_incident_response
- M365-security-compliance
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
description: Сведения о том, как распознать и исправить правила Outlook и функции внедрения пользовательских форм в Office 365
ms.openlocfilehash: 59d45e50e15e3709c8a041ead59b8cc6e2a38306
ms.sourcegitcommit: 0017dc6a5f81c165d9dfd88be39a6bb17856582e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32256867"
---
# <a name="detect-and-remediate-outlook-rules-and-custom-forms-injections-attacks-in-office-365"></a><span data-ttu-id="63bd4-103">Обнаружение атак с внедрением правил и пользовательских форм Outlook и устранение их последствий в Office 365</span><span class="sxs-lookup"><span data-stu-id="63bd4-103">Detect and Remediate Outlook Rules and Custom Forms Injections Attacks in Office 365</span></span>

<span data-ttu-id="63bd4-104">**Сводка** Сведения о том, как распознать и исправить правила Outlook и функции внедрения пользовательских форм в Office 365.</span><span class="sxs-lookup"><span data-stu-id="63bd4-104">**Summary** Learn how to recognize and remediate the Outlook rules and custom Forms injections attacks in Office 365.</span></span>

## <a name="what-is-the-outlook-rules-and-custom-forms-injection-attack"></a><span data-ttu-id="63bd4-105">Что такое "правила Outlook" и "атака с помощью пользовательских форм"?</span><span class="sxs-lookup"><span data-stu-id="63bd4-105">What is the Outlook Rules and Custom Forms injection attack?</span></span>
<span data-ttu-id="63bd4-106">После нарушения учетной записи в вашем клиенте и ее появления, вы можете попытаться вернуться и вернуть его после обнаружения и удаления.</span><span class="sxs-lookup"><span data-stu-id="63bd4-106">After an attacker has breached an account in your tenancy and gets in, they're are going to try and establish a way to stay in or a way to get back in after they are discovered and removed.</span></span> <span data-ttu-id="63bd4-107">Это называется установкой механизма сохранения.</span><span class="sxs-lookup"><span data-stu-id="63bd4-107">This is called establishing a persistence mechanism.</span></span> <span data-ttu-id="63bd4-108">Это можно сделать двумя способами: с помощью правил Outlook или путем добавления настраиваемых форм в Outlook.</span><span class="sxs-lookup"><span data-stu-id="63bd4-108">Two ways that they can do this are by exploiting Outlook rules or by injecting custom forms into Outlook.</span></span>
<span data-ttu-id="63bd4-109">В обоих случаях правило или форма синхронизируются от облачной службы к клиентскому рабочему столу, поэтому полный формат и повторная установка клиентского программного обеспечения не устраняют механизм внедрения.</span><span class="sxs-lookup"><span data-stu-id="63bd4-109">In both cases, the rule or form is synced from the cloud service down to the desktop client, so a full format and re-install of the client software doesn't eliminate the injection mechanism.</span></span> <span data-ttu-id="63bd4-110">Это связано с тем, что когда клиентское программное обеспечение Outlook повторно подключается к почтовому ящику в облаке, будут повторно загружены правила и формы из облака.</span><span class="sxs-lookup"><span data-stu-id="63bd4-110">This is because when the Outlook client software reconnects to the mailbox in the cloud it will re-download the rules and forms from the cloud.</span></span> <span data-ttu-id="63bd4-111">Когда правила и формы будут готовы, злоумышленник использует их для выполнения удаленного или пользовательского кода, как правило, для установки вредоносных программ на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="63bd4-111">Once the rules and forms are in place, the attacker uses them to execute remote or custom code, usually to install malware on the local machine.</span></span> <span data-ttu-id="63bd4-112">Вредоносные программы повторно заменяют учетные данные или выполняют другие незаконные действия.</span><span class="sxs-lookup"><span data-stu-id="63bd4-112">The malware then re-steals credentials or performs other illicit activity.</span></span> <span data-ttu-id="63bd4-113">Хорошая новость заключается в том, что если вы захотите, чтобы ваши клиенты были обновлены до последней версии, вы не подвержены воздействию угроз как текущие клиенты Outlook по умолчанию блокируют оба этих механизма.</span><span class="sxs-lookup"><span data-stu-id="63bd4-113">The good news here is that if you keep your clients patched to the latest version, you are not vulnerable to the threat as current Outlook client defaults block both mechanisms.</span></span> 

<span data-ttu-id="63bd4-114">Как правило, атаки выполняются по следующим шаблонам:</span><span class="sxs-lookup"><span data-stu-id="63bd4-114">The attacks typically follow these patterns:</span></span>

<span data-ttu-id="63bd4-115">Правила использования</span><span class="sxs-lookup"><span data-stu-id="63bd4-115">The Rules Exploit</span></span>
1. <span data-ttu-id="63bd4-116">Злоумышленник получает имя пользователя и пароль одного из пользователей.</span><span class="sxs-lookup"><span data-stu-id="63bd4-116">The attacker steals the username and password of one of your users.</span></span>
2. <span data-ttu-id="63bd4-117">Затем злоумышленник подписывается на почтовый ящик Exchange пользователя.</span><span class="sxs-lookup"><span data-stu-id="63bd4-117">The attacker then signs in to that users Exchange mailbox.</span></span> <span data-ttu-id="63bd4-118">Почтовый ящик может находиться в Exchange Online или в локальной среде Exchange.</span><span class="sxs-lookup"><span data-stu-id="63bd4-118">The mailbox can either be in Exchange online or in Exchange on-premises.</span></span>
3. <span data-ttu-id="63bd4-119">Затем злоумышленник создает правило пересылки в почтовом ящике, которое запускается, когда почтовый ящик получает сообщение электронной почты, которое соответствует условиям правила.</span><span class="sxs-lookup"><span data-stu-id="63bd4-119">The attacker then creates a forwarding rule in the mailbox that is triggered when the mailbox receives an email that matches the criteria of the rule.</span></span> <span data-ttu-id="63bd4-120">Критерии правила и содержимого для триггерной электронной почты настроены для друг друга.</span><span class="sxs-lookup"><span data-stu-id="63bd4-120">The criteria of rule and the contents of the trigger email are tailor-made for each other.</span></span>
4. <span data-ttu-id="63bd4-121">Злоумышленник отправляет сообщение электронной почты пользователю, который использует свой почтовый ящик обычным образом.</span><span class="sxs-lookup"><span data-stu-id="63bd4-121">The attacker sends the trigger email to the user who is using their mailbox normally.</span></span>
5. <span data-ttu-id="63bd4-122">При получении сообщения электронной почты запускается правило.</span><span class="sxs-lookup"><span data-stu-id="63bd4-122">When the email is received, the rule is triggered.</span></span> <span data-ttu-id="63bd4-123">Действие правила обычно запускает приложение на удаленном сервере (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="63bd4-123">The action of the rule is usually to launch an application on a remote (WebDAV) server.</span></span>
6. <span data-ttu-id="63bd4-124">Приложение обычно устанавливает вредоносные программы, такие как [PowerShell емпире](https://www.powershellempire.com/), на компьютере пользователя.</span><span class="sxs-lookup"><span data-stu-id="63bd4-124">The application typically installs malware, such as [Powershell Empire](https://www.powershellempire.com/), locally on the user’s machine.</span></span>
7. <span data-ttu-id="63bd4-125">С помощью вредоносных программ злоумышленник может повторно украсть имя пользователя и пароль, а также другие учетные данные с локального компьютера и выполнять другие вредоносные действия.</span><span class="sxs-lookup"><span data-stu-id="63bd4-125">The malware allows the attacker to re-steal the user’s username and password or other credentials from local machine and perform other malicious activities.</span></span>

<span data-ttu-id="63bd4-126">Средства использования форм</span><span class="sxs-lookup"><span data-stu-id="63bd4-126">The Forms Exploit</span></span>
1. <span data-ttu-id="63bd4-127">Злоумышленник получает имя пользователя и пароль одного из пользователей.</span><span class="sxs-lookup"><span data-stu-id="63bd4-127">The attacker steals the username and password of one of your users.</span></span>
2. <span data-ttu-id="63bd4-128">Затем злоумышленник Войдите в почтовый ящик Exchange пользователя.</span><span class="sxs-lookup"><span data-stu-id="63bd4-128">The attacker then sign in to that users Exchange mailbox.</span></span> <span data-ttu-id="63bd4-129">Почтовый ящик может находиться в Exchange Online или в локальной среде Exchange.</span><span class="sxs-lookup"><span data-stu-id="63bd4-129">The mailbox can either be in Exchange online or in Exchange on-premises.</span></span>
3. <span data-ttu-id="63bd4-130">Затем злоумышленник создает настраиваемый шаблон формы почты и вставляет его в почтовый ящик пользователя.</span><span class="sxs-lookup"><span data-stu-id="63bd4-130">The attacker then creates a custom mail form template and inserts it into the user’s mailbox.</span></span>  <span data-ttu-id="63bd4-131">Настраиваемая форма запускается, когда почтовый ящик получает сообщение электронной почты, которое требует от почтового ящика загрузки настраиваемой формы.</span><span class="sxs-lookup"><span data-stu-id="63bd4-131">The custom form is triggered when the mailbox receives an email that requires the mailbox to load the custom form.</span></span> <span data-ttu-id="63bd4-132">Настраиваемая форма и формат электронной почты настроены для друг друга.</span><span class="sxs-lookup"><span data-stu-id="63bd4-132">The custom form and the format of email are tailor-made for each other.</span></span>
4. <span data-ttu-id="63bd4-133">Злоумышленник отправляет пользователю триггер электронной почты, который использует свой почтовый ящик обычным образом.</span><span class="sxs-lookup"><span data-stu-id="63bd4-133">The attacker sends the trigger email to the user, who is using their mailbox normally.</span></span>
5. <span data-ttu-id="63bd4-134">При получении сообщения электронной почты загружается форма.</span><span class="sxs-lookup"><span data-stu-id="63bd4-134">When the email is received, the form is loaded.</span></span> <span data-ttu-id="63bd4-135">Форма запускает приложение на удаленном сервере (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="63bd4-135">The form launches an application on a remote (WebDAV) server.</span></span>
6. <span data-ttu-id="63bd4-136">Приложение обычно устанавливает вредоносные программы, такие как [PowerShell емпире](https://www.powershellempire.com/), на компьютере пользователя.</span><span class="sxs-lookup"><span data-stu-id="63bd4-136">The application typically installs malware, such as [Powershell Empire](https://www.powershellempire.com/), locally on the user’s machine.</span></span>
7. <span data-ttu-id="63bd4-137">С помощью вредоносных программ злоумышленник может повторно украсть имя пользователя и пароль, а также другие учетные данные с локального компьютера и выполнять другие вредоносные действия.</span><span class="sxs-lookup"><span data-stu-id="63bd4-137">The malware allows the attacker to re-steal the user’s username and password or other credentials from local machine and perform other malicious activities.</span></span>


## <a name="what-a-rules-and-custom-forms-injection-attack-might-look-like-office-365"></a><span data-ttu-id="63bd4-138">Как могут выглядеть правила и возможность внедрения пользовательских форм, например Office 365?</span><span class="sxs-lookup"><span data-stu-id="63bd4-138">What a Rules and Custom Forms Injection attack might look like Office 365?</span></span>

<span data-ttu-id="63bd4-139">Эти механизмы сохранения вряд ли будут замечены пользователями, и в некоторых случаях они даже могут быть невидимы.</span><span class="sxs-lookup"><span data-stu-id="63bd4-139">These persistence mechanisms are unlikely to be noticed by your users and may in some cases even be invisible to them.</span></span>  <span data-ttu-id="63bd4-140">В этой статье рассказывается, как найти любой из семи знаков (индикаторов компромиссов), перечисленных ниже.</span><span class="sxs-lookup"><span data-stu-id="63bd4-140">This article tells you how to look for any of the seven signs (Indicators of Compromise) listed below.</span></span> <span data-ttu-id="63bd4-141">Если вы нашли какое-либо из этих данных, выполните действия по устранению неполадок.</span><span class="sxs-lookup"><span data-stu-id="63bd4-141">If you find any of these, you need to take remediation steps.</span></span>

- <span data-ttu-id="63bd4-142">Признаки компромисса правил</span><span class="sxs-lookup"><span data-stu-id="63bd4-142">Indicators of the Rules compromise</span></span>
    - <span data-ttu-id="63bd4-143">Действие правила заключается в запуске приложения.</span><span class="sxs-lookup"><span data-stu-id="63bd4-143">Rule Action is to start an application.</span></span>
    - <span data-ttu-id="63bd4-144">Правило ссылается на файл EXE, ZIP или URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="63bd4-144">Rule References an EXE, ZIP, or URL.</span></span>
    - <span data-ttu-id="63bd4-145">На локальном компьютере найдите новый процесс, который начинается с PID Outlook.</span><span class="sxs-lookup"><span data-stu-id="63bd4-145">On the local machine, look for new process starts that originate from the Outlook PID.</span></span>
- <span data-ttu-id="63bd4-146">Индикаторы раскрытие настраиваемых форм</span><span class="sxs-lookup"><span data-stu-id="63bd4-146">Indicators of the Custom forms compromise</span></span> 
    - <span data-ttu-id="63bd4-147">Настраиваемая форма сохранена в качестве собственного класса сообщений.</span><span class="sxs-lookup"><span data-stu-id="63bd4-147">Custom form present saved as their own message class.</span></span>
    - <span data-ttu-id="63bd4-148">Класс Message содержит исполняемый код.</span><span class="sxs-lookup"><span data-stu-id="63bd4-148">Message class contains executable code.</span></span>
    - <span data-ttu-id="63bd4-149">Обычно хранится в библиотеке личных форм или папках "Входящие".</span><span class="sxs-lookup"><span data-stu-id="63bd4-149">Usually stored in Personal Forms Library or Inbox folders.</span></span>
    - <span data-ttu-id="63bd4-150">Форма называется IPM. Ноте. [имя пользователя].</span><span class="sxs-lookup"><span data-stu-id="63bd4-150">Form is named IPM.Note.[custom name].</span></span>

## <a name="steps-for-finding-signs-of-this-attack-and-confirming-it"></a><span data-ttu-id="63bd4-151">Действия, которые следует выполнить, чтобы найти признаки этой атаки и подтвердить ее</span><span class="sxs-lookup"><span data-stu-id="63bd4-151">Steps for finding signs of this attack and confirming it</span></span>
<span data-ttu-id="63bd4-152">Для подтверждения атаки можно использовать любой из этих двух способов.</span><span class="sxs-lookup"><span data-stu-id="63bd4-152">You can use either of these two methods to confirm the attack.</span></span>
- <span data-ttu-id="63bd4-153">Вручную Проанализируйте правила и формы для каждого почтового ящика с помощью клиента Outlook.</span><span class="sxs-lookup"><span data-stu-id="63bd4-153">Manually examine the rules and forms for each mailbox using the Outlook client.</span></span>  <span data-ttu-id="63bd4-154">Этот метод является исчерпывающим, но вы можете только проверить пользователя почтового ящика, что может занять много времени, если у вас много пользователей для проверки.</span><span class="sxs-lookup"><span data-stu-id="63bd4-154">This method is thorough, but you can only check mailbox user at a time which can be very time consuming if you have many users to check.</span></span>  <span data-ttu-id="63bd4-155">Кроме того, это может привести к нарушению работы компьютера, на котором выполняется проверка.</span><span class="sxs-lookup"><span data-stu-id="63bd4-155">It can also result in a breach of the computer that you are running the check from.</span></span>
- <span data-ttu-id="63bd4-156">Используйте сценарий PowerShell [жет-аллтенантрулесандформс. ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) для автоматического дампа всех правил переадресации почты и настраиваемых форм для всех пользователей в вашем клиенте.</span><span class="sxs-lookup"><span data-stu-id="63bd4-156">Use the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script to automatically dump all the mail forwarding rules and custom forms for all the users in your tenancy.</span></span> <span data-ttu-id="63bd4-157">Это самый быстрый и безопасный метод с минимальным количеством издержек.</span><span class="sxs-lookup"><span data-stu-id="63bd4-157">This is the fastest and safest method with the least amount of overhead.</span></span>


### <a name="confirm-the-rules-attack-using-the-outlook-client"></a><span data-ttu-id="63bd4-158">Подтверждение атаки на правила с помощью клиента Outlook</span><span class="sxs-lookup"><span data-stu-id="63bd4-158">Confirm the Rules Attack Using the Outlook client</span></span>
1. <span data-ttu-id="63bd4-159">Откройте клиент Outlook "Пользователи" в качестве пользователя.</span><span class="sxs-lookup"><span data-stu-id="63bd4-159">Open the users Outlook client as the user.</span></span>  <span data-ttu-id="63bd4-160">Пользователю может потребоваться помощь в анализе правил почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="63bd4-160">The user may need your help in examining the rules on their mailbox.</span></span>
2. <span data-ttu-id="63bd4-161">Сведения об [управлении сообщениями электронной почты](https://support.office.com/article/manage-email-messages-by-using-rules-c24f5dea-9465-4df4-ad17-a50704d66c59#ID0EAABAAA=2010) можно найти в статье Rules for the Rules for a The Rules in a 2007, 2010 или 2013 версии Outlook.</span><span class="sxs-lookup"><span data-stu-id="63bd4-161">Refer to [Manage email messages by using rules](https://support.office.com/article/manage-email-messages-by-using-rules-c24f5dea-9465-4df4-ad17-a50704d66c59#ID0EAABAAA=2010) article for the procedures on how to open the rules interface in either the 2007, 2010 or 2013 versions of Outlook.</span></span>
3. <span data-ttu-id="63bd4-162">Найдите правила, которые пользователь не создал, или некоторые непредусмотренные правила или правила с подозрительными именами.</span><span class="sxs-lookup"><span data-stu-id="63bd4-162">Look for rules that the user did not create, or any unexpected rules or rules with suspicious names.</span></span>
4. <span data-ttu-id="63bd4-163">Просмотрите описание правила для действий правил, которые запускаются и заменяют или ссылаются на. EXE,. ZIP-файл или для запуска URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="63bd4-163">Look in the rule description for rule actions that start and application or refer to an .EXE, .ZIP file or to launching a URL.</span></span>
5. <span data-ttu-id="63bd4-164">Ищите все новые процессы, которые начинаются с идентификатора процесса Outlook.</span><span class="sxs-lookup"><span data-stu-id="63bd4-164">Look for any new processes that start using the Outlook process ID.</span></span>  <span data-ttu-id="63bd4-165">Обратитесь к разделу [Find ID процесса](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id).</span><span class="sxs-lookup"><span data-stu-id="63bd4-165">Refer to [Find the Process ID](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id).</span></span>

### <a name="steps-to-confirm-the-forms-attack-using-the-outlook-client"></a><span data-ttu-id="63bd4-166">Действия по подтверждению атак на формы с помощью клиента Outlook</span><span class="sxs-lookup"><span data-stu-id="63bd4-166">Steps to confirm the Forms attack using the Outlook client</span></span>
1. <span data-ttu-id="63bd4-167">Откройте клиент Outlook для пользователя.</span><span class="sxs-lookup"><span data-stu-id="63bd4-167">Open the user Outlook client as the user.</span></span>
2. <span data-ttu-id="63bd4-168">Выполните действия, описанные в разделе ["Отображение вкладки" Разработчик "](https://support.office.com/article/show-the-developer-tab-e1192344-5e56-4d45-931b-e5fd9bea2d45) для версии Outlook" Пользователи ".</span><span class="sxs-lookup"><span data-stu-id="63bd4-168">Follow the steps in, [Show the Developer tab](https://support.office.com/article/show-the-developer-tab-e1192344-5e56-4d45-931b-e5fd9bea2d45) for the users version of Outlook.</span></span>
3. <span data-ttu-id="63bd4-169">Откройте вкладку Разработчик видимой формы в Outlook и щелкните **создать форму**.</span><span class="sxs-lookup"><span data-stu-id="63bd4-169">Open the now visible developer tab in Outlook and click **design a form**.</span></span>
4. <span data-ttu-id="63bd4-170">Выберите **папку "Входящие"** в списке **Искать в** .</span><span class="sxs-lookup"><span data-stu-id="63bd4-170">Select the **Inbox** from the **Look In** list.</span></span> <span data-ttu-id="63bd4-171">Поиск настраиваемых форм.</span><span class="sxs-lookup"><span data-stu-id="63bd4-171">Look for any custom forms.</span></span>  <span data-ttu-id="63bd4-172">Настраиваемые формы достаточно редки, если у вас есть настраиваемые формы, что стоит более глубокое представление.</span><span class="sxs-lookup"><span data-stu-id="63bd4-172">Custom forms are rare enough that if you have any custom forms at all, it is worth a deeper look.</span></span>
5. <span data-ttu-id="63bd4-173">ИзУчите все настраиваемые формы, особенно помеченные как скрытые.</span><span class="sxs-lookup"><span data-stu-id="63bd4-173">Investigate any custom forms, especially those marked as hidden.</span></span>
6. <span data-ttu-id="63bd4-174">Откройте все настраиваемые формы и в группе **форма** щелкните **Просмотр кода** , чтобы увидеть, что происходит при загрузке формы.</span><span class="sxs-lookup"><span data-stu-id="63bd4-174">Open any custom forms and in the **Form** group click **View Code** to see what runs when the form is loaded.</span></span>

### <a name="steps-to-confirm-the-rules-and-forms-attack-using-powershell"></a><span data-ttu-id="63bd4-175">Действия по подтверждению атак на правила и формы с помощью PowerShell</span><span class="sxs-lookup"><span data-stu-id="63bd4-175">Steps to confirm the Rules and Forms attack using PowerShell</span></span>
<span data-ttu-id="63bd4-176">Самый простой способ проверить правила или атаку пользовательских форм — запустить сценарий PowerShell [жет-аллтенантрулесандформс. ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) .</span><span class="sxs-lookup"><span data-stu-id="63bd4-176">The simplest way to verify a rules or custom forms attack is to run the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script.</span></span>  <span data-ttu-id="63bd4-177">Этот сценарий подключается к каждому почтовому ящику в клиенте и копирует все правила и формы в два CSV-файла.</span><span class="sxs-lookup"><span data-stu-id="63bd4-177">This script connects to every mailbox in your tenant and dumps all the rules and forms into two .csv files.</span></span>

#### <a name="pre-requisites"></a><span data-ttu-id="63bd4-178">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="63bd4-178">Pre-requisites</span></span>
<span data-ttu-id="63bd4-179">Для запуска скрипта вам потребуется иметь права глобального администратора, так как сценарий подключается к каждому почтовому ящику в клиенте для чтения правил и форм.</span><span class="sxs-lookup"><span data-stu-id="63bd4-179">You will need to have a global administrator rights to run the script because the script connects to every mailbox in the tenancy to read the rules and forms.</span></span>

1. <span data-ttu-id="63bd4-180">Войдите на компьютер, на котором будет выполняться сценарий с правами локального администратора.</span><span class="sxs-lookup"><span data-stu-id="63bd4-180">Sign in to the machine that you will run the script from with local administrator rights.</span></span>
2. <span data-ttu-id="63bd4-181">Скачайте или скопируйте сценарий жет-аллтенантрулесандформс. ps1 из GitHub в папку, из которой она будет запускаться.</span><span class="sxs-lookup"><span data-stu-id="63bd4-181">Download or copy the Get-AllTenantRulesAndForms.ps1 script from GitHub to a folder from which you will run it.</span></span>  <span data-ttu-id="63bd4-182">Сценарий создаст два файла с метками даты в этой папке, Маилбоксформсекспорт-ИИИИ-мм-дд. csv и Маилбоксрулесекспорт-ИИИИ-мм-дд. csv.</span><span class="sxs-lookup"><span data-stu-id="63bd4-182">The script will create two date stamped files to this folder, MailboxFormsExport-yyyy-mm-dd.csv, and MailboxRulesExport-yyyy-mm-dd.csv.</span></span>
3. <span data-ttu-id="63bd4-183">Откройте экземпляр PowerShell от имени администратора и откройте папку, в которой сохранен сценарий.</span><span class="sxs-lookup"><span data-stu-id="63bd4-183">Open a PowerShell instance as an administrator and open the folder you saved the script to.</span></span>
4. <span data-ttu-id="63bd4-184">Выполните следующую команду PowerShell, выполнив `.\Get-AllTenantRulesAndForms.ps1`указанные ниже .\Get-AllTenantRulesAndForms.ps1</span><span class="sxs-lookup"><span data-stu-id="63bd4-184">Run this PowerShell command line as follows `.\Get-AllTenantRulesAndForms.ps1`.\Get-AllTenantRulesAndForms.ps1</span></span>

#### <a name="interpreting-the-output"></a><span data-ttu-id="63bd4-185">Интерпретация выходных данных</span><span class="sxs-lookup"><span data-stu-id="63bd4-185">Interpreting the output</span></span>

<span data-ttu-id="63bd4-186">Маилбоксрулесекспорт-*гггг-мм-дд*. csv — изучите правила (по одному для каждой строки) для условий действий, включающих приложения или исполняемые файлы.</span><span class="sxs-lookup"><span data-stu-id="63bd4-186">MailboxRulesExport-*yyyy-mm-dd*.csv – examine the rules (one per row) for action conditions that include applications or executables.</span></span>
- <span data-ttu-id="63bd4-187">Тип объекта (столбец A) — Если отображается значение "ИД_АКТИОН_КУСТОМ", то правило, скорее всего, является вредоносным.</span><span class="sxs-lookup"><span data-stu-id="63bd4-187">ActionType (column A) – if you see the value “ID_ACTION_CUSTOM”, the rule is likely malicious.</span></span>
- <span data-ttu-id="63bd4-188">ИспотентиаллималиЦиаус (столбец D) — если это значение "TRUE", правило, скорее всего, является вредоносным.</span><span class="sxs-lookup"><span data-stu-id="63bd4-188">IsPotentiallyMalicious (column D) – if this value is “TRUE”, the rule is likely malicious.</span></span>
- <span data-ttu-id="63bd4-189">Актионкомманд (столбец G) — при наличии в списке приложения или любого файла с расширением exe, ZIP или записью, ссылающейся на URL-адрес, это правило, скорее всего, является вредоносным.</span><span class="sxs-lookup"><span data-stu-id="63bd4-189">ActionCommand (column G) – if this lists an application or any file with a .exe, .zip extension or an entry that refers to a URL, that is not supposed to be there, the rule is likely malicious.</span></span>

<span data-ttu-id="63bd4-190">Маилбоксформсекспорт-*гггг-мм-дд*. csv — в общем случае использование настраиваемых форм очень редко.</span><span class="sxs-lookup"><span data-stu-id="63bd4-190">MailboxFormsExport-*yyyy-mm-dd*.csv – in general, the use of custom forms is very rare.</span></span>  <span data-ttu-id="63bd4-191">Если вы найдете в этой книге, вы открываете его почтовый ящик и изучаете форму.</span><span class="sxs-lookup"><span data-stu-id="63bd4-191">If you find any in this workbook, you open that user’s mailbox and examine the form itself.</span></span>  <span data-ttu-id="63bd4-192">Если ваша организация не предоставила ее намеренно, вероятно, она является вредоносной.</span><span class="sxs-lookup"><span data-stu-id="63bd4-192">If your organization did not put it there intentionally, it is likely malicious.</span></span>



## <a name="how-to-stop-and-remediate-the-outlook-rules-and-forms-attack"></a><span data-ttu-id="63bd4-193">Как остановить и исправить атаку для правил и форм Outlook</span><span class="sxs-lookup"><span data-stu-id="63bd4-193">How to stop and remediate the Outlook Rules and Forms attack</span></span>
<span data-ttu-id="63bd4-194">Если вы обнаружите какое-либо свидетельство этих атак, это просто удалите правило или форму из почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="63bd4-194">If you find any evidence of either of these attacks, remediation is simple, just delete the rule or form from the mailbox.</span></span> <span data-ttu-id="63bd4-195">Для удаления правил можно использовать клиент Outlook или удаленная оболочка PowerShell.</span><span class="sxs-lookup"><span data-stu-id="63bd4-195">You can do this with the Outlook client or using remote PowerShell to remove rules.</span></span>

### <a name="using-outlook"></a><span data-ttu-id="63bd4-196">Использование Outlook</span><span class="sxs-lookup"><span data-stu-id="63bd4-196">Using Outlook</span></span>
1. <span data-ttu-id="63bd4-197">Определите все устройства, используемые пользователем в Outlook.</span><span class="sxs-lookup"><span data-stu-id="63bd4-197">Identify all the devices that the user has used with Outlook.</span></span>  <span data-ttu-id="63bd4-198">Все они должны быть очищены от потенциальных вредоносных программ.</span><span class="sxs-lookup"><span data-stu-id="63bd4-198">They will all need to be cleaned of potential malware.</span></span>  <span data-ttu-id="63bd4-199">Не разрешать пользователю выполнять вход и использовать электронную почту, пока все устройства не будут очищены.</span><span class="sxs-lookup"><span data-stu-id="63bd4-199">Do not allow the user to sign on and use email until all the devices are cleaned.</span></span>
2. <span data-ttu-id="63bd4-200">Выполните действия, описанные в разделе [Удаление правила](https://support.office.com/article/Delete-a-rule-2F0E7139-F696-4422-8498-44846DB9067F) для каждого устройства.</span><span class="sxs-lookup"><span data-stu-id="63bd4-200">Follow the steps in [Delete a rule](https://support.office.com/article/Delete-a-rule-2F0E7139-F696-4422-8498-44846DB9067F) for each device.</span></span>
3. <span data-ttu-id="63bd4-201">Если вы не знаете о присутствии других вредоносных программ, вы можете отформатировать и повторно установить все программное обеспечение на устройстве.</span><span class="sxs-lookup"><span data-stu-id="63bd4-201">If you are unsure about the presence of other malware, you can format and re-install all the software on the device.</span></span>  <span data-ttu-id="63bd4-202">Для мобильных устройств вы можете выполнить действия производителя, чтобы вернуть устройство к заводским изображениям.</span><span class="sxs-lookup"><span data-stu-id="63bd4-202">For mobile devices you can follow the manufacturers steps to reset the device to the factory image.</span></span>
4. <span data-ttu-id="63bd4-203">Установите последние версии Outlook.</span><span class="sxs-lookup"><span data-stu-id="63bd4-203">Install the most up-to-date versions of Outlook.</span></span>  <span data-ttu-id="63bd4-204">Помните, что текущая версия Outlook блокирует оба типа этой атаки по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="63bd4-204">Remember that the current version of Outlook blocks both types of this attack by default.</span></span>
5. <span data-ttu-id="63bd4-205">После удаления всех автономных копий почтового ящика выполните сброс пароля пользователя (используйте высококачественную проверку подлинности) и выполните действия, описанные в статье [Настройка многофакторной проверки подлинности для пользователей Office 365](https://support.office.com/article/Set-up-multi-factor-authentication-for-Office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6) , если MFA еще не включен.</span><span class="sxs-lookup"><span data-stu-id="63bd4-205">Once all offline copies of the mailbox have been removed, reset the user's password (use a high-quality one) and follow the steps in [Setup multi-factor authentication for Office 365 users](https://support.office.com/article/Set-up-multi-factor-authentication-for-Office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6) if MFA has not already been enabled.</span></span> <span data-ttu-id="63bd4-206">Это гарантирует, что учетные данные пользователя не будут видны с помощью других средств (таких как фишинг или повторное использование пароля).</span><span class="sxs-lookup"><span data-stu-id="63bd4-206">This ensures that the user's credentials are not exposed via other means (such as phishing or password re-use).</span></span>

### <a name="using-powershell"></a><span data-ttu-id="63bd4-207">Использование PowerShell</span><span class="sxs-lookup"><span data-stu-id="63bd4-207">Using PowerShell</span></span>
<span data-ttu-id="63bd4-208">Существует два удаленных командлетов PowerShell, которые можно использовать для удаления или отключения опасных правил.</span><span class="sxs-lookup"><span data-stu-id="63bd4-208">There are two remote PowerShell cmdlets you can use to remove or disable dangerous rules.</span></span> <span data-ttu-id="63bd4-209">Следуйте инструкциям.</span><span class="sxs-lookup"><span data-stu-id="63bd4-209">Just follow the steps.</span></span>
 
<span data-ttu-id="63bd4-210">Действия для почтовых ящиков на сервере Exchange Server</span><span class="sxs-lookup"><span data-stu-id="63bd4-210">Steps for mailboxes that are on an Exchange server</span></span>

1. <span data-ttu-id="63bd4-211">Подключитесь к серверу Exchange Server с помощью удаленной оболочки PowerShell.</span><span class="sxs-lookup"><span data-stu-id="63bd4-211">Connect to the Exchange server using remote PowerShell.</span></span> <span data-ttu-id="63bd4-212">Выполните действия, описанные в разделе [Подключение к серверам Exchange с помощью удаленной оболочки PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-server/connect-to-exchange-servers-using-remote-powershell?view=exchange-ps).</span><span class="sxs-lookup"><span data-stu-id="63bd4-212">Follow the steps in [Connect to Exchange servers using remote PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-server/connect-to-exchange-servers-using-remote-powershell?view=exchange-ps).</span></span>
2. <span data-ttu-id="63bd4-213">Если вы хотите полностью удалить одно правило, несколько правил или все правила из почтового ящика, используйте [командлет Remove – Inbox ](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps), чтобы полностью удалить одно или несколько правил из почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="63bd4-213">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-Inbox Rule cmdlet ](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps)- use this to completely remove one, multiple, or all rules from the mailbox.</span></span>
3. <span data-ttu-id="63bd4-214">Если вы хотите сохранить правило и его содержимое для дальнейшего изучения, используйте [командлет Disable – InboxRule](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx).</span><span class="sxs-lookup"><span data-stu-id="63bd4-214">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule cmdlet](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx).</span></span> 

<span data-ttu-id="63bd4-215">Действия для почтовых ящиков в Exchange Online</span><span class="sxs-lookup"><span data-stu-id="63bd4-215">Steps for mailboxes in Exchange Online</span></span>
1. <span data-ttu-id="63bd4-216">Выполните действия, описанные в статье [Подключение к Exchange Online с помощью PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell?view=exchange-ps).</span><span class="sxs-lookup"><span data-stu-id="63bd4-216">Follow the steps in [Connect to Exchange Online using PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell?view=exchange-ps).</span></span>
2.  <span data-ttu-id="63bd4-217">Если вы хотите полностью удалить одно правило, несколько правил или все правила из почтового ящика, используйте [командлет Remove – Inbox Rule](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps).</span><span class="sxs-lookup"><span data-stu-id="63bd4-217">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-Inbox Rule cmdlet](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps).</span></span>
3.  <span data-ttu-id="63bd4-218">Если вы хотите сохранить правило и его содержимое для дальнейшего изучения, используйте [командлет Disable – InboxRule](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx).</span><span class="sxs-lookup"><span data-stu-id="63bd4-218">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule cmdlet](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx).</span></span> 

## <a name="how-to-minimize-future-attacks"></a><span data-ttu-id="63bd4-219">Как свести к минимуму атаки на будущее</span><span class="sxs-lookup"><span data-stu-id="63bd4-219">How to minimize future attacks</span></span>

### <a name="first-protect-your-accounts"></a><span data-ttu-id="63bd4-220">Первая: Защитите свои учетные записи</span><span class="sxs-lookup"><span data-stu-id="63bd4-220">First: protect your accounts</span></span>

<span data-ttu-id="63bd4-221">Использование правил и форм используется только злоумышленником после кражи или нарушения одной из учетных записей пользователя.</span><span class="sxs-lookup"><span data-stu-id="63bd4-221">The Rules and Forms exploits are only used by an attacker after they have stolen or breached one of your user’s accounts.</span></span> <span data-ttu-id="63bd4-222">Таким образом, первый шаг к предотвращению использования этих эксплойтов в Организации состоит в агрессивной защите учетных записей пользователей.</span><span class="sxs-lookup"><span data-stu-id="63bd4-222">So, your first step to preventing the use of these exploits against your organization is to aggressively protect your user accounts.</span></span>  <span data-ttu-id="63bd4-223">Некоторые из наиболее распространенных способов нарушения безопасности учетных записей — фишинговые атаки или [пароли](http://www.dabcc.com/microsoft-defending-against-password-spray-attacks/) .</span><span class="sxs-lookup"><span data-stu-id="63bd4-223">Some of the most common ways that accounts are breached are through phishing or [password spraying](http://www.dabcc.com/microsoft-defending-against-password-spray-attacks/) attacks.</span></span>



<span data-ttu-id="63bd4-224">Лучший способ защиты учетных записей пользователей и, особенно учетных записей администраторов, — [Настройка многофакторной проверки подлинности для пользователей Office 365](https://support.office.com/article/set-up-multi-factor-authentication-for-office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6).</span><span class="sxs-lookup"><span data-stu-id="63bd4-224">The best way to protect your user accounts, and especially your administrator accounts, is to [set up multi-factor authentication for Office 365 users](https://support.office.com/article/set-up-multi-factor-authentication-for-office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6).</span></span>  <span data-ttu-id="63bd4-225">Кроме того, следует:</span><span class="sxs-lookup"><span data-stu-id="63bd4-225">You should also:</span></span>
<ol>
    <li><span data-ttu-id="63bd4-226">Отслеживайте <a href="https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports">доступ и использование</a>учетных записей пользователей.</span><span class="sxs-lookup"><span data-stu-id="63bd4-226">Monitor how your user accounts are <a href="https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports">accessed and used</a>.</span></span> <span data-ttu-id="63bd4-227">Вы не можете помешать исходному нарушению, но вы Сократите длительность и последствия нарушения, выполнив обнаружение.</span><span class="sxs-lookup"><span data-stu-id="63bd4-227">You may not prevent the initial breach, but you will shorten the duration and the impact of the breach by detecting it sooner.</span></span> <span data-ttu-id="63bd4-228">Вы можете использовать их: <a href="https://support.office.com/article/overview-of-office-365-cloud-app-security-81f0ee9a-9645-45ab-ba56-de9cbccab475">Office 365 Cloud App Security Policies</a> для мониторинга учетных записей и оповещения о необычных действиях.</span><span class="sxs-lookup"><span data-stu-id="63bd4-228">You can use these: <a href="https://support.office.com/article/overview-of-office-365-cloud-app-security-81f0ee9a-9645-45ab-ba56-de9cbccab475"> Office 365 Cloud App Security policies</a> to monitor you accounts and alert on unusual activity.</span></span> 
        <ol type="a">
            <li><span data-ttu-id="63bd4-229"><b>Несколько неудачных попыток входа</b> Эта политика выполняет профили вашей среды и запускает оповещения, когда пользователи выполняют несколько неудачных операций входа в один сеанс с учетом общедоступного базового плана, что может означать неудачное нарушение.</span><span class="sxs-lookup"><span data-stu-id="63bd4-229"><b>Multiple failed login attempts</b> This policy profiles your environment and triggers alerts when users perform multiple failed login activities in a single session with respect to the learned baseline, which could indicate an attempted breach.</span></span></li>
            <li><span data-ttu-id="63bd4-230"><b>Неосуществимое путешествие</b> - Эта политика используется для профилей среды и запускает оповещения при обнаружении действий от одного и того же пользователя в различных расположениях в течение периода времени, который меньше, чем ожидаемое время поездки между двумя местоположениями.</span><span class="sxs-lookup"><span data-stu-id="63bd4-230"><b>Impossible travel</b> - This policy profiles your environment and triggers alerts when activities are detected from the same user in different locations within a time period that is shorter than the expected travel time between the two locations.</span></span> <span data-ttu-id="63bd4-231">Это может указывать на то, что другой пользователь использует одни и те же учетные данные.</span><span class="sxs-lookup"><span data-stu-id="63bd4-231">This could indicate that a different user is using the same credentials.</span></span> <span data-ttu-id="63bd4-232">Чтобы определить это необычное поведение, вам следует начальный период обучения в семь дней, в течение которого он узнает о новом шаблоне действий пользователя.</span><span class="sxs-lookup"><span data-stu-id="63bd4-232">Detecting this anomalous behavior necessitates an initial learning period of seven days during which it learns a new user’s activity pattern.</span></span></li>
            <li><span data-ttu-id="63bd4-233"><b>Необычные действия олицетворения (по пользователям)</b> - Эта политика выполняет профили вашей среды и запускает оповещения, когда пользователи выполняют несколько олицетворенных действий в рамках одного сеанса с учетом базовых изученных значений, что может означать нарушение попытки.</span><span class="sxs-lookup"><span data-stu-id="63bd4-233"><b>Unusual impersonated activity (by user)</b> - This policy profiles your environment and triggers alerts when users perform multiple impersonated activities in a single session with respect to the baseline learned, which could indicate an attempted breach.</span></span></li>
        </ol>
    </li>
    <li><span data-ttu-id="63bd4-234">Используйте средство, аналогичное <a href="https://securescore.office.com/">показателю безопасности Office 365</a> , для управления конфигурацией и поведением безопасности учетных записей.</span><span class="sxs-lookup"><span data-stu-id="63bd4-234">Leverage a tool like the <a href="https://securescore.office.com/">Office 365 Secure Score</a> to manage account security configurations and behaviors.</span></span> 
    </li>
</ol> 

### <a name="second-keep-your-outlook-clients-current"></a><span data-ttu-id="63bd4-235">Second: Оставайтесь в курсе текущих клиентов Outlook</span><span class="sxs-lookup"><span data-stu-id="63bd4-235">Second: Keep your Outlook clients current</span></span>
<span data-ttu-id="63bd4-236">В полностью обновленных и исправленных версиях Outlook 2013 и 2016 отключить действие правила и формы "Запуск приложения" по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="63bd4-236">Fully-updated and patched versions of Outlook 2013, and 2016 disable the “Start Application” rule/form action by default.</span></span>  <span data-ttu-id="63bd4-237">Это гарантирует, что даже если злоумышленник нарушает учетную запись, действия в отношении правил и форм будут блокироваться.</span><span class="sxs-lookup"><span data-stu-id="63bd4-237">This will ensure that, even if an attacker breaches the account, the rule and form actions will be blocked.</span></span>  <span data-ttu-id="63bd4-238">Вы можете установить последние обновления и обновления для системы безопасности, выполнив действия, описанные в [статье Install Office Updates](https://support.office.com/article/Install-Office-updates-2ab296f3-7f03-43a2-8e50-46de917611c5).</span><span class="sxs-lookup"><span data-stu-id="63bd4-238">You can install the latest updates and security patches by following the steps in [Install Office updates](https://support.office.com/article/Install-Office-updates-2ab296f3-7f03-43a2-8e50-46de917611c5).</span></span>

<span data-ttu-id="63bd4-239">Ниже приведены версии исправлений для клиентов Outlook 2013 и 2016:</span><span class="sxs-lookup"><span data-stu-id="63bd4-239">Here are the patch versions for your Outlook 2013 and 2016 clients:</span></span>
- <span data-ttu-id="63bd4-240">Outlook 2013:15.0.4937.1000 или более поздней версии</span><span class="sxs-lookup"><span data-stu-id="63bd4-240">Outlook 2013: 15.0.4937.1000 or greater</span></span>
- <span data-ttu-id="63bd4-241">Outlook 2016:16.0.4534.1001 или более поздней версии</span><span class="sxs-lookup"><span data-stu-id="63bd4-241">Outlook 2016: 16.0.4534.1001 or greater</span></span>

<span data-ttu-id="63bd4-242">Дополнительные сведения об индивидуальных обновлениях для системы безопасности можно найти в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="63bd4-242">For more information on the individual security patches, see:</span></span>

- [<span data-ttu-id="63bd4-243">Исправление для системы безопасности Outlook 2013</span><span class="sxs-lookup"><span data-stu-id="63bd4-243">Outlook 2013 Security Patch</span></span>](https://support.microsoft.com/en-us/help/3191938) 
- [<span data-ttu-id="63bd4-244">Исправление для системы безопасности Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="63bd4-244">Outlook 2016 Security Patch</span></span>](https://support.microsoft.com/en-us/help/3191883)

### <a name="third-monitor-your-outlook-clients"></a><span data-ttu-id="63bd4-245">Третья: мониторинг клиентов Outlook</span><span class="sxs-lookup"><span data-stu-id="63bd4-245">Third: Monitor your Outlook clients</span></span>
<span data-ttu-id="63bd4-246">Обратите внимание, что даже с установленными исправлениями и обновлениями злоумышленник может изменить конфигурацию локального компьютера, чтобы снова включить поведение "запустить приложение".</span><span class="sxs-lookup"><span data-stu-id="63bd4-246">Note that even with the patches and updates installed, it is possible for an attacker to change the local machine configuration to re-enable the “Start Application” behavior.</span></span> <span data-ttu-id="63bd4-247">С помощью [расширенНого управления групповЫми политиками](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) можно отслеживать и применять политики локального компьютера для клиентов.</span><span class="sxs-lookup"><span data-stu-id="63bd4-247">You can use [Advanced Group Policy Management](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) to monitor and enforce local machine policies on your clients.</span></span>  
<span data-ttu-id="63bd4-248">С помощью сведений, приведенных в статье [Просмотр системного реестра с помощью 64 разрядных версий Windows](https://support.microsoft.com/en-us/help/305097/how-to-view-the-system-registry-by-using-64-bit-versions-of-windows), можно проверить, включено ли повторное включение приложения с помощью переопределения в реестре.</span><span class="sxs-lookup"><span data-stu-id="63bd4-248">You can to see if “Start Application” has been re-enabled through an override in the registry by using the information in [How to view the system registry by using 64-bit versions of Windows](https://support.microsoft.com/en-us/help/305097/how-to-view-the-system-registry-by-using-64-bit-versions-of-windows).</span></span>  <span data-ttu-id="63bd4-249">Проверьте следующие подразделы:</span><span class="sxs-lookup"><span data-stu-id="63bd4-249">Check these subkeys:</span></span> 

- <span data-ttu-id="63bd4-250">Outlook 2016: HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\\</span><span class="sxs-lookup"><span data-stu-id="63bd4-250">Outlook 2016: HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\\</span></span>
- <span data-ttu-id="63bd4-251">Outlook 2013: HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\\</span><span class="sxs-lookup"><span data-stu-id="63bd4-251">Outlook 2013: HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\\</span></span>

<span data-ttu-id="63bd4-252">Найдите раздел Енаблеунсафеклиентмаилрулес.</span><span class="sxs-lookup"><span data-stu-id="63bd4-252">Look for the key EnableUnsafeClientMailRules.</span></span> <span data-ttu-id="63bd4-253">Если он есть и имеет значение 1, то исправление для системы безопасности Outlook было переопределено, а компьютер подвержен атакам форм и правил.</span><span class="sxs-lookup"><span data-stu-id="63bd4-253">If it is there and is set to 1, the Outlook security patch has been overridden and the computer is vulnerable to the Form/Rules attack.</span></span> <span data-ttu-id="63bd4-254">Если значение равно 0, действие "Запуск приложения" отключено.</span><span class="sxs-lookup"><span data-stu-id="63bd4-254">If the value is 0, the “Start Application” action is disabled.</span></span>  <span data-ttu-id="63bd4-255">Если на компьютере установлена обновленная и исправленная версия Outlook и этот раздел реестра отсутствует, система не подвержена этим атакам.</span><span class="sxs-lookup"><span data-stu-id="63bd4-255">If the updated and patched version of Outlook is installed and this registry key is not present, then a system is not vulnerable to these attacks.</span></span>

<span data-ttu-id="63bd4-256">Для пользователей с локальными установками Exchange необходимо заблокировать старые версии Outlook, в которых нет доступных исправлений.</span><span class="sxs-lookup"><span data-stu-id="63bd4-256">Customers with on-premises Exchange installations should consider blocking older versions of Outlook that do not have patches available.</span></span> <span data-ttu-id="63bd4-257">Подробные сведения об этом процессе можно найти в статье [Настройка блокирования клиентов Outlook](https://technet.microsoft.com/en-us/library/dd335207(v=exchg.150).aspx).</span><span class="sxs-lookup"><span data-stu-id="63bd4-257">Details on this process can be found in the article [Configure Outlook client blocking](https://technet.microsoft.com/en-us/library/dd335207(v=exchg.150).aspx).</span></span>

## <a name="secure-office-365-like-a-cybersecurity-pro"></a><span data-ttu-id="63bd4-258">Защитите Office 365, как профессионал кибербезопасности</span><span class="sxs-lookup"><span data-stu-id="63bd4-258">Secure Office 365 like a cybersecurity pro</span></span>
<span data-ttu-id="63bd4-259">Ваша подписка на Office 365 сопровождается целым рядом полезных функций безопасности, которые можно использовать для защиты ваших данных и пользователей.</span><span class="sxs-lookup"><span data-stu-id="63bd4-259">Your Office 365 subscription comes with a powerful set of security capabilities that you can use to protect your data and your users.</span></span>  <span data-ttu-id="63bd4-260">Обратитесь к статье [Схема для обеспечения безопасности в Office 365: приоритеты на первые 30 и 90 дней, а также на большее количество дней.](https://support.office.com/article/Office-365-security-roadmap-Top-priorities-for-the-first-30-days-90-days-and-beyond-28c86a1c-e4dd-4aad-a2a6-c768a21cb352) и примените описанные в ней рекомендуемые корпорацией Майкрософт приемы по защите вашего клиента Office 365.</span><span class="sxs-lookup"><span data-stu-id="63bd4-260">Use the [Office 365 security roadmap: Top priorities for the first 30 days, 90 days, and beyond](https://support.office.com/article/Office-365-security-roadmap-Top-priorities-for-the-first-30-days-90-days-and-beyond-28c86a1c-e4dd-4aad-a2a6-c768a21cb352) to implement Microsoft recommended best practices for securing your Office 365 tenant.</span></span>
- <span data-ttu-id="63bd4-261">Задачи для выполнения в первые 30 дней.</span><span class="sxs-lookup"><span data-stu-id="63bd4-261">Tasks to accomplish in the first 30 days.</span></span>  <span data-ttu-id="63bd4-262">Они дают немедленный эффект и не создают помех вашим пользователям.</span><span class="sxs-lookup"><span data-stu-id="63bd4-262">These have immediate affect and are low-impact to your users.</span></span>
- <span data-ttu-id="63bd4-263">Задачи для выполнения в течение 90 дней.</span><span class="sxs-lookup"><span data-stu-id="63bd4-263">Tasks to accomplish in 90 days.</span></span> <span data-ttu-id="63bd4-264">Эти задачи требуют немного больше времени на планирование и реализацию, но значительно укрепляют вашу безопасность.</span><span class="sxs-lookup"><span data-stu-id="63bd4-264">These take a bit more time to plan and implement but greatly improve your security posture.</span></span>
- <span data-ttu-id="63bd4-265">Более 90 дней.</span><span class="sxs-lookup"><span data-stu-id="63bd4-265">Beyond 90 days.</span></span> <span data-ttu-id="63bd4-266">Эти меры дополняют ваши действия в течение первых 90 дней.</span><span class="sxs-lookup"><span data-stu-id="63bd4-266">These enhancements build in your first 90 days work.</span></span>

## <a name="see-also"></a><span data-ttu-id="63bd4-267">См. также:</span><span class="sxs-lookup"><span data-stu-id="63bd4-267">See also:</span></span>
- <span data-ttu-id="63bd4-268">[ВредоносНые правила Outlook](https://silentbreaksecurity.com/malicious-outlook-rules/) с помощью Силентбреак Security POST by Rules предоставляет детальный обзор правил Outlook.</span><span class="sxs-lookup"><span data-stu-id="63bd4-268">[Malicious Outlook Rules](https://silentbreaksecurity.com/malicious-outlook-rules/) by SilentBreak Security Post about Rules Vector provides a detailed review of how the Outlook Rules.</span></span> 
- <span data-ttu-id="63bd4-269">Протокол [MAPI over HTTP и Маилруле пвнаже](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) в блоге Сенсепост о маилруле пвнаже рассказывает об инструменте под названием "линейка", который позволяет использовать почтовые ящики с помощью правил Outlook.</span><span class="sxs-lookup"><span data-stu-id="63bd4-269">[MAPI over HTTP and Mailrule Pwnage ](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) on the Sensepost blog about Mailrule Pwnage discusses a tool called Ruler that lets you exploit mailboxes through Outlook rules.</span></span>
- <span data-ttu-id="63bd4-270">[Формы и оболочки Outlook](https://sensepost.com/blog/2017/outlook-forms-and-shells/) в блоге Сенсепост о векторе угроз для форм.</span><span class="sxs-lookup"><span data-stu-id="63bd4-270">[Outlook forms and shells](https://sensepost.com/blog/2017/outlook-forms-and-shells/) on the Sensepost blog about Forms Threat Vector.</span></span> 
- [<span data-ttu-id="63bd4-271">Кодовая линейка</span><span class="sxs-lookup"><span data-stu-id="63bd4-271">Ruler Codebase</span></span>](https://github.com/sensepost/ruler)
- [<span data-ttu-id="63bd4-272">Индикаторы расКрытие на линейках</span><span class="sxs-lookup"><span data-stu-id="63bd4-272">Ruler Indicators of Compromise</span></span>](https://github.com/sensepost/notruler/blob/master/iocs.md)