---
title: Импорт PST-файлов Организации в Office 365 с помощью отправки по сети
ms.author: markjjo
author: markjjo
manager: laurawi
ms.audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
ms.collection:
- Strat_O365_IP
- M365-security-compliance
search.appverid:
- MOE150
- MED150
- MET150
ms.assetid: 103f940c-0468-4e1a-b527-cc8ad13a5ea6
description: 'Для администраторов: Узнайте, как использовать отправку по сети для массового импорта нескольких PST-файлов в почтовые ящики пользователей в Office 365.'
ms.openlocfilehash: 73123d5f36a01b31cfc38e6404bd400bb722fb36
ms.sourcegitcommit: f0e3c9de0b545081a4d264f74559b941f6c71410
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2019
ms.locfileid: "31958580"
---
# <a name="use-network-upload-to-import-your-organization-pst-files-to-office-365"></a>Импорт PST-файлов Организации в Office 365 с помощью отправки по сети

> [!NOTE]
> Эта статья предназначена для администраторов. Вы пытаетесь импортировать PST-файлы в свой почтовый ящик? [В разделе Импорт электронной почты, контактов и календаря из PST-файла Outlook](https://go.microsoft.com/fwlink/p/?LinkID=785075)
  
Ниже приведены пошаговые инструкции по использованию команды "Отправка по сети" для массового импорта нескольких PST-файлов в почтовые ящики Office 365. Часто задаваемые вопросы об использовании команды "Отправка по сети" для массового импорта PST-файлов в почтовые ящики Office 365 приведены в статье [FAQ по использованию функции отправки по сети для импорта PST-файлов](faqimporting-pst-files-to-office-365.md#using-network-upload-to-import-pst-files).
  
[Шаг 1: Скопируйте URL-адрес SAS и установите Azure AzCopy](#step-1-copy-the-sas-url-and-install-azure-azcopy)

[Шаг 2: отправка PST-файлов в Office 365](#step-2-upload-your-pst-files-to-office-365)

[Необязательно Шаг 3: Просмотр списка PST-файлов, отправленных в Office 365](#optional-step-3-view-a-list-of-the-pst-files-uploaded-to-office-365)

[Шаг 4: создание файла сопоставления для импорта PST-файлов](#step-4-create-the-pst-import-mapping-file)

[Шаг 5: создание задания импорта PST-файла в Office 365](#step-5-create-a-pst-import-job-in-office-365)

[Шаг 6: Фильтрация данных и запуск задания импорта PST-файлов](#step-6-filter-data-and-start-the-pst-import-job)

Обратите внимание, что для импорта PST-файлов в почтовые ящики Office 365 необходимо выполнить шаг 1 только один раз. После выполнения этих действий выполните действия 2 – 6 для каждого файла, чтобы отправить и импортировать пакет PST-файлов.

## <a name="before-you-begin"></a>Перед началом работы
  
- Необходимо назначить роль экспорта для импорта поЧтовых ящиков в Exchange Online, чтобы импортировать PST-файлы в почтовые ящики Office 365. По умолчанию эта роль не назначается ни одной группе ролей в Exchange Online. You can add the Mailbox Import Export role to the Organization Management role group. Or you can create a new role group, assign the Mailbox Import Export role, and then add yourself as a member. Дополнительные сведения можно найти в разделах "Добавление роли в группу ролей" или "Создание группы ролей" в разделе [Управление группами ролей](https://go.microsoft.com/fwlink/p/?LinkId=730688).
    
    Кроме того, для создания заданий импорта в центре безопасности _Амп_ соответствия требованиям необходимо выполнить одно из следующих условий:
    
  - Вы должны быть назначены роли получателей почты в Exchange Online. By default, this role is assigned to the Organization Management and Recipient Management roles groups.
    
    ИЛИ
    
  - Вам необходимо быть глобальным администратором в организации Office 365.
    
  > [!TIP]
    > РасСмотрите возможность создания новой группы ролей в Exchange Online, специально предназначенной для импорта PST-файлов в Office 365. Для доступа к минимальному уровню привилегий, необходимых для импорта PST-файлов, назначьте роли "Импорт импорта почтового ящика" и "Получатели почты" новой группе ролей, а затем добавьте участников. 
  
- Единственный поддерживаемый способ импортировать PST-файлы в Office 365 — использовать средство Azure AzCopy, как описано в этом разделе. Вы не можете использовать Обозреватель хранилищ Azure для отправки PST-файлов непосредственно в область хранилища Azure.
    
- Необходимо хранить PST-файлы, которые необходимо импортировать в Office 365, на файловом сервере или в общей папке в Организации. На шаге 2 вы запустите средство Azure AzCopy, которое будет отправлять PST-файлы, хранящиеся на этом файловом сервере или в общей папке, в Office 365.
    
- Эта процедура включает копирование и сохранение копии URL-адреса, содержащего ключ доступа. Эта информация будет использоваться в шаге 2 для отправки PST-файлов, а в шаге 3, если необходимо просмотреть список PST-файлов, переданных в Office 365. Обязательно примите меры предосторожности, чтобы защитить этот URL-адрес, например, защитить пароли и другие данные, связанные с безопасностью. Например, вы можете сохранить его в защищенном паролем документе Microsoft Word или на зашифрованном USB-накопителе. В разделе [More Information](#more-information) приведен пример комбинированного URL-адреса и ключа. 
    
- Вы можете импортировать PST-файлы в неактивный почтовый ящик в Office 365. Для этого укажите идентификатор GUID неактивного почтового ящика в `Mailbox` параметре в файле сопоставления PST-импорта. Обратитесь к шагу 4 на вкладке **инструкции** в этом разделе. 
    
- В гибридном развертывании Exchange вы можете импортировать PST-файлы в облачный архивный архивный почтовый ящик для пользователя, основной почтовый ящик которого находится в локальной среде. Для этого выполните следующие действия в файле сопоставления PST-импорта:
    
  - Укажите адрес электронной почты для локального почтового ящика пользователя в `Mailbox` параметре. 
    
  - Укажите значение **true** в `IsArchive` параметре. 
    
    Дополнительные сведения см. в [действии 4](#step-4-create-the-pst-import-mapping-file) . 
    
- После импорта PST-файлов в почтовый ящик Office 365 параметр удержания хранения для почтового ящика включается в течение неопределенной длительности. Это означает, что политика хранения, назначенная почтовому ящику, не будет обработана, пока вы не отключите удержание для хранения или не установите дату отключения удержания. Зачем это делать? Если сообщения, импортированные в почтовый ящик, устарели, они могут быть удалены без возможности восстановления (очистка), так как срок их хранения истечет в соответствии с параметрами хранения, настроенными для почтового ящика. Помещение почтового ящика на хранение при хранении предоставит владельцу почтового ящика время, в течение которого будут управляться эти недавно импортированные сообщения, или будет предложено время изменить параметры хранения для почтового ящика. В этом **** разделе представлены рекомендации по управлению удержанием хранения. 
    
- По умолчанию максимальный размер сообщения, который может быть получен в почтовом ящике Office 365, составляет 35 МБ. Это связано с тем, что для свойства *MaxReceiveSize* почтового ящика задано значение 35 МБ. Однако ограничение максимального размера получаемых сообщений в Office 365 составляет 150 МБ. Поэтому при импорте PST-файла, содержащего элемент размером более 35 МБ, служба импорта Office 365 автоматически изменит значение свойства *MaxReceiveSize* в целевом почтовом ящике на 150 МБ. Это позволяет импортировать сообщения размером до 150 МБ в почтовые ящики пользователей. 
    
    > [!TIP]
    > Чтобы определить размер получаемых сообщений для почтового ящика, выполните следующую команду в Exchange Online PowerShell: `Get-Mailbox <user mailbox> | FL MaxReceiveSize`. 

## <a name="step-1-copy-the-sas-url-and-install-azure-azcopy"></a>Шаг 1: Скопируйте URL-адрес SAS и установите Azure AzCopy

Первый шаг — скачать и установить средство Azure AzCopy Tool, которое будет выполняться на этапе 2 для отправки PST-файлов в Office 365. Кроме того, вы также можете скопировать URL-адрес SAS для вашей организации. Этот URL-адрес представляет собой комбинацию сетевого URL-адреса хранилища Azure в облаке Майкрософт для Организации и ключа СОПОСТАВЛЕНИЯ общего доступа (SAS). Этот ключ предоставляет необходимые разрешения для отправки PST-файлов в ваше расположение хранилища Azure. Обязательно примите меры предосторожности, чтобы защитить URL-адрес SAS. Он уникален для вашей организации и будет использоваться в шаге 2.

> [!IMPORTANT]
> Чтобы импортировать PST-файлы с помощью метода отправки по сети, рекомендуется использовать версию Azure AzCopy, которая может быть загружена в действии 6B в следующей процедуре.
  
1. Перейдите к [https://protection.office.com](https://protection.office.com) учетной записи администратора в организации Office 365 и войдите в нее, используя учетные данные администратора. 
    
2. В левой области центра безопасности _амп_ соответствие требованиям выберите **Импорт**управления **данными** \> .
    
    > [!NOTE]
    > Вам должны быть назначены соответствующие разрешения на доступ к странице " **Импорт** " в центре безопасности _Амп_ соответствия требованиям. Для получения дополнительных сведений ознакомьтесь с разделом **перед началом** работы. 
    
3. На странице **Импорт** нажмите кнопку ![добавить значок](media/ITPro-EAC-AddIcon.gif) **создать задание импорта**.
    
    Откроется мастер импорта заданий.
    
4. Введите имя для задания импорта PST-файлов, а затем нажмите кнопку **Далее**. Используйте строчные буквы, цифры, дефисы и символы подчеркивания. В имени нельзя использовать прописные буквы или вставлять пробелы.
    
5. На странице вы **хотите отправить или отгрузить данные?** щелкните **отправить данные** , а затем нажмите кнопку **Далее**.
    
    ![Нажмите кнопку отправить данные, чтобы создать задание импорта для передачи по сети](media/e59f9dc3-ccde-44ff-ac38-c4e39d76ae85.png)
  
6. На странице **Импорт данных** выполните следующие два действия: 
    
    ![Скопируйте URL-адрес SAS и скачайте средство Azure AzCopy на странице "Импорт данных"](media/74411014-ec4b-4e25-9065-404c934cce17.png)
  
    а. На шаге 2 щелкните **Показать URL-адрес для отправки по сети SAS**. После отображения URL-адреса SAS нажмите кнопку **Копировать в буфер обмена** , а затем вставьте его и сохраните в файл, чтобы получить доступ к нему позже.
    
    б. На шаге 3 щелкните **скачать Azure AzCopy** , чтобы скачать и установить средство Azure AzCopy. Во всплывающем окне нажмите кнопку **выполнить** , чтобы установить AzCopy. 
    
> [!NOTE]
> Вы можете оставить страницу **импорта данных** открытой (если вам потребуется снова скопировать URL-адрес SAS) или нажать кнопку **Отмена** , чтобы закрыть его. 
 
## <a name="step-2-upload-your-pst-files-to-office-365"></a>Шаг 2: отправка PST-файлов в Office 365

Теперь вы готовы использовать средство AzCopy. exe для отправки PST-файлов в Office 365. Это средство отправляет и сохраняет их в хранилище Azure в облаке Майкрософт. Как описывалось ранее, расположение хранилища Azure, в которое вы передаете PST-файлы, направляются в том же региональном центре обработки данных Майкрософт, где расположена организация Office 365. Чтобы выполнить это действие, необходимо, чтобы PST-файлы хранились в файловом ресурсе или на файловом сервере в вашей организации. В описанной ниже процедуре такое расположение называется исходным каталогом. Каждый раз при запуске средства AzCopy можно указать другой исходный каталог. 
  
1. Откройте окно командной строки на локальном компьютере.
    
2. Перейдите в каталог, в котором вы установили средство AzCopy.exe в действии 1. Если вы установили средство в расположении по умолчанию, `%ProgramFiles(x86)%\Microsoft SDKs\Azure\AzCopy`перейдите по адресу.
    
3. Выполните следующую команду, чтобы отправить PST-файлы в Office 365.

    ```
    AzCopy.exe /Source:<Location of PST files> /Dest:<SAS URL> /V:<Log file location> /Y
  
    ```
 
    > [!IMPORTANT] 
    > Необходимо указать каталог в качестве исходного расположения в предыдущей команде; Вы не можете указать отдельный PST-файл. Будут отправлены все PST-файлы в исходном каталоге.
 
    В следующей таблице описаны параметры AzCopy. exe и их обязательные значения. Сведения, полученные на предыдущем шаге, используются в значениях этих параметров.
    
    |**Параметр**|**Описание**|**Пример**|
    |:-----|:-----|:-----|
    | `/Source:` <br/> |Указывает исходный каталог в Организации, содержащий PST-файлы, которые будут отправлены в Office 365.  <br/> Обязательно заключите значение этого параметра в кавычки (" ").  <br/> | `/Source:"\\FILESERVER01\PSTs"` <br/> |
    | `/Dest:` <br/> |Указывает URL-адрес SAS, полученный на шаге 1.  <br/> Обязательно заключите значение этого параметра в кавычки (" ").  <br/> **Совет:** Необязательно Вы можете указать вложенную папку в хранилище Azure для отправки PST-файлов в. Для этого добавьте расположение вложенной папки (после "ingestiondata") в URL-АДРЕСе SAS. В первом примере не указывается вложенная папка; Это означает, что PST-файлы будут отправлены в корневую папку хранилища Azure (с именем *ingestiondata* ). Во втором примере выполняется отправка PST-файлов во вложенную папку (с именем *пстфилес* ) в корневой папке хранилища Azure.  <br/> | `/Dest:"https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D"` <br/> ИЛИ  <br/>  `/Dest:"https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata/PSTFiles?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D"` <br/> |
    | `/V:` <br/> |Отправляет подробные сообщения о состоянии в файл журнала. По умолчанию подробный файл журнала имеет имя AzCopyVerbose.log и размещается в папке %LocalAppData%\Microsoft\Azure\AzCopy. Если для этого параметра указать существующее расположение файла, подробный журнал будет добавлен в этот файл.  <br/> Обязательно заключите значение этого параметра в кавычки (" ").  <br/> | `/V:"c:\Users\Admin\Desktop\Uploadlog.log"` <br/> |
    | `/S` <br/> |Этот необязательный параметр указывает на рекурсивный режим, в котором средство AzCopy будет копировать PST-файлы, расположенные в подпапках в исходном каталоге, заданном `/Source:` параметром.  <br/> **Примечание:** Если этот параметр включен, PST-файлы в подпапках будут иметь другой путь к файлу хранилища Azure после отправки. Необходимо указать точный путь к файлу в CSV-файле, созданном на шаге 4.  <br/> | `/S` <br/> |
    | `/Y` <br/> |Этот обязательный параметр позволяет использовать маркеры SAS, доступные только для записи, при отправке PST-файлов в место хранения Azure. URL-адрес SAS, полученный на шаге 1 (и `/Dest:` указанный в параметре), является URL-адресом SAS, предназначенным только для записи, поэтому необходимо включить этот параметр. Обратите внимание, что URL-адрес SAS, доступный только для записи, не запрещает использовать Обозреватель хранилищ Azure для просмотра списка PST-файлов, отправленных в хранилище Azure.  <br/> | `/Y` <br/> |
   
Вот пример синтаксиса для средства AzCopy.exe, в котором использованы действительные значения для каждого параметра:
    
```
  AzCopy.exe /Source:"\\FILESERVER1\PSTs" /Dest:"https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D" /V:"c:\Users\Admin\Desktop\AzCopy1.log" /Y
  
```

После того как вы запустите команду, будут отображаться сообщения о состоянии, показывающие ход отправки PST-файлов. В окончательном сообщении о состоянии будет отображено общее количество успешно отправленных файлов. 

> [!TIP]
> После успешного выполнения команды AzCopy. exe и проверки правильности всех параметров сохраните копию синтаксиса командной строки в том же (защищенном) файле, в который вы скопировали информацию, полученную на шаге 1. Затем эту команду можно скопировать и вставить в командную строку каждый раз, когда необходимо запустить средство AzCopy. exe для отправки PST-файлов в Office 365. Для `/Source:` параметра может потребоваться изменить только те значения, которые необходимо изменить. Это зависит от исходного каталога, в котором расположены PST-файлы.

## <a name="optional-step-3-view-a-list-of-the-pst-files-uploaded-to-office-365"></a>Необязательно Шаг 3: Просмотр списка PST-файлов, отправленных в Office 365

В качестве дополнительного шага вы можете установить и использовать проводник Microsoft Azure Storage Explorer (бесплатный инструмент для открытого кода), чтобы просмотреть список PST-файлов, которые вы отправили в большой двоичный объект Azure. С его помощью вы сможете:
  
- Убедитесь, что PST-файлы из общей папки или файлового сервера в Организации успешно отправлены в BLOB-объект Azure.
    
- Проверьте имя файла (и путь к вложенной папке, если вы включили его) для каждого PST-файла, передаваемого в большой двоичный объект Azure. Эти функции пригодятся вам при создании PST-файла сопоставления на следующем шаге, когда необходимо будет указать путь к папке и имя каждого PST-файла. Проверив эти имена, вы сможете уменьшить количество возможных ошибок в PST-файле сопоставления.
    
Обозреватель хранилищ Microsoft Azure находится в предварительной версии.
  
> [!IMPORTANT]
> Вы не можете использовать Обозреватель хранилищ Azure для отправки или изменения PST-файлов. Единственный поддерживаемый метод импорта PST-файлов в Office 365 — использование AzCopy. Кроме того, вы не можете удалять PST-файлы, которые вы отправили на большой двоичный объект Azure. При попытке удалить PST-файл возникает сообщение о том, что у вас нет необходимых разрешений. Обратите внимание, что все PST-файлы автоматически удаляются из области хранилища Azure. If there are no import jobs in progress, then all PST files in the **ingestiondata** container are deleted 30 days after the most recent import job was created.
  
Чтобы установить Обозреватель хранилищ Azure и подключиться к области хранилища Azure, выполните указанные ниже действия.
  
1. Скачайте и установите [средство Microsoft Azure Storage Explorer](https://go.microsoft.com/fwlink/p/?LinkId=544842).
    
2. Запустите обозреватель хранилищ Microsoft Azure, щелкните правой кнопкой мыши **учетНые записи хранения** в левой области, а затем выберите **подключиться к хранилищу Azure**.
    
    ![Щелкните правой кнопкой мыши учетные записи хранения и выберите подключиться к хранилищу Azure.](media/75b80cc3-c336-4f96-ad32-54ac9b96a7af.png)
  
3. Щелкните **использовать универсальный код ресурса (URI) или строку подключения для подписи общего доступа (SAS)** и нажмите кнопку **Далее**.
    
4. Щелкните **использовать URI SAS**, вставьте URL-адрес SAS, полученный на шаге 1, в поле **URI**, а затем нажмите кнопку **Далее**.
    
5. На странице **Сводка** по подключению вы можете просмотреть сведения о подключении, а затем нажать кнопку **подключить**.
    
    Будет открыт контейнер **ingestiondata** ; Он содержит PST-файлы, которые были отправлены в действии 2. Контейнер **ingestiondata** находится в разделе " **учетные записи** \> хранения **" (службы, прикрепленные SAS)** \> **контейнеров BLOB-объектов**. 
    
    ![Список отправленных файлов PST в окне обозревателя хранилищ Azure](media/12376fed-13a5-4a09-8fe6-e819e011b334.png)
  
6. Когда вы завершите работу с обозревателем хранилищ Microsoft Azure, щелкните правой кнопкой мыши **ingestiondata**, а затем выберите пункт **Отключить** , чтобы отключиться от области хранилища Azure. В противном случае при следующей попытке подключиться возникнет ошибка. 
    
    ![Щелкните правой кнопкой мыши элемент "ingestion" и нажмите кнопку "Отсоединить", чтобы отключиться от области хранения данных Azure](media/1e8e5e95-4215-4ce4-a13d-ab5f826a0510.png)
  
## <a name="step-4-create-the-pst-import-mapping-file"></a>Шаг 4: создание файла сопоставления для импорта PST-файлов

После того как PST-файлы будут отправлены в хранилище Azure для вашей организации Office 365, следующим шагом будет создание CSV-файла, в котором указываются почтовые ящики пользователей, в которые будут импортированы PST-файлы. Вы отправите этот CSV-файл на следующем этапе при создании задания импорта PST-файлов.
  
1. [Скачайте копию файла сопоставления для импорта PST-файлов](https://go.microsoft.com/fwlink/p/?LinkId=544717).
    
2. Откройте или сохраните этот CSV-файл на локальный компьютер. В примере ниже показан готовый файл сопоставления для импорта PST-файлов (открытый в Блокноте). Для редактирования CSV-файла намного удобнее использовать Microsoft Excel.


    ```
    Workload,FilePath,Name,Mailbox,IsArchive,TargetRootFolder,ContentCodePage,SPFileContainer,SPManifestContainer,SPSiteUrl
    Exchange,,annb.pst,annb@contoso.onmicrosoft.com,FALSE,/,,,,
    Exchange,,annb_archive.pst,annb@contoso.onmicrosoft.com,TRUE,,,,,
    Exchange,,donh.pst,donh@contoso.onmicrosoft.com,FALSE,/,,,,
    Exchange,,donh_archive.pst,donh@contoso.onmicrosoft.com,TRUE,,,,,
    Exchange,PSTFiles,pilarp.pst,pilarp@contoso.onmicrosoft.com,FALSE,/,,,,
    Exchange,PSTFiles,pilarp_archive.pst,pilarp@contoso.onmicrosoft.com,TRUE,/ImportedPst,,,,
    Exchange,PSTFiles,tonyk.pst,tonyk@contoso.onmicrosoft.com,FALSE,,,,,
    Exchange,PSTFiles,tonyk_archive.pst,tonyk@contoso.onmicrosoft.com,TRUE,/ImportedPst,,,,
    Exchange,PSTFiles,zrinkam.pst,zrinkam@contoso.onmicrosoft.com,FALSE,,,,,
    Exchange,PSTFiles,zrinkam_archive.pst,zrinkam@contoso.onmicrosoft.com,TRUE,/ImportedPst,,,,
    ```
    В первой строке (строке заголовков) CSV-файла перечислены параметры, которые будут использоваться службой импорта PST-файлов для импорта PST-файлов в почтовые ящики пользователей. Имена параметров отделяются друг от друга запятыми. Каждая строка, расположенная под строкой заголовков, содержит значения для импорта PST-файла в определенный почтовый ящик. Для каждого PST-файла, который необходимо импортировать в почтовый ящик пользователя, требуется отдельная строка. Не забудьте заменить данные-заполнители в файле сопоставления действительными данными.

   **Примечание:** Не изменяйте ничего в строке заголовков, в том числе параметры SharePoint; они будут игнорироваться в процессе импорта PST-файлов. 

 3. Для заполнения CSV-файла необходимой информацией воспользуйтесь сведениями из таблицы ниже.


    |**Параметр**|**Описание**|**Пример**|
    |:-----|:-----|:-----|
    | `Workload` <br/> |Задает службу Office 365, в которую будут импортироваться данные. Чтобы импортировать PST-файлы в почтовые `Exchange`ящики пользователей, используйте.  <br/> | `Exchange` <br/> |
    | `FilePath` <br/> |Указывает расположение папки в хранилище Azure, куда вы отправили PST-файлы, на шаге 2.  <br/> Если в URL-АДРЕСе SAS в `/Dest:` параметре, указанном в шаге 2, не было указано имя вложенной папки, оставьте этот параметр пустым в CSV-файле. Если вы включили имя вложенной папки, укажите его в этом параметре (см. Второй пример). Значение этого параметра задается с учетом регистра.  <br/> В любом случае *не* включайте слово "ingestiondata" в качестве значения `FilePath` параметра.  <br/><br/> **Важно!** Регистр для имени пути к файлу должен совпадать с регистром, который вы использовали, если вы включили имя дополнительной папки в URL-адрес SAS в `/Dest:` параметре на шаге 2. Например, если `PSTFiles` имя вложенной папки в шаге 2 используется `pstfiles` в `FilePath` параметре в CSV-файле, произойдет ошибка импорта PST-файла. Убедитесь, что в обоих экземплярах используется один и тот же регистр.  <br/> |(Оставьте пустым)  <br/> ИЛИ  <br/>  `PSTFiles` <br/> |
    | `Name` <br/> |Указывает имя PST-файла, который будет импортирован в почтовый ящик пользователя. Значение этого параметра задается с учетом регистра.  <br/> <br/>**Важно!** Имя PST-файла в CSV-файле должно совпадать с PST-файлом, который был отправлен в место хранения Azure на шаге 2. Например, если вы используете `annb.pst` `Name` параметр в CSV-файле, но имя действительного PST-файла, то импорт для этого `AnnB.pst`PST-файла завершится с ошибками. Убедитесь, что имя PST-файла в CSV-файле использует то же самое, что и собственно PST-файл.  <br/> | `annb.pst` <br/> |
    | `Mailbox` <br/> |Указывает электронный адрес почтового ящика, в который будет импортирован PST-файл.  Обратите внимание: задать общедоступную папку невозможно, так как служба импорта PST не поддерживает импорт PST-файлов в общедоступные папки.  <br/> Чтобы импортировать PST-файл в неактивный почтовый ящик, необходимо указать GUID почтового ящика для этого параметра. Чтобы получить этот GUID, выполните следующую команду PowerShell в Exchange Online:`Get-Mailbox <identity of inactive mailbox> -InactiveMailboxOnly | FL Guid` <br/> <br/>**Примечание:** В некоторых случаях может быть несколько почтовых ящиков с одним адресом электронной почты, где один почтовый ящик является активным и другой почтовый ящик находится в обратимо удаленном (или неактивном) состоянии. В этом случае необходимо указать GUID почтового ящика для уникальной идентификации почтового ящика, в который импортируется PST-файл. Чтобы получить идентификатор GUID для активных почтовых ящиков, выполните следующую `Get-Mailbox <identity of active mailbox> | FL Guid`команду PowerShell:. Чтобы получить GUID для обратимо удаленных (или неактивных) почтовых ящиков `Get-Mailbox <identity of soft-deleted or inactive mailbox> -SoftDeletedMailbox | FL Guid`, выполните указанную ниже команду.  <br/> | `annb@contoso.onmicrosoft.com` <br/> ИЛИ  <br/>  `2d7a87fe-d6a2-40cc-8aff-1ebea80d4ae7` <br/> |
    | `IsArchive` <br/> | Указывает, следует ли импортировать PST-файл в архивный почтовый ящик пользователя. Возможны два указанных ниже значения параметра.  <br/><br/>**False** — импортирует PST-файл в основной почтовый ящик пользователя.  <br/> **True** — импортирует PST-файл в архивный почтовый ящик пользователя. This assumes that the [user's archive mailbox is enabled](enable-archive-mailboxes.md). <br/><br/>Если вы присвоить этому `TRUE` параметру значение, а архивный почтовый ящик пользователя не включен, импорт для этого пользователя завершится с ошибками. Обратите внимание, что при сбое импорта одного пользователя (так как его Архив не включен, а для `TRUE`этого свойства задано значение), другие пользователи в задании импорта не будут затронуты.  <br/>  If you leave this parameter blank, the PST file is imported to the user's primary mailbox.  <br/> <br/>**Примечание:** Чтобы импортировать PST-файл в облачный архивный архивный почтовый ящик пользователя, чей основной почтовый ящик является локальным, просто `TRUE` укажите для этого параметра и укажите адрес электронной почты для локального почтового ящика пользователя для `Mailbox` параметра.  <br/> | `FALSE` <br/> ИЛИ  <br/>  `TRUE` <br/> |
    | `TargetRootFolder` <br/> | Указывает папку почтового ящика, в которую импортируется PST-файл.  <br/>  Если оставить этот параметр пустым, то PST-файл будет импортироваться в новую папку с **** именем importd, расположенную на корневом уровне почтового ящика (то же, что и папка "Входящие", а также другие папки почтовых ящиков по умолчанию).  <br/>  Если указать `/`, элементы в PST-файле будут импортироваться непосредственно в папку "Входящие" пользователя.  <br/><br/>  Если указать `/<foldername>`, элементы в PST-файле будут импортированы в папку с именем * \<имя_папки\> * . Например, если вы используете `/ImportedPst`, элементы будут импортированы в папку с именем **импортедпст**. Эта папка будет расположена в почтовом ящике пользователя на том же уровне, что и папка "Входящие".  <br/><br/> **Совет:** РасСмотрите возможность запуска нескольких тестовых пакетов, чтобы поэкспериментировать с этим параметром, чтобы определить наиболее подходящее расположение папки для импорта PST-файлов.  <br/> |(Оставьте пустым)  <br/> ИЛИ  <br/>  `/` <br/> ИЛИ  <br/>  `/ImportedPst` <br/> |
    | `ContentCodePage` <br/> |Этот необязательный параметр указывает числовое значение для кодовой страницы, используемой для импорта PST-файлов в формате ANSI. Этот параметр используется для импорта PST-файлов из китайского, японского и корейского организаций, так как эти языки обычно используют набор двухбайтовых символов (DBCS) для кодирования символов. Если этот параметр не используется для импорта PST-файлов для языков, использующих DBCS для имен папок почтовых ящиков, имена папок часто нечитаемы после импорта.  <br/><br/> Список значений, поддерживаемых для этого параметра, приведен в разделе идентификаторы [кодовЫх страниц](https://go.microsoft.com/fwlink/p/?LinkId=328514).  <br/> <br/>**Примечание:** Как было сказано ранее, это необязательный параметр, который не нужно включать в CSV-файл. Кроме того, вы можете включить его и оставить значение пустым для одной или нескольких строк.  <br/> |(Оставьте пустым)  <br/> ИЛИ  <br/>  `932`(это идентификатор кодовой страницы для японской версии ANSI/OEM)  <br/> |
    | `SPFileContainer` <br/> |При импорте PST-файлов оставьте этот параметр пустым.   <br/> |Неприменимо  <br/> |
    | `SPManifestContainer` <br/> |При импорте PST-файлов оставьте этот параметр пустым.   <br/> |Неприменимо  <br/> |
    | `SPSiteUrl` <br/> |При импорте PST-файлов оставьте этот параметр пустым.   <br/> |Неприменимо  <br/> |

## <a name="step-5-create-a-pst-import-job-in-office-365"></a>Шаг 5: создание задания импорта PST-файла в Office 365

Следующий шаг — создание задания импорта PST-файла в службе импорта в Office 365. Как описывалось ранее, вы будете отправили файл сопоставления PST-импорта, созданный на шаге 4. После создания нового задания Office 365 анализирует данные в PST-файлах, а затем предоставляет возможность фильтровать данные, которые действительно импортируются, в почтовые ящики, указанные в файле сопоставления импорта PST-файлов (см. [Шаг 6](#step-6-filter-data-and-start-the-pst-import-job)).
  
1. Перейдите к [https://protection.office.com](https://protection.office.com) учетной записи администратора в организации Office 365 и войдите в нее, используя учетные данные администратора. 
    
2. В левой области центра безопасности _Амп_ соответствие требованиям выберите **Управление данными** , а затем нажмите кнопку **Импорт**.
    
3. На странице **Импорт** нажмите кнопку ![добавить значок](media/ITPro-EAC-AddIcon.gif) **создать задание импорта**.
    
    **Примечание:** Вам должны быть назначены соответствующие разрешения на доступ к странице **Импорт** в центре безопасности _Амп_ соответствия требованиям для создания нового задания импорта. Для получения дополнительных сведений ознакомьтесь с разделом **перед началом** работы. 
    
4. Введите имя для задания импорта PST-файлов, а затем нажмите кнопку **Далее**. Используйте строчные буквы, цифры, дефисы и символы подчеркивания. В имени нельзя использовать прописные буквы или вставлять пробелы.
    
5. На странице вы **хотите отправить или отгрузить данные?** щелкните **отправить данные** , а затем нажмите кнопку **Далее**.
    
    ![Нажмите кнопку отправить данные, чтобы создать задание импорта для передачи по сети](media/e59f9dc3-ccde-44ff-ac38-c4e39d76ae85.png)
  
6. На шаге 4 на странице **Импорт данных** выберите параметр отгрузка **моих файлов** и наличие **доступа к файлу сопоставления** , а затем нажмите кнопку **Далее**.
    
    ![На шаге 4 Установите два флажка.](media/9f2427e8-3af2-4e27-95e6-a9f08430d3d8.png)
  
7. На странице **Выбор файла сопоставления** нажмите кнопку **выбрать файл сопоставления** , чтобы передать файл сопоставления импорта PST, созданный на шаге 4. 
    
    ![Нажмите кнопку Выбрать файл сопоставления, чтобы передать CSV-файл, созданный для задания импорта](media/d30b1d73-80bb-491e-a642-a21673d06889.png)
  
8. После появления имени CSV-файла в поле **имя файла сопоставления**нажмите кнопку **проверить** , чтобы проверить CSV-файл на наличие ошибок. 
    
    ![Нажмите кнопку проверить, чтобы проверить CSV-файл на наличие ошибок.](media/4680999d-5538-4059-b878-2736a5445037.png)
  
    CSV-файл должен быть успешно проверен для создания задания импорта PST-файлов. Примечание имя файла изменяется на зеленый после успешной проверки. Если не удается выполнить проверку, щелкните ссылку **Просмотр журнала** . Откроется отчет об ошибке проверки с сообщением об ошибке для каждой строки в файле, на который произошел сбой. 
    
9. После успешной проверки файла сопоставления PST прочитайте документ "условия и условия", а затем установите флажок.
    
10. Нажмите кнопку **сохранить** , чтобы отправит задание, а затем нажмите кнопку **Закрыть** после успешного создания задания. 
    
    Отображается всплывающая страница состояния со статусом " **выполняется анализ** ", а в списке на странице " **Импорт** " отображается новое задание импорта. 
    
11. Нажмите кнопку **Обновить** ![значок](media/O365-MDM-Policy-RefreshIcon.gif) обновления, чтобы обновить сведения о состоянии, отображаемые в столбце **состояние** . После завершения анализа и готовности к импорту данных состояние изменится на " **анализ выполнен**".
    
    Вы можете щелкнуть задание импорта для отображения всплывающей страницы состояния, которая содержит более подробные сведения о задании импорта, такие как состояние каждого PST-файла, указанного в файле сопоставления.
 
## <a name="step-6-filter-data-and-start-the-pst-import-job"></a>Шаг 6: Фильтрация данных и запуск задания импорта PST-файлов

После создания задания импорта в действии 5 Office 365 анализирует данные в PST-файлах (безопасным и безопасным способом), определяя возраст элементов и различные типы сообщений, включенные в PST-файлы. После завершения анализа и готовности к импорту данных можно импортировать все данные, содержащиеся в PST-файлах, или можно обрезать импортируемые данные, задав фильтры, которые контролируют, какие данные следует импортировать.
  
1. На странице " **Импорт** " центра соответствия требованиям безопасности _амп_ нажмите кнопку **Готово, чтобы импортировать в Office 365** для задания импорта, созданного в шаге 5. 
    
    ![Щелкните Готово для импорта в Office 365 рядом с созданным заданием импорта](media/5760aac3-300b-4e31-b894-253c42a4b82b.png)
  
    Отобразится страница вылет со сведениями о PST-файлах и других сведениях о задании импорта.
    
2. На всплывающей странице щелкните **Импорт в Office 365**.
    
    Отобразится страница " **Фильтрация данных** ". Он содержит аналитические данные, полученные в результате анализа, выполняемого в PST-файлах, в Office 365, в том числе сведения о сроке хранения данных. На этом шаге вы можете отфильтровать данные, которые будут импортироваться или импортировать все данные как есть. 
    
    ![Вы можете обрезать данные в PST-файлах или импортировать их все](media/287fc030-99e9-417b-ace7-f64617ea5d4e.png)
  
3. Выполните одно из указанных ниже действий.
    
    а. Чтобы обрезать импортируемые данные, нажмите кнопку **Да, я хочу отфильтровать их перед импортом**.
    
    Подробное пошаговое руководство по фильтрации данных в PST-файлах и последующем запуске задания импорта описано в статье [Filter Data при импорте PST-файлов в Office 365](filter-data-when-importing-pst-files.md).
    
    ИЛИ
    
    б. Чтобы импортировать все данные в PST-файлах, нажмите кнопку **нет, импортировать все,** а затем нажмите кнопку **Далее**.
    
4. Если вы решили импортировать все данные, нажмите кнопку **Импорт данных** , чтобы запустить задание импорта. 
    
    Состояние задания импорта отображается на странице " **Импорт** ". Нажмите ![кнопку обновить](media/O365-MDM-Policy-RefreshIcon.gif) значок **Обновить** , чтобы обновить сведения о состоянии, отображаемые в столбце **состояние** . Щелкните задание импорта для отображения всплывающей страницы состояния, в которой отображаются сведения о состоянии импортируемого PST-файла. 

## <a name="how-the-import-process-works"></a>Как работает процесс импорта
  
Для массового импорта PST-файлов в почтовые ящики пользователей можно использовать параметр отправки по сети и службу импорта Office 365. Отправка по сети означает, что вы отправляете PST-файлы в область временного хранения в облаке Майкрософт. Затем служба импорта Office 365 копирует PST-файлы из области хранения в почтовые ящики конечного пользователя.
  
Ниже приведена иллюстрация и описание процесса отправки в сеть для импорта PST-файлов в почтовые ящики в Office 365.
  
![Рабочий процесс загрузки в сети для импорта PST-файлов в Office 365](media/9e05a19e-1e7a-4f1f-82df-9118f51588c4.png)
  
1. **Скачайте средство импорта PST-файлов и ключ в личное расположение хранилища Azure** — первый шаг — скачать средство командной строки Azure AzCopy и ключ доступа, используемый для отправки PST-файлов в хранилище Azure в облаке Майкрософт. Их можно получить на странице **Импорт** в центре безопасности _Амп_ соответствия требованиям. Ключ (называемый ключом безопасности безопасного доступа) предоставляет необходимые разрешения на отправку PST-файлов в частное и безопасное место хранения Azure. Этот ключ доступа уникален для Организации и помогает предотвратить несанкционированный доступ к PST-файлам после их отправки в Microsoft Cloud. Обратите внимание, что при импорте PST-файлов в Office 365 не требуется, чтобы в Организации была отдельная подписка на Azure. 
    
2. **Отправьте PST-файлы в хранилище Azure** . следующий шаг — использование средства AzCopy. exe (загруженного на этапе 1) для отправки и сохранения PST-файлов в расположении хранилища Azure, которое находится в том же региональном центре обработки данных Майкрософт, где находится Office 365 расположена организация. Для их отправки необходимо, чтобы PST-файлы, которые вы хотите импортировать в Office 365, были размещены в общей папке или на файловом сервере в Организации.
    
    Обратите внимание на то, что существует необязательный шаг, который можно выполнить, чтобы просмотреть список PST-файлов после их отправки в место хранения Azure.
    
3. **Создание файла сопоставления для импорта PST** -файлов: после отправки PST-файлов в хранилище Azure необходимо создать файл значений с разделителями-запятыми (CSV), указывающий, в какие почтовые ящики пользователей будут ИМПОРТИРОВАТЬся PST-файлы.  импортированы в основной почтовый ящик пользователя или в архивный почтовый ящик. Служба импорта Office 365 будет использовать данные из CSV-файла для импорта PST-файлов.
    
4. **Создание задания импорта PST** -файла. следующий шаг — создание задания импорта PST-файла на странице **Импорт** в центре безопасности _амп_ соответствие требованиям и предоставление файла сопоставления для импорта PST, созданного на предыдущем шаге. После создания задания импорта Office 365 анализирует данные в PST-файлах и предоставляет возможность настраивать фильтры, которые контролируют, какие данные фактически импортируются в почтовые ящики, указанные в файле сопоставления для импорта PST-файлов. 
    
5. **Фильтрация данных PST, которые будут импортированы в** почтовые ящики — после создания и запуска задания импорта Office 365 анализирует данные в PST-файлах (безопасно и безопасно), определяя возраст элементов и различные типы сообщений, включенные в PST-файлы. . После завершения анализа и готовности к импорту данных можно импортировать все данные, содержащиеся в PST-файлах, или можно обрезать импортируемые данные, задав фильтры, которые контролируют, какие данные следует импортировать.
    
6. **Запустите задание импорта PST** -файла после запуска задания импорта, Office 365 использует сведения из файла сопоставления PST-файла для импорта PST-файлов из расположения хранилища Azure в почтовые ящики пользователей. Сведения о состоянии задания импорта (в том числе сведения о каждом импортируемом PST-файле) отображаются на странице " **Импорт** " в центре безопасности _Амп_ соответствия требованиям. После завершения задания импорта в качестве состояния задания устанавливается значение **завершено**.
  
## <a name="more-information"></a>Дополнительная информация

- Зачем импортировать PST-файлы в Office 365?
    
  - Это хороший способ импортировать архивные данные сообщений в Организации в Office 365.
    
  - Данные доступны пользователю на любых устройствах, так как они хранятся в облаке.
    
  - Это помогает обеспечить соответствие требованиям вашей организации, позволяя применять функции соответствия требованиям Office 365 к данным из импортируемых вами PST-файлов. Это включает:
    
  - Включение [архивных](enable-archive-mailboxes.md) почтовых ящиков и [автоматически развертываемого архива](enable-unlimited-archiving.md) для предоставления пользователям дополнительного места для хранения импортированных данных. 
    
  - Помещение почтовых ящиков на [Хранение](https://go.microsoft.com/fwlink/?linkid=856286) для судебного разбирательства для сохранения импортированных данных. 
    
  - Использование [средств обнаружения электронных](search-for-content.md) данных Майкрософт для поиска импортированных данных. 
    
  - Использование [политик хранения Office 365](retention-policies.md) для управления продолжительностью хранения импортируемых данных и действий, выполняемых после истечения периода хранения. 
    
  - Поиск в [журнале аудита Office 365](search-the-audit-log-in-security-and-compliance.md) для событий, связанных с почтовыми ящиками, которые влияют на импортированные данные. 
    
  - Импорт данных в [неактивные](create-and-manage-inactive-mailboxes.md) почтовые ящики для архивации данных в целях соответствия требованиям. 
    
  - Использование [политик защиты от потери данных](data-loss-prevention-policies.md) для предотвращения утечки конфиденциальных данных за прев Организации. 
  
- Ниже приведен пример URL-адреса общего доступа к подписи (SAS) общего доступа, полученного на шаге 1. Этот пример также содержит синтаксис команды, выполняемой в средстве AzCopy. exe, для отправки PST-файлов в Office 365. Обязательно примите меры предосторожности, чтобы защитить URL-адрес SAS так же, как и для защиты паролей или других данных, связанных с безопасностью.

    ```
    SAS URL: https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D

    AzCopy.exe /Source:<Location of PST files> /Dest:<SAS URL> /V:<Log file location> /Y

    EXAMPLES

    This example uploads PST files to the root of the Azure storage location:

    AzCopy.exe /Source:"\\FILESERVER1\PSTs" /Dest:"https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D" /V:"c:\Users\Admin\Desktop\AzCopy1.log" /Y
    
    This example uploads PST files to a subfolder named PSTFiles  in the Azure storage location:

    AzCopy.exe /Source:"\\FILESERVER1\PSTs" /Dest:"https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata/PSTFiles?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D" /V:"c:\Users\Admin\Desktop\AzCopy1.log" /Y
``

- As previously explained, the Office 365 Import service turns on the retention hold setting (for an indefinite duration) after PST files are imported to a mailbox. This means the  *RetentionHoldEnabled*  property is set to  **True** so that the retention policy assigned to the mailbox won't be processed. This gives the mailbox owner time to manage the newly-imported messages by preventing a deletion or archive policy from deleting or archiving older messages. Here are some steps you can take to manage this retention hold: 
    
    - After a certain period of time, you can turn off the retention hold by running the **Set-Mailbox -RetentionHoldEnabled $false** command. For instructions, see [Place a mailbox on retention hold](https://go.microsoft.com/fwlink/p/?LinkId=544749).
    
   - You can configure the retention hold so that it's turned off on some date in the future. You do this by running the **Set-Mailbox -EndDateForRetentionHold *date*** command. For example, assuming that today's date is June 1, 2016 and you want the retention hold turned off in 30 days, you would run the following command:  **Set-Mailbox -EndDateForRetentionHold 7/1/2016**. In this scenario, you would leave the  **RetentionHoldEnabled**  property set to  *True*. For more information, see [Set-Mailbox](https://go.microsoft.com/fwlink/p/?LinkId=150317).
    
   - You can change the settings for the retention policy that's assigned to the mailbox so that older items that were imported won't be immediately deleted or moved to the user's archive mailbox. For example, you could lengthen the retention age for a deletion or archive policy that's assigned to the mailbox. In this scenario, you would turn off the retention hold on the mailbox after you changed the settings of the retention policy. For more information, see [Set up an archive and deletion policy for mailboxes in your Office 365 organization](set-up-an-archive-and-deletion-policy-for-mailboxes.md).
    
