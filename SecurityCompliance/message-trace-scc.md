---
title: Трассировка сообщений в центре соответствия требованиям & безопасности
ms.author: chrisda
author: chrisda
manager: serdars
ms.date: ''
ms.audience: ITPro
ms.topic: article
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: 3e64f99d-ac33-4aba-91c5-9cb4ca476803
description: Администраторы могут использовать Трассировка сообщений в центре соответствия требованиям & безопасности, чтобы узнать, что происходит в сообщениях.
ms.openlocfilehash: 9dfdab4adc5caba55664e93b49c8428791670ab3
ms.sourcegitcommit: 25fb33a1f8b2844fde15f6c03db2936c610824e0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2019
ms.locfileid: "28685621"
---
# <a name="message-trace-in-the-security--compliance-center"></a>Трассировка сообщений в центре соответствия требованиям & безопасности

Трассировка сообщений в центре соответствия требованиям & безопасности следует сообщений электронной почты, проходящих через организации Exchange Online. Можно определить, если сообщение было получено, отклонено, отложенной или доставлено службой. Также показаны действия, которые были сделаны в сообщении перед его связаться с вами его конечное состояние.

Трассировка сообщений в центре соответствия требованиям & безопасности расширяет трассировки, который был доступен в центре администрирования Exchange (EAC). Сведения из трассировки можно использовать для эффективного ответы на вопросы пользователей о что случилось с сообщения, помещенные, устранение неполадок потока почты и проверки изменения политики.

## <a name="open-message-trace"></a>Открыть сообщение трассировки

1. [Войдите в Office 365](https://support.office.com/article/e9eb7d51-5430-4929-91ab-6157c5a050b4) с помощью рабочая или учебная учетная запись.

2. Слева вверху щелкните значок средства запуска приложений ![Значок средства запуска приложения Office 365](media/0aaa6945-f9a4-4b13-bf5f-d5c5dbe978fb.png) и выберите **Администратор**.

3. В панели навигации слева разверните узел **центра администрирования** и выберите **Безопасность & соответствия требованиям**.

4. На открывшейся странице **Security & Compliance** разверните **поток почты**и выберите **Трассировка сообщений**.

## <a name="message-trace-page"></a>Страница отслеживания сообщений

Здесь можно начать новую трассировку по умолчанию, нажав кнопку **Пуск трассировки** . Это будет искать все сообщения для всех отправителей и получателей в течение последних двух дней. Или можно использовать один из сохраненных запросов из доступных запрос категории, либо выполните их как-является или использовать их в качестве основы для собственных запросов:

- **По умолчанию запросы**: встроенные запросы, предоставляемые Office 365.

- **Настраиваемые запросов**: запросы раз сохранена с Администраторы в вашей организации для использования в будущем.

- **Запросы автоматически сохраненная**: последние десять последним выполнение запросов. Этот список позволяет легко трубку места.

Также на этой странице — раздел **загружаемым отчетов** для отправки запросов, а также сами отчеты, при наличии доступен для загрузки.

## <a name="options-for-a-new-message-trace"></a>Параметры для новой трассировки

### <a name="filter-by-senders-and-recipients"></a>Фильтровать по отправителям и получателям

Значения по умолчанию, **всем отправителям** и **всех получателей**, но можно использовать следующие поля для фильтрации результатов:

- **Эти пользователи**: щелкните в этом поле для выбора одного или нескольких отправителей из вашей организации. Кроме того, можно начать введите имя и элементов в списке фильтруются по что ввода, намного как поведение на странице поиска.

- **Чтобы эти сотрудники**: щелкните в этом поле для выбора одного или нескольких получателей в вашей организации.

Можно также ввести адреса электронной почты внешним отправителям и получателям. Поддерживаются подстановочные знаки (`*@contoso.com` или `scot?@contoso.com`), но нельзя использовать несколько записи с подстановочными знаками в одном поле в то же время.

### <a name="time-range"></a>Диапазон времени

Значение по умолчанию — **2 дня**, но можно указать диапазон даты и времени до 90 дней. При использовании диапазонов даты и времени, необходимо учесть следующие проблемы:

- По умолчанию выберите диапазон времени в представлении **ползунок** с помощью строки времени. Выберите день или параметры, которые отображаются можно только. При попытке выбора промежуточных значение будет привязана пузырьковой начала или окончания для ближайшей отображается параметр.

   ![Диапазон времени ползунок в трассировку сообщений в центре соответствия требованиям & безопасности](media/55a9e9c1-f7d5-4047-b217-824e8b976bcb.png)

   Однако можно также переключиться **пользовательского** представления, где можно указать значения **Дата начала** и **Дата окончания** (в том числе время), а также можно выбрать **часовой пояс** для диапазон даты и времени. Обратите внимание на то, что параметр **часовой пояс** применяется к введенных данных запросов и результатов запроса.

   ![Настраиваемый диапазон времени в трассировку сообщений в центре соответствия требованиям & безопасности](media/ed4c8d50-9ea5-4694-93f9-ee3ab6660b4f.png)

   Немедленное в **сводном** отчете доступны для 10 дней или меньше результаты. Если указать диапазон времени, который еще немного больше, чем 10 дней, результаты будут задержать как есть только доступно в виде загружаемых CSV-файла ( **улучшенной сводки** или **Extended** отчета).

   Дополнительные сведения о различных типов отчетов обратитесь к разделу [выберите тип отчета](#choose-report-type) в этом разделе.

   **Примечание**: расширенные сводки и расширенные отчеты подготавливаются с использованием данных заархивированные сообщения трассировки, и он может занять несколько часов до отчет доступен для загрузки. В зависимости от того, сколько Администраторы также был отправлен отчет о запросах в то время можно заметить также задержку перед запуском обработки помещенных в очередь запросов на.

- Сохранение запроса в представлении **ползунок** сохраняет относительное время диапазона (например, 3 дня сегодняшнего дня). Сохранение запроса в **настраиваемое** представление сохраняет диапазон абсолютный даты и времени (например, 2018-05-06 13:00 до 2018-05-08 18:00).

### <a name="more-search-options"></a>Дополнительные параметры поиска

#### <a name="delivery-status"></a>Состояние доставки

Можно оставить значение по умолчанию, **все** выбранные или можно выбрать один из следующих значений для фильтрации результатов:

- **Доставлено**: сообщение было успешно доставлено в место назначения.

- **Ожидание**: доставки сообщения выполняется попытка или повторной.

- **Развернутая**: получателя группа рассылки была расширена перед доставкой отдельных членов группы.

- **Ошибка**: не удается доставить сообщение.

- **Карантин**: сообщения в карантин (как нежелательная почта, Массовая рассылка или фишинга). Дополнительные сведения см в [карантин сообщения электронной почты в Office 365](https://support.office.com/article/4c234874-015e-4768-8495-98fcccfc639b.aspx).

- **Фильтрация как нежелательная почта**: сообщение было определяемую нежелательной почты и был отклонен или заблокирован (не помещенных в карантин).

- **Получения состояния:** Сообщение было получено недавно с Office 365, но другие данные состояния еще недоступны. Проверьте обратно в несколько минут.

**Примечание**: значения **ожидающих,** **помещенное в карантин**и **фильтр как нежелательной почты** доступны только для операций поиска не превышает 10 дней. Кроме того могут возникнуть задержки 5-10 минут между состояние фактические и переданные доставки.

#### <a name="message-id"></a>ИД сообщения

Это идентификатор сообщения Интернета (идентификатор клиента), который находится в **Message-ID:** поле заголовка в заголовке сообщения. Пользователи могут предоставить это значение для изучения определенного сообщения.

Это значение является постоянным в течение времени жизни сообщения. Для сообщений, созданных в Office 365 или Exchange, значение задается в формате `<GUID@ServerFQDN>`, включая угловые скобки (\< \>). Например `<d9683b4c-127b-413a-ae2e-fa7dfb32c69d@DM3NAM06BG401.Eop-nam06.prod.protection.outlook.com>`. Другие системы обмена сообщениями могут использовать другой синтаксис или значения. Это значение — это должно быть уникальным, но не все системы электронной почты строго следуйте этим требованиям. Если **Message-ID:** поле заголовка не существует или не задан для входящих сообщений из внешних источников, назначенные произвольного значения.

При использовании **Идентификатор сообщения** для фильтрации результатов, не забудьте включить полной строки, включая любые угловые скобки.

#### <a name="direction"></a>Направление

Можно оставить значение по умолчанию, **все** выбранные или можно выбрать **Входящие** (сообщений, отправленных получателям в организации) или **исходящего соединителя** (сообщений, отправляемых с пользователями в вашей организации) для фильтрации результатов.

#### <a name="original-client-ip-address"></a>Исходный IP-адрес клиента

Можно filer результаты, IP-адрес клиента для изучения использованием компьютеров, которые отправки больших объемов нежелательной почты и вредоносных программ. Несмотря на то, что сообщения могут появляться, от различных отправителей, скорее всего, что все сообщения создает тот же компьютер.

**Примечание**: сведения об адресе IP-адрес клиента доступна только для 10 дней и доступна только в отчетах **улучшенной сводки** или **Extended** (загружаемая CSV-файлы).

### <a name="choose-report-type"></a>Выберите тип отчета

Отчет о доступных типов являются:

- **Сводка**: недоступны, если диапазон времени меньше 10 дней и требуется без дополнительных параметров фильтрации. Результаты доступны практически сразу же после нажатия кнопки **Поиск**.

- **Улучшенной сводки** или **Extended**: эти отчеты доступны только в качестве загрузки CSV-файлов и требуют одно или несколько из следующих параметров фильтрации независимо от диапазона времени: **эти пользователями**, **эти сотрудники**или ** Код сообщения**. Можно использовать подстановочные знаки для отправителей или получателей (например, \*@contoso.com).

**Примечания**.

- Расширенные сводки и расширенные отчеты подготавливаются с использованием данных заархивированные сообщения трассировки, и он может занять несколько часов до отчет доступен для загрузки. В зависимости от того, сколько Администраторы также был отправлен отчет о запросах в то время можно заметить также задержку перед запуском помещенных в очередь запроса для обработки.

- Хотя вы можете выбрать отчета улучшенной сводки или расширенные для каких-либо диапазон даты и времени, обычно за последние четыре часа архивных данных не работает, но при этом доступным для этих двух типов отчетов.

При нажатии кнопки **Далее**, описанные страницу сводки, в котором приведены параметры фильтрации, которые вы выбрали, уникальный (редактируемые) заголовок отчета и адрес электронной почты, которая получает уведомление о завершении (также редактировать, трассировка сообщений и должны быть в одном из обслуживаемых доменов организации). Щелкните **подготовить отчет** для отправки сообщения трассировки. В главном **трассировки** страницы, можно просматривать состояние отчета в разделе **Downloadable отчетов** .

Дополнительные сведения о сведений, возвращаемых в различных типов отчетов см.

## <a name="message-trace-results"></a>Результатов трассировки

Различных типов отчетов возвращают различные уровни сведений. Сведения, доступные в различных отчетов описан в следующих разделах.

### <a name="summary-report-output"></a>Сводный отчет по вывода

После выполнения сообщения трассировки, результаты будут отображены, упорядоченные по убыванию даты и времени (последние первого).

![Сводный отчет по результаты для трассировки сообщений в центре соответствия требованиям & безопасности](media/0664bafe-0b03-477b-b571-0b046ac8c977.png)

Сводный отчет содержит следующие сведения:

- **Дата**: Дата и время, когда сообщение было получено службой, пояса времени UTC.

- **Отправитель**: адрес электронной почты отправителя (*псевдоним*@*домена*).

- **Получатель**: адрес электронной почты получателя или получателей. Для сообщений, отправленных нескольким получателям имеется одна строка для каждого получателя. Если получатель является группу рассылки, динамическая группа рассылки или группу безопасности с включенной поддержкой почты, группе будет первого получателя, и затем каждый член группы — в отдельной строке.

- **Тема**: сначала 256 символов сообщения **Тема:** поля.

- **Состояние**: эти значения, которые описаны в разделе [состояние доставки](#delivery-status) .

По умолчанию первые 250 результаты, загрузки и будет доступна. При прокрутите список вниз, существует небольшое приостановить загрузка следующего пакета результаты. Вместо прокрутки, нажмите кнопку **загрузить все** для загрузки всех результатов не более 10 000.

Щелкните заголовок столбца для сортировки результатов на значения этого столбца в возрастающем или убывающем порядке.

Можно нажать кнопку **результатов фильтра** для фильтрации результатов по одному или нескольким столбцам.

После выбора одного или нескольких строк, нажав кнопку **экспортировать результаты** и выберите **Экспорт всех результатов** **экспорта загрузить результаты**и **Экспортировать выбранный**можно экспортировать результаты.

#### <a name="find-related-records-for-this-message"></a>Поиск связанных записей для данного сообщения

Связанные сообщения записи являются записями, общими тот же идентификатор сообщения. Помните, что даже одного сообщения между двумя пользователями можно создать несколько записей. Число записей увеличивается, когда сообщения были затронуты расширения группы рассылки, пересылки, правила потока почты (также известной как правила транспорта), и т.д.

После выбора строки флажок связанных записей можно найти в сообщении, нажмите кнопку **найти связанные** , который отображается, или можно выбрать **Дополнительные параметры** ![дополнительные](media/1ea52bbf-9d00-48ce-9362-307f7f6fb7fe.png) \> **Поиск связанных записей для данного сообщения**).

Дополнительные сведения о идентификатор сообщения обратитесь к разделу идентификатор сообщения ранее в этом разделе.

#### <a name="message-trace-details"></a>Сведений трассировки

В выходных данных сводный отчет можно просмотреть сведения о сообщение с помощью одного из следующих методов:

- Выберите строку (щелкните в любом месте строки, кроме флажок).

- Установите флажок строку и нажмите кнопку **Дополнительные параметры** ![дополнительные](media/1ea52bbf-9d00-48ce-9362-307f7f6fb7fe.png) \> **Просмотр сведений о сообщении**.

   ![Сведения о после двойного щелчка строки в сводный отчет по результатов трассировки в центре соответствия требованиям & безопасности](media/e50ee7cd-810a-4c06-8b58-e56ffd7028d1.png)

Сведений трассировки содержат следующие дополнительные сведения, которого нет в сводный отчет.

- **Сообщение события**: в этом разделе содержатся классификации строк, которые помогают классифицировать действия, которые служба начинает в сообщениях. Ниже указаны некоторые из наиболее интересных событий, которые могут возникать.

   - **Получения**: сообщение было получено службой.

   - **Отправка**: сообщение было отправлено службой.

   - **Сбой**: не удалось доставить сообщение.

   - **Предоставление**: сообщение было доставлено в почтовый ящик.

   - **Развернуть**: сообщение было отправлено в группу рассылки, которая была расширена.

   - **Переключение**: из-за преобразования содержимого, ограничение числа получателей сообщения или агентов получатели были перемещены в раздвоенное сообщение.

   - **Задержки**: доставка сообщений было отложено и может быть повторно попытка более поздней версии.

   - **Разрешено**: сообщения был перенаправлен на новый адрес получателя на основании поиска в Active Directory. В этом случае исходный адрес получателя отображается в отдельной строке в трассировке сообщений вместе с состоянием окончательный доставки сообщения.

   Обратите внимание на то, что даже процедура сообщение успешно доставлено будет создавать несколько записей **событий** в трассировке сообщений.

- **Дополнительные сведения**: в этом разделе содержатся следующие сведения:

   - **Код сообщения**: это значение — это описано в разделе [Код сообщения](#message-id) ранее в этом разделе. Например `<d9683b4c-127b-413a-ae2e-fa7dfb32c69d@DM3NAM06BG401.Eop-nam06.prod.protection.outlook.com>`.

   - **Размер сообщения**

   - **IP-адрес из**: IP-адрес компьютера, отправившего сообщение. Для исходящих сообщений, отправленных с Exchange Online это значение не задан.

   - **Для IP-адресов**: IP-адрес или адреса, где служба попытка доставки сообщения. Если сообщение имеет несколько получателей, они отображаются. Для входящих сообщений, отправляемых в Exchange Online это значение не задан.

### <a name="enhanced-summary-reports"></a>Усовершенствованные сводные отчеты о

Доступные (выполненных) улучшенной сводные отчеты о доступны в разделе **Downloadable отчетов** в начале Трассировка сообщений. Следующие сведения можно найти в отчете:

- **origin_timestamp**<sup>*</sup>: Дата и время, когда сообщение было получено службой, пояса времени UTC изначально.

- **sender_address**: адрес электронной почты отправителя (*псевдоним*@*домена*).

- **Recipient_status**: состояния доставки сообщения получателю. Если сообщение было отправлено нескольким получателям, оно будет отображаться всех получателей, а также соответствующие состояние для каждого из них, в формате: \< *адрес электронной почты*\>##\<*состояние*\>. Например:

   - **##Receive, отправка** означает, что сообщение было получено службой и отправлено в место назначения.

   - **Сбой ##Receive,** означает, что сообщение было получено службы, но доставки в место назначения не удалось.

   - **##Receive, доставка** означает, что сообщение было получено службой и доставлено в почтовый ящик получателя.

- **message_subject**: сначала 256 символов поле **темы** сообщения.

- **total_bytes**: размер сообщения в байтах, включая вложения.

- **message_id**: это значение — это описано в разделе [Код сообщения](#message-id) ранее в этом разделе. Например `<d9683b4c-127b-413a-ae2e-fa7dfb32c69d@DM3NAM06BG401.Eop-nam06.prod.protection.outlook.com>`.

- **network_message_id**: значение сообщения уникальный идентификатор, сохраняются для всех копий сообщений, который может быть создан из-за расширения группы рассылки или разветвление. Пример значения — это `1341ac7b13fb42ab4d4408cf7f55890f`.

- **original_client_ip**: IP-адрес клиента отправителя.

- **направление**: Указывает, является ли сообщение было отправлено входящим (1) или ли оно было отправлено исходящих (2) из вашей организации.

- **connector_id**: имя соединителя источника и назначения. Дополнительные сведения о соединителях в Exchange Online можно [настроить поток обработки почты с помощью соединителей в Office 365](https://docs.microsoft.com/Exchange/mail-flow-best-practices/use-connectors-to-configure-mail-flow/use-connectors-to-configure-mail-flow).

- **delivery_priority**<sup>*</sup>: ли сообщение отправлено с **высоким**, **низким**или **обычным** приоритетом.

<sup>*</sup>Эти свойства доступны только в сводные отчеты о улучшенной.

### <a name="extended-reports"></a>Расширенные отчеты

Доступные отчеты Extended (выполненных) доступны в разделе **Downloadable отчетов** в начале трассировки. Практически все сведения из сводного отчета по улучшенной доступна в отчет об Extended (за исключением **origin_timestamp** и **delivery_priority**). Следующие дополнительные сведения доступен только в отчет об Extended:

- **client_ip**: IP-адрес сервера электронной почты или обмена мгновенными сообщениями клиента, отправившего сообщение.

- **client_hostname**: имя узла или полное доменное имя сервера электронной почты или обмена мгновенными сообщениями клиента, отправившего сообщение.

- **server_ip**: IP-адрес сервера источника и назначения.

- **server_hostname**: имя узла или полное доменное имя сервера на целевой сервер.

- **source_context**: Дополнительные сведения, связанные с **исходного** поля. Например:

   - `Protocol Filter Agent`

   - `3489061114359050000`

- **источник**: Exchange Online компонент, который несет ответственность за событие. Например:

   - `AGENT`

   - `MAILBOXRULE`

   - `SMTP`

- **код_события**: они соответствуют значениям **сообщения события** , которые описаны в разделе [Поиск связанных записей для данного сообщения](#find-related-records-for-this-message) .

- **internal_message_id**: идентификатор сообщения, назначенный сервером Exchange Online, который в данный момент обрабатывает сообщение.

- **recipient_address**: адреса получателей сообщения электронной почты. Несколько адресов электронной почты, разделенных знаком точки с запятой (;).

- **recipient_count**: общее число получателей в сообщении.

- **related_recipient_address**: использовать совместно с `EXPAND`, `REDIRECT`, и `RESOLVE` событий для отображения получателей электронной почты адреса, связанные с сообщением.

- **Справочник по**: в этом поле содержит дополнительные сведения для конкретных типов событий. Например:

   - **Уведомления о Доставке**: содержит ссылки на отчет, равный значению **message_id** из связанной уведомление о состоянии доставки (также известной как уведомления о Доставке, отчет о недоставке, отчет о Недоставке или сообщение о возврате), если имя источника данных создается после этого события. Если это сообщение уведомления о Доставке, это поле содержит значение **message_id** исходного сообщения, для создания источника данных.

   - **РАЗВЕРНУТЬ**: содержит значение **related_recipient_address** сообщений, связанных с ними.

   - **Получения**: может содержать значение **message_id** связанные сообщения, если сообщение был создан для других процессов (например, правила папки "Входящие").

   - **ОТПРАВКА**: содержит значение **internal_message_id** все уведомления о Доставке сообщения.

   - **ПЕРЕКЛЮЧЕНИЕ**: содержит значение **internal_message_id** сообщения, разделенными (например, путем преобразования содержимого, ограничение числа получателей сообщения или агенты).

   - **MAILBOXRULE**: содержит значение **internal_message_id** входящего сообщения, которое вызвало правила папки «Входящие» для создания исходящих сообщений.

   Для событий других типов это поле обычно не заполняется.

- **return_path**: адрес возврата электронной почты, указанный с помощью команды **MAIL FROM** , отправившего сообщение. Несмотря на то, что это поле никогда не является пустым, он может иметь значение null отправителя адрес, представленные в виде `<>`.

- **message_info**: Дополнительные сведения о сообщении. Например:

   - Дата время отправки сообщения в формате UTC для `DELIVER` и `SEND` события. Дата и время возникновения — это время, если сообщение впервые введена в организацию Exchange Online. Дата время в формате UTC представлен в формате даты и времени ISO 8601: `yyyy-mm-ddThh:mm:ss.fffZ`, где `yyyy` = год, `mm` = месяц, `dd` = день, `T` начало компонент времени `hh` = час, `mm` = минуты, `ss` = секунды, `fff` = доли секунды, и `Z` означает `Zulu`, которая является другим способом для обозначения UTC.

   - Ошибки проверки подлинности. Например, вы можете увидеть значение `11a` и тип проверки подлинности, который использовался при возникновении ошибки проверки подлинности.

- **tenant_id**: идентификатор GUID, который представляет организацию Exchange Online (например, `39238e87-b5ab-4ef6-a559-af54c6b07b42`).

- **original_server_ip**: IP-адрес исходного сервера.

- **custom_data**: содержит данные, связанные с типами определенных событий. Дополнительные сведения см в следующих разделах.

#### <a name="customdata-values"></a>значения custom_data

Поле **custom_data** для `AGENTINFO` событие используется по-разному Exchange Online агентам для записи в журнал подробные сведения об обработке сообщений. Некоторые из наиболее интересных агенты описаны в следующих разделах.

#### <a name="spam-filter-agent"></a>Агент фильтра нежелательной почты

Значение **custom_data** , начинается с `S:SFA` от агента фильтрации нежелательной почты. В следующей таблице описываются основные сведения о:

|**Значение**|**Описание**|
|:-----|:-----|
|`SFV=NSPM`|Сообщение помечено как не являющееся нежелательным и отправлено указанным получателям.|
|`SFV=SPM`|Сообщение помечено фильтром содержимого как нежелательное.|
|`SFV=BLK`|Фильтрация была пропущена, а сообщение было заблокировано, так как оно исходило от заблокированного отправителя.|
|`SFV=SKS`|Сообщение помечено как нежелательное до обработки фильтром содержимого. Это применяется к сообщениям, в которых сообщение сопоставлено с правилом транспорта автоматически помечать его как нежелательное и обходить любую дополнительную фильтрацию.|
|`SCL=<number>`|Дополнительные сведения о различных значениях вероятности нежелательной почты и их значении см. в разделе [Вероятность нежелательной почты](https://technet.microsoft.com/library/jj200686.aspx).  |
|`PCL=<number>`|Значение вероятности фишинга для сообщения. Эти значения можно интерпретировать так же, как и значения SCL, которые задокументированы в [Вероятность нежелательной почты](https://technet.microsoft.com/library/jj200686.aspx).  |
|`DI=SB`|Отправитель сообщения заблокирован.|
|`DI=SQ`|Сообщение перемещено в карантин.|
|`DI=SD`|Сообщение удалено.|
|`DI=SJ`|Сообщение отправлено в папку нежелательной почты получателя.|
|`DI=SN`|Сообщение перенаправлено через пул доставки высокого риска. Дополнительные сведения см в [пул высокого риска доставки для исходящих сообщений](https://technet.microsoft.com/library/jj200746.aspx).|
|`DI=SO`|Сообщение перенаправлено через пул обычной исходящей доставки.|
|"SFS = []|SFS = [b] "|Это означает выполнение правил нежелательной почты.|
|`IPV=CAL`|Сообщение пропущено через фильтр нежелательной почты, поскольку IP-адрес указан в списке разрешенных IP-адресов в фильтре подключений.|
|`H=<EHLOstring>`|Строка HELO или EHLO подключающегося сервера электронной почты.|
|`PTR=<ReverseDNS>`|Запись PTR отправляющего IP-адреса, называемая также обратным DNS-адресом.|

Пример **custom_data** значения для сообщение, в котором выполняется фильтрация нежелательной почты следующим образом:

`S:SFA=SUM|SFV=SPM|IPV=CAL|SRV=BULK|SFS=470454002|SFS=349001|SCL=9|SCORE=-1|LIST=0|DI=SN|RD=ftmail.inc.com|H=ftmail.inc.com|CIP=98.129.140.74|SFP=1501|ASF=1|CTRY=US|CLTCTRY=|LANG=en|LAT=287|LAT=260|LAT=18;`

#### <a name="malware-filter-agent"></a>Агент фильтра вредоносных программ

Значение **custom_data** , начинается с `S:AMA` от агента фильтрации вредоносных программ. В следующей таблице описываются основные сведения о:

|**Значение**|**Описание**|
|:-----|:-----|
|"AMA = СУММ|v = 1|` or `AMA = EV|v = 1"|Сообщение было определено вредоносная программа. `SUM` указывает вредоносная программа может был обнаружен любое количество ядер. `EV` указывает, определенного ядром обнаружена вредоносная программа. При обнаружении вредоносной программы обработчиком что это запускает последующие действия.|
|`Action=r`|Сообщение заменено.|
|`Action=p`|Сообщение не проходило фильтрацию.|
|`Action=d`|Сообщение отложено.|
|`Action=s`|Сообщение удалено.|
|`Action=st`|Сообщение не проходило фильтрацию.|
|`Action=sy`|Сообщение не проходило фильтрацию.|
|`Action=ni`|Сообщение отклонено.|
|`Action=ne`|Сообщение отклонено.|
|`Action=b`|Сообщение заблокировано.|
|`Name=<malware>`|Имя обнаруженной вредоносной программы.|
|`File=<filename>`|Имя файла, содержащего вредоносные программы.|

Пример значения **custom_data** для сообщения, содержащего вредоносные программы выглядит следующим образом:

`S:AMA=SUM|v=1|action=b|error=|atch=1;S:AMA=EV|engine=M|v=1|sig=1.155.974.0|name=DOS/Test_File|file=filename;S:AMA=EV|engine=A|v=1|sig=201707282038|name=Test_File|file=filename`

#### <a name="transport-rule-agent"></a>Агент правил транспорта

Значение **custom_data** , начинается с`S:TRA` от агента правил транспорта для правил потока обработки почты (также известной как правила транспорта). В следующей таблице описываются основные сведения о:

|**Значение**|**Описание**|
|:-----|:-----|
|"ETR|ruleId =<guid>`|Выполнено правило идентификатора.|
|`St=<datetime>`|Дата и время в формате UTC, при возникновении соответствующие правила.|
|`Action=<ActionDefinition>`|Действие, которая была применена. Список доступных действий в разделе [поток обработки почты действия правил в Exchange Online](https://technet.microsoft.com/library/jj919237.aspx).|
|`Mode=<Mode>`|Режим правило. Допустимыми значениями являются:<br/>• **Enforce**: все действия правила используются принудительно. <br/>• **Тест с подсказками политики:**: все действия правила отправляются, но другие принудительные действия не применяются на. <br/>• **Test without Policy Tips**: действия перечисляются в файле журнала, но отправители не получают никаких уведомлений и принудительные действия не применяются на.|

Пример значения **custom_data** для сообщений, которая соответствует условиям правила потока обработки почты выглядит следующим образом:

`S:TRA=ETR|ruleId=19a25eb2-3e43-4896-ad9e-47b6c359779d|st=7/17/2017 12:31:25 AM|action=ApplyHtmlDisclaimer|sev=1|mode=Enforce`
