---
title: Office 365 устойчивости данных Exchange
ms.author: robmazz
author: robmazz
manager: laurawi
ms.date: 8/21/2018
audience: ITPro
ms.topic: article
ms.service: Office 365 Administration
localization_priority: None
search.appverid:
- MET150
ms.collection: Strat_O365_Enterprise
description: Описание различных аспектов устойчивости данных в Exchange Online и Office 365.
ms.openlocfilehash: 8d0448a95f010b766faf852a374513a1c2da61fa
ms.sourcegitcommit: 36c5466056cdef6ad2a8d9372f2bc009a30892bb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/27/2018
ms.locfileid: "22534741"
---
# <a name="exchange-online-data-resiliency-in-office-365"></a><span data-ttu-id="33aea-103">Устойчивость Exchange Online данных в Office 365</span><span class="sxs-lookup"><span data-stu-id="33aea-103">Exchange Online Data Resiliency in Office 365</span></span>

## <a name="introduction"></a><span data-ttu-id="33aea-104">Введение</span><span class="sxs-lookup"><span data-stu-id="33aea-104">Introduction</span></span>
<span data-ttu-id="33aea-p101">Существует два типа повреждения, которые могут влиять на базе Exchange: физическое повреждение, который обычно вызвано проблемами с оборудованием (в частности, устройств хранения данных), и логических повреждений, которое происходит из-за других факторов. Как правило существует два типа логических повреждений, которая может возникнуть в базе данных Exchange.</span><span class="sxs-lookup"><span data-stu-id="33aea-p101">There are two types of corruption that can affect an Exchange database: physical corruption, which is typically caused by hardware (in particular, storage hardware) problems, and logical corruption, which occurs due to other factors. Generally, there are two types of logical corruption that can occur within an Exchange database:</span></span> 
- <span data-ttu-id="33aea-p102">**Логическая повреждение базы данных** - соответствия контрольной суммой страницы базы данных, но данные на странице неверный логически. Это происходит при попытке записи страницы базы данных ядро базы данных (Extensible хранилищ (ESE)) и несмотря на то, что операционная система возвращает сообщение об успешном выполнении, данные либо никогда не записываются на диск или записывается в неправильное место. Это называется *flush потеряны*. ESE включает в себя ряд функций меры безопасности, которые позволяют предотвратить физическое повреждение базы данных и других сценариях потери данных. Для предотвращения потери данных потеряны удалений ESE включает в себя механизм потеряны сброса обнаружения в базе данных, а также компонент (восстановления одной страницы) и исправить.</span><span class="sxs-lookup"><span data-stu-id="33aea-p102">**Database logical corruption** - The database page checksum matches, but the data on the page is wrong logically. This can occur when the database engine (the Extensible Storage Engine (ESE)) attempts to write a database page and even though the operating system returns a success message, the data is either never written to the disk or it's written to the wrong place. This is referred to as a *lost flush*. ESE includes numerous features and safeguards that are designed to prevent physical corruption of a database and other data loss scenarios. To prevent lost flushes from losing data, ESE includes a lost flush detection mechanism in the database along with a feature (single page restore) to correct it.</span></span> 
- <span data-ttu-id="33aea-p103">**Хранилище логических повреждений** - данных добавлена, удаляется или таким образом, чтобы пользователь не нужны. Таких случаях, обычно вызваны приложениями сторонних производителей. Обычно это повреждение только в том смысле, что пользователь просматривает его как повреждение. Хранилище Exchange учитывает операции, произведено логического повреждения быть ряд допустимый операций MAPI. Функции [Хранения на месте](https://docs.microsoft.com/exchange/security-and-compliance/create-or-remove-in-place-holds) в Exchange Online обеспечивает защиту от логических повреждений store (так как он не содержимое удаляется без возможности восстановления пользователем или приложение).</span><span class="sxs-lookup"><span data-stu-id="33aea-p103">**Store logical corruption** - Data is added, deleted, or manipulated in a way that the user doesn't expect. These cases are generally caused by third-party applications. It's generally only corruption in the sense that the user views it as corruption. The Exchange store considers the transaction that produced the logical corruption to be a series of valid MAPI operations. The [In-Place Hold](https://docs.microsoft.com/exchange/security-and-compliance/create-or-remove-in-place-holds) features in Exchange Online provides protection from store logical corruption (because it prevents content from being permanently deleted by a user or an application).</span></span> 

<span data-ttu-id="33aea-p104">Exchange Online выполняет несколько проверку целостности в отношении файлов журнала реплицированной во время проверки журналов и преобразования журнала. Эти проверки согласованности запретить физическое повреждение из реплицируются системой. Например во время проверки журнала, производится проверка физической целостности которого проверяется файл журнала и проверяет, что контрольная сумма, записанные в файл журнала совпадает с контрольной суммой, созданных в памяти. Кроме того заголовок файла журнала проверить, чтобы соответствовать подписи файла журнала, записанные в журнал заголовок, файл журнала. Во время преобразования журнала файл журнала будет выполнена дальнейшей к критическому анализу. Например заголовок базы данных также содержит подпись журнала, который сравнивается с подписью файла журнала, чтобы убедиться, что они соответствуют.</span><span class="sxs-lookup"><span data-stu-id="33aea-p104">Exchange Online performs several consistency checks on replicated log files during both log inspection and log replay. These consistency checks prevent physical corruption from being replicated by the system. For example, during log inspection, there is a physical integrity check which verifies the log file and validates that the checksum recorded in the log file matches the checksum generated in memory. In addition, the log file header is examined to make sure the log file signature recorded in the log header matches that of the log file. During log replay, the log file undergoes further scrutiny. For example, the database header also contains the log signature which is compared with the log file's signature to ensure they match.</span></span> 

<span data-ttu-id="33aea-p105">Защита от повреждения данных почтовых ящиков в Exchange Online выполняется с помощью собственного защиты данных Exchange, стратегии обеспечения устойчивости, использующая уровня приложения репликации между несколькими серверами и нескольких центрах обработки данных, а также другие функции, которые помогают защитить данные от потери из-за повреждения или по другим причинам. Эти возможности включают собственные функции, которые управляются корпорацией Майкрософт или Exchange Online самого приложения, такие как:</span><span class="sxs-lookup"><span data-stu-id="33aea-p105">Protection against corruption of mailbox data in Exchange Online is achieved by using Exchange Native Data Protection, a resiliency strategy that leverages application-level replication across multiple servers and multiple datacenters along with other features that help protect data from being lost due to corruption or other reasons. These features include native features that are managed by Microsoft or the Exchange Online application itself, such as:</span></span>

- [<span data-ttu-id="33aea-125">Группы обеспечения доступности данных</span><span class="sxs-lookup"><span data-stu-id="33aea-125">Data Availability Groups</span></span>](https://docs.microsoft.com/exchange/back-up-email)
- <span data-ttu-id="33aea-126">Исправление отдельного</span><span class="sxs-lookup"><span data-stu-id="33aea-126">Single Bit Correction</span></span> 
- <span data-ttu-id="33aea-127">Проверка Online баз данных</span><span class="sxs-lookup"><span data-stu-id="33aea-127">Online Database Scanning</span></span> 
- <span data-ttu-id="33aea-128">Обнаружение потерянных очистки</span><span class="sxs-lookup"><span data-stu-id="33aea-128">Lost Flush Detection</span></span> 
- <span data-ttu-id="33aea-129">Восстановление одной страницы</span><span class="sxs-lookup"><span data-stu-id="33aea-129">Single Page Restore</span></span> 
- <span data-ttu-id="33aea-130">Служба репликации почтовых ящиков</span><span class="sxs-lookup"><span data-stu-id="33aea-130">Mailbox Replication Service</span></span> 
- <span data-ttu-id="33aea-131">Проверка файлов журналов</span><span class="sxs-lookup"><span data-stu-id="33aea-131">Log File Checks</span></span> 
- <span data-ttu-id="33aea-132">Развертывание на устойчивое файловой системы</span><span class="sxs-lookup"><span data-stu-id="33aea-132">Deployment on Resilient File System</span></span> 

<span data-ttu-id="33aea-p106">Дополнительные сведения о перечисленных выше функций щелкните гиперссылки выше и ниже приведены дополнительные сведения и подробные сведения о элементов без гиперссылки. Помимо этих собственные функции Exchange Online также включает в себя функции устойчивости данных, которые могут управлять клиентами, таких как:</span><span class="sxs-lookup"><span data-stu-id="33aea-p106">For more information on the native features listed above, click on the above hyperlinks, and see below for additional information and for details on items without hyperlinks. In addition to these native features, Exchange Online also includes data resiliency features that customers can manage, such as:</span></span> 
- [<span data-ttu-id="33aea-135">Восстановления одного элемента (включена по умолчанию)</span><span class="sxs-lookup"><span data-stu-id="33aea-135">Single Item Recovery (enabled by default)</span></span>](https://docs.microsoft.com/exchange/recipients-in-exchange-online/manage-user-mailboxes/recover-deleted-messages) 
- [<span data-ttu-id="33aea-136">Хранение на месте и хранение для судебного разбирательства</span><span class="sxs-lookup"><span data-stu-id="33aea-136">In-Place Hold and Litigation Hold</span></span>](https://docs.microsoft.com/exchange/security-and-compliance/in-place-and-litigation-holds) 
- [<span data-ttu-id="33aea-137">Удаленный элемент удержания и почтовые ящики Soft-Deleted (оба включена по умолчанию)</span><span class="sxs-lookup"><span data-stu-id="33aea-137">Deleted Item Retention and Soft-Deleted Mailboxes (both enabled by default)</span></span>](https://docs.microsoft.com/exchange/recipients-in-exchange-online/delete-or-restore-mailboxes) 

## <a name="database-availability-groups"></a><span data-ttu-id="33aea-138">Группы доступности базы данных</span><span class="sxs-lookup"><span data-stu-id="33aea-138">Database Availability Groups</span></span> 
<span data-ttu-id="33aea-p107">Каждой базы данных почтовых ящиков в Office 365 размещены в [группе доступности базы данных (DAG)](https://docs.microsoft.com/exchange/back-up-email) и реплицировать отдельные географически центров обработки данных в пределах той же области. Наиболее распространенные конфигурации — это четыре копий базы данных в четырех центров обработки данных; Тем не менее некоторые области имеют меньше центров обработки данных (баз данных, реплицируются на три центров обработки данных в Индии и двух центров обработки данных в Австралия и Японии). Но во всех случаях каждой базы данных почтовых ящиков четыре копии, распределенных в нескольких центрах обработки данных, обеспечивая защиту данных почтовых ящиков из программного обеспечения, оборудования и даже сбои центра обработки данных.</span><span class="sxs-lookup"><span data-stu-id="33aea-p107">Every mailbox database in Office 365 is hosted in a [database availability group (DAG)](https://docs.microsoft.com/exchange/back-up-email) and replicated to geographically-separate datacenters within the same region. The most common configuration is four database copies in four datacenters; however, some regions have fewer datacenters (databases are replicated to three datacenters in India, and two datacenters in Australia and Japan). But in all cases, every mailbox database has four copies that are distributed across multiple datacenters, thereby ensuring that mailbox data is protected from software, hardware, and even datacenter failures.</span></span> 

<span data-ttu-id="33aea-p108">Из него эти четыре копии три из них настроены с высокой доступностью. Четвертая копии настроен как [Изолированная копия базы данных](https://docs.microsoft.com/Exchange/high-availability/manage-ha/activate-lagged-db-copies). Копии базы данных не предназначен для восстановления отдельных почтовых ящиков или восстановление элементов почтового ящика. Он предназначен для обеспечения редких случаях логических повреждений системных, аварийное восстановление.</span><span class="sxs-lookup"><span data-stu-id="33aea-p108">Out of these four copies, three of them are configured as highly available. The fourth copy is configured as a [lagged database copy](https://docs.microsoft.com/Exchange/high-availability/manage-ha/activate-lagged-db-copies). The lagged database copy is not intended for individual mailbox recovery or mailbox item recovery. Its purpose is to provide a recovery mechanism for the rare event of system-wide, catastrophic logical corruption.</span></span> 

<span data-ttu-id="33aea-p109">Изолированных копиях базы данных в Exchange Online настроены с времени задержки преобразования файлов журнала семь дней. Кроме того диспетчер запаздывания преобразования Exchange включен для обеспечения воспроизвести файл журнала динамических вниз для изолированные копии разрешить изолированных копиях базы данных самостоятельно восстановить и управлять ими увеличение размера файла журнала. Несмотря на то, что изолированные копии используются в Exchange Online, важно понимать, что они не гарантируется резервного копирования в момент. Доступность порогового значения, обычно около 90% из-за периоды, где диск, содержащий изолированной копии теряются из-за сбоя жесткого диска, изолированная копия становится высокой доступностью скопируйте (из-за автоматического воспроизведения вниз), а также имеют изолированных копиях базы данных в Exchange Online периоды, где копии базы данных повторное построение журнал воспроизведение очереди.</span><span class="sxs-lookup"><span data-stu-id="33aea-p109">Lagged database copies in Exchange Online are configured with a seven-day log file replay lag time. In addition, the Exchange Replay Lag Manager is enabled to provide dynamic log file play down for lagged copies to allow lagged database copies to self-repair and manage log file growth. Although lagged database copies are used in Exchange Online, it is important to understand that they are not a guaranteed point-in-time backup. Lagged database copies in Exchange Online have an availability threshold, typically around 90%, due to periods where the disk containing a lagged copy is lost due to disk failure, the lagged copy becoming a highly-available copy (due to automatic play down), as well as the periods where the lagged database copy is re-building the log replay queue.</span></span> 

## <a name="transport-resilience"></a><span data-ttu-id="33aea-150">Устойчивость транспорта</span><span class="sxs-lookup"><span data-stu-id="33aea-150">Transport Resilience</span></span> 
<span data-ttu-id="33aea-p110">Exchange Online содержит две возможности устойчивости основной транспорта: теневая избыточность и системы безопасности. Теневая избыточность хранит избыточные копии сообщения, несмотря на то во время передачи. Системы безопасности хранит избыточные копии сообщения после сообщение успешно доставлено.</span><span class="sxs-lookup"><span data-stu-id="33aea-p110">Exchange Online includes two primary transport resilience features: Shadow Redundancy and Safety Net. Shadow Redundancy keeps a redundant copy of a message while it is in transit. Safety Net keeps a redundant copy of a message after the message is successfully delivered.</span></span> 

<span data-ttu-id="33aea-p111">С помощью теневая избыточность каждого Exchange Online транспортный сервер создает копию всех сообщений, полученных до его подтверждает успешно сообщения серверу. Это делает все сообщения в транспортном конвейере избыточных в процессе передачи. Если Exchange Online определяет, что исходное сообщение было потеряны во время передачи, — это отгрузки избыточные копии сообщения.</span><span class="sxs-lookup"><span data-stu-id="33aea-p111">With Shadow Redundancy, each Exchange Online transport server makes a copy of each messages it receives before it acknowledges successfully receiving the message to the sending server. This makes all messages in the transport pipeline redundant while in transit. If Exchange Online determines the original message was lost in transit, a redundant copy of the message is redelivered.</span></span> 

<span data-ttu-id="33aea-p112">Системы безопасности — это очереди транспорта, связанный со службой транспорта на сервере почтовых ящиков. Эта очередь сохранение копий сообщений, которые были успешно обработан сервером. Если сбой базы данных или сервера почтовых ящиков потребуется активация устаревшую копию базы данных почтовых ящиков, сообщения из очереди системы безопасности автоматически передаются повторно новой активной копии базы данных почтовых ящиков. Системы безопасности также является избыточной, что исключает транспорта как единственная точка отказа. При котором используется концепция основной сети Safety Net и тени Safety Net недоступность основной сети Safety Net более 12 часов, повторно отправить запросы становятся запросы на повторное представление теневой и сообщения, повторно доставлено из Safety Net теневой.</span><span class="sxs-lookup"><span data-stu-id="33aea-p112">Safety Net is a transport queue that is associated with the Transport service on a Mailbox server. This queue stores copies of messages that were successfully processed by the server. When a mailbox database or server failure requires activating an out-of-date copy of the mailbox database, messages in the Safety Net queue are automatically resubmitted to the new active copy of the mailbox database. Safety Net is also redundant, thereby eliminating transport as a single point of failure. It uses the concept of a Primary Safety Net and a Shadow Safety Net wherein if the Primary Safety Net is unavailable for more than 12 hours, resubmit requests become shadow resubmit requests, and messages are re-delivered from the Shadow Safety Net.</span></span>

<span data-ttu-id="33aea-p113">Resubmissions сообщений от сети Safety Net автоматически инициированных Active Manager компонент Служба репликации Microsoft Exchange, который управляет групп DAG и почтовых ящиков копии базы данных. Повторная отправка сообщений от сети Safety Net необходимые действия не вручную.</span><span class="sxs-lookup"><span data-stu-id="33aea-p113">Message resubmissions from Safety Net are automatically initiated by the Active Manager component of the Microsoft Exchange Replication service that manages DAGs and mailbox database copies. No manual actions are required to resubmit messages from Safety Net.</span></span> 

## <a name="single-bit-correction"></a><span data-ttu-id="33aea-164">Исправление отдельного</span><span class="sxs-lookup"><span data-stu-id="33aea-164">Single Bit Correction</span></span> 
<span data-ttu-id="33aea-p114">ESE включает механизм для поиска и устранения ошибок контрольной СУММЫ незначительно (также называемого single-бита), которые являются результатом ошибок оборудования (и таким образом они представляют физическое повреждение). При возникновении этих ошибок ESE автоматически исправляет их и регистрирует событие в журнале событий.</span><span class="sxs-lookup"><span data-stu-id="33aea-p114">ESE includes a mechanism to detect and resolve single-bit CRC errors (aka single-bit flips) that are the result of hardware errors (and as such they represent physical corruption). When these errors occur, ESE automatically corrects them and logs an event in the event log.</span></span> 

## <a name="online-database-scanning"></a><span data-ttu-id="33aea-167">Проверка Online баз данных</span><span class="sxs-lookup"><span data-stu-id="33aea-167">Online Database Scanning</span></span> 
<span data-ttu-id="33aea-p115">Проверка (также известной как *расчет контрольной суммы базы данных*) Online баз данных — это процесс, где ESE использует проверки согласованности базы данных для чтения каждой страницы и проверьте наличие повреждений страницы. Основной целью — для обнаружения физическое повреждение и потере удалений, которые не начало найдет транзакционные операции. Сканирование базы данных также выполняет операции хранилище после сбоя. Утечка пространства из-за сбоев и сканирования online базы данных выполняется поиск и восстанавливает потеряны пространства. Система разработана на основе предположения, что в каждой базе данных полностью сканируются один раз в неделю.</span><span class="sxs-lookup"><span data-stu-id="33aea-p115">Online database scanning (also known as *database checksumming*) is the process where an ESE uses a database consistency checker to read each page and check for page corruption. The primary purpose is to detect physical corruption and lost flushes that may not be getting detected by transactional operations. Database scanning also performs post-store crash operations. Space can be leaked due to crashes, and online database scanning finds and recovers lost space. The system is designed with the expectation that every database is fully scanned once every seven days.</span></span> 

## <a name="lost-flush-detection"></a><span data-ttu-id="33aea-173">Обнаружение потерянных очистки</span><span class="sxs-lookup"><span data-stu-id="33aea-173">Lost Flush Detection</span></span> 
<span data-ttu-id="33aea-p116">Потеряны сброс происходит, когда операция записи базы данных, подсистемы и операционная система диск возвращаются как выполненное не фактически удалось записать на диск или был записан неверно. Утеряны сброса происшествия можно результатов в логической повреждение базы данных, таким образом, чтобы предотвратить потеряны удалений приведет к потере данных ESE включает в себя механизм потеряны сброса обнаружения. Оговоренные страниц базы данных для пассивной копии выполняется проверка выполняется для потеряны удалений в активной копии. В случае обнаружения потерянных Сброс ESE можно восстановить процесс, ссылаясь на страницу, процесс применения исправлений.</span><span class="sxs-lookup"><span data-stu-id="33aea-p116">A lost flush occurs when a database write operation that the disk subsystem/operating system returned as completed did not actually get written to disk, or was written in the wrong location. Lost flush incidents can result in database logical corruption, so to prevent lost flushes from resulting in lost data, ESE includes a lost flush detection mechanism. As database pages are written to passive copies, a check is performed for lost flushes on the active copy. If a lost flush is detected, ESE can repair the process using a page patching process.</span></span> 

## <a name="single-page-restore"></a><span data-ttu-id="33aea-178">Восстановление одной страницы</span><span class="sxs-lookup"><span data-stu-id="33aea-178">Single Page Restore</span></span> 
<span data-ttu-id="33aea-p117">Восстановления одной страницы или *исправление страницы*, — это происходит автоматически, где страниц повреждение базы данных, заменяются работоспособных копий из работоспособном реплики. Процесс восстановления для поврежденные страницы зависит от копии базы данных активном или пассивном состоянии. При активной копии базы данных обнаруживает поврежденные страницы, его можно скопировать страницы из одного из его реплики условии, что страницы, которые копируются в этой версии. Для этого, поместив запрос для страницы в журнал поток, который является основой для репликации базы данных почтовых ящиков. Как только реплики обнаруживает запрос страницы отвечает, отправляя копии страницы запрашивающая копии базы данных. Восстановление одной страницы также предоставляет механизм асинхронной связи для активного для запроса на страницу с репликами, даже в том случае, если реплики в автономном режиме.</span><span class="sxs-lookup"><span data-stu-id="33aea-p117">Single page restore, aka *page patching*, is an automatic process where corrupt database pages are replaced by healthy copies from a healthy replica. The repair process for a corrupt page depends on whether the database copy is active or passive. When an active database copy encounters a corrupted page, it can copy a page from one of its replicas, provided the page it copies is completely up-to-date. This is accomplished by putting a request for the page into the log stream, which is the basis of mailbox database replication. As soon as a replica encounters the page request it responds by sending a copy of the page to the requesting database copy. Single page restore also provides an asynchronous communication mechanism for the active to request a page from replicas, even if the replicas are currently offline.</span></span> 

<span data-ttu-id="33aea-p118">В случае повреждения в пассивная копия базы данных включая копии базы данных, так как эти копии, всегда за их активной копии, всегда безопасно для копирования любую страницу из активной копии пассивной копии. Пассивная копия базы данных является с высокой доступностью, характер, поэтому во время страницы, процесс применения исправлений, приостановлен воспроизведения журналов и копирование журнала продолжает. Пассивная копия базы данных получает копии поврежденные страницы из активной копии, ждет, пока файл журнала, который отвечает требованиям поколения максимальное журналов копируются и проверить и затем исправления поврежденных страниц. После окончания доступ странице возобновляется воспроизведения журналов. Процесс одинаков для копии базы данных, за исключением того изолированной базы данных сначала преобразует все файлы журналов, которые необходимы для достижения исправлять состояний.</span><span class="sxs-lookup"><span data-stu-id="33aea-p118">In case of corruption in a passive database copy, including a lagged database copy, because these copies are always behind their active copy, it is always safe to copy any page from the active copy to a passive copy. A passive database copy is by nature highly available, so during the page patching process, log replaying is suspended, but log copying continues. The passive database copy retrieves a copy of the corrupted page from the active copy, waits until the log file which meets the maximum required log generation requirement is copied and inspected, and then patches the corrupt page. Once the page has been patched, log replay resumes. The process is the same for the lagged database copy, except that the lagged database first replays all log files that are necessary to achieve a patchable state.</span></span> 

## <a name="mailbox-replication-service"></a><span data-ttu-id="33aea-190">Служба репликации почтовых ящиков</span><span class="sxs-lookup"><span data-stu-id="33aea-190">Mailbox Replication Service</span></span> 
<span data-ttu-id="33aea-p119">Перемещение почтовых ящиков является основной частью управление большими объемами электронной почты службы. Всегда существуют обновленные технологии, а затем оборудования и версии обновления для смягчения последствий, поэтому необходимости надежную, регулирование систему, позволяющую наши инженеры для выполнения этих действий, сохраняя почтового ящика прозрачной для пользователей (, убедившись, что они остаются в оперативном режиме в процессе) — ключ и проверьте, что процесс масштабируются соответствующим образом как почтовые ящики получите размером и размером.</span><span class="sxs-lookup"><span data-stu-id="33aea-p119">Moving mailboxes is a key part of managing a large-scale email service. There are always updated technologies and hardware and version upgrades to deal with, so having a robust, throttled system that enables our engineers to accomplish this work while keeping the mailbox moves transparent to users (by making sure they stay online throughout the process) is key and making sure that the process scales up gracefully as mailboxes get larger and larger.</span></span> 

<span data-ttu-id="33aea-p120">Служба репликации почтовых ящиков Exchange (MRS) несет ответственность за перемещение почтовых ящиков из базы данных. Во время перемещения службы репликации почтовых ЯЩИКОВ выполняет проверку согласованности всех элементов в почтовом ящике. Если ошибки согласованности службы репликации почтовых ЯЩИКОВ будет устранить проблему либо пропустить поврежденные элементы, удаляя повреждения из почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="33aea-p120">The Exchange Mailbox Replication Service (MRS) is responsible for moving mailboxes between databases. During the move, MRS performs a consistency check on all items within the mailbox. If a consistency issue is found, MRS will either correct the problem, or skip the corrupted items, thereby removing the corruption from the mailbox.</span></span> 

<span data-ttu-id="33aea-p121">Так как службы репликации почтовых ЯЩИКОВ является компонентом версией Exchange через Интернет, мы можно внести изменения в коде адрес новых форм повреждения, обнаруженные в будущем. Например, если мы обнаружить согласованности проблему, которая не сможет исправить службы репликации почтовых ЯЩИКОВ, мы можно анализа повреждения, изменить код службы репликации почтовых ЯЩИКОВ и решения несоответствия (если мы понимаем, как).</span><span class="sxs-lookup"><span data-stu-id="33aea-p121">Because MRS is a component of Exchange Online, we can make changes in its code to address new forms of corruption that are detected in the future. For example, if we detect a consistency issue that MRS is not able to fix, we can analyze the corruption, change the MRS code and correct the inconsistency (if we understand how to).</span></span> 

## <a name="log-file-checks"></a><span data-ttu-id="33aea-198">Проверка файлов журналов</span><span class="sxs-lookup"><span data-stu-id="33aea-198">Log File Checks</span></span> 
<span data-ttu-id="33aea-p122">Все файлы журналов транзакций, созданных функцией базы данных Exchange подвергаются несколько форм проверки согласованности. При создании файла журнала, первое, что Готово — записываться битовый шаблон, а затем выполнить ряд операций записи в журнал. Это позволяет Exchange Online, чтобы выполнить последовательность проверок (Очистка потерянных, контрольной СУММЫ и другие проверки) для проверки в каждый файл журнала будет записан и снова репликации.</span><span class="sxs-lookup"><span data-stu-id="33aea-p122">All transaction log files generated by an Exchange database undergo several forms of consistency checks. When a log file is created, the first thing done is a bit pattern is written and then a series of log writes is performed. This enables Exchange Online to execute a series of checks (lost flush, CRC and other checks) to validate each log file as it is written, and again as it is replicated.</span></span> 

## <a name="deployment-on-resilient-file-system"></a><span data-ttu-id="33aea-202">Развертывание на устойчивое файловой системы</span><span class="sxs-lookup"><span data-stu-id="33aea-202">Deployment on Resilient File System</span></span> 
<span data-ttu-id="33aea-p123">Чтобы предотвратить повреждение реестра на уровне файловой системы, Exchange Online развертывается в разделах устойчивое файловой системы (ссылки) для обеспечения возможностей улучшения восстановления. Ссылки — файловая система Windows Server 2012 и более поздних версий, предназначенный для более высокая устойчивость от повреждения данных максимально возможной доступность данных и целостности данных. В частности, ReFS сводит улучшения, как метаданные обновляется обеспечивает лучшую защиту данных и сокращает случаев повреждения данных. Также использует контрольные суммы для проверки целостности файлов данных и метаданных, проверка того, повреждение данных легко найти и восстановить.</span><span class="sxs-lookup"><span data-stu-id="33aea-p123">To help prevent corruption from occurring at the file system level, Exchange Online is being deployed on Resilient File System (ReFS) partitions to provide improved recovery capabilities. ReFS is a file system in Windows Server 2012 and later that is designed to be more resilient against data corruption thereby maximizing data availability and integrity. Specifically, ReFS brings improvements in the way that metadata is updated which offers better protection for data and reduces data corruption cases. It also uses checksums to verify the integrity of file data and metadata ensuring that data corruption is easily found and repaired.</span></span> 

<span data-ttu-id="33aea-207">Exchange Online использует несколько преимуществ ссылки:</span><span class="sxs-lookup"><span data-stu-id="33aea-207">Exchange Online takes advantage of several ReFS benefits:</span></span> 
- <span data-ttu-id="33aea-p124">Дополнительные устойчивости в целостность данных означает, что не более чем происшествия повреждение данных. Уменьшение числа происшествия повреждение означает, что не более чем reseeds ненужные базы данных.</span><span class="sxs-lookup"><span data-stu-id="33aea-p124">More resiliency in data integrity means fewer data corruption incidents. Reducing the number of corruption incidents means fewer unnecessary database reseeds.</span></span> 
- <span data-ttu-id="33aea-210">Контрольная сумма, запущенные на метаданных Включение обнаружения повреждения случаев быстрее и более образом создать ситуацию, позволяющего исправить данные клиента повреждение перед серую сбоях на тома для данных.</span><span class="sxs-lookup"><span data-stu-id="33aea-210">Checksum running on metadata enabling detections of corruption cases sooner and more deterministically, allowing us to fix customer data corruption before grey failures occur on data volumes.</span></span>
- <span data-ttu-id="33aea-211">Предназначена для работы, так и с очень большие наборы данных — петабайтах и большего — не влияет на производительность</span><span class="sxs-lookup"><span data-stu-id="33aea-211">Designed to work well with extremely large data sets—petabytes and larger—without performance impact</span></span>
- <span data-ttu-id="33aea-212">Поддержка для других компонентов, используемых Exchange Online, такие как шифрование BitLocker.</span><span class="sxs-lookup"><span data-stu-id="33aea-212">Support for other features used by Exchange Online, such as BitLocker encryption.</span></span> 

<span data-ttu-id="33aea-213">Exchange Online также использует преимущества от других функций ссылки:</span><span class="sxs-lookup"><span data-stu-id="33aea-213">Exchange Online also benefits from other ReFS features:</span></span> 
- <span data-ttu-id="33aea-p125">**Целостность (целостности потоков)** - ReFS хранит данные, чтобы защищает от многие из наиболее распространенных ошибок, которые обычно может привести к потере данных. Office 365 поиска используются потоки целостности для раннего обнаружения повреждение диска и копий содержимое файла. Также снижает происшествия повреждения, вызванные «Разрыва записывает» (при операции записи не завершается из-за имеет смысл использовать, и т.д.).</span><span class="sxs-lookup"><span data-stu-id="33aea-p125">**Integrity (Integrity Streams)** - ReFS stores data in a way that protects it from many of the common errors that can normally cause data loss. Office 365 Search uses Integrity Streams to help with early disk corruption detection and checksums of file content. The feature also reduces corruption incidents caused by “Torn Writes” (when a write operation does not complete due to power outages, etc.).</span></span> 
- <span data-ttu-id="33aea-p126">**Доступность (восстановленную)** — ссылки приоритет отдается доступности данных. С исторической точки зрения часто были подвержена повреждение данных, который требуется системы в автономном режиме для восстановления файловой системы. Несмотря на то что редко, если повреждение ReFS implements восстановить, функциональная возможность, которая удаляет поврежденных данных из пространства имен на томе live и гарантирует, что хороший данных — это не испытывает негативного влияния не исправить поврежденных данных. Применение функции восстановления и изоляция повреждение данных в Exchange Online тома для базы данных означает, что мы можно хранить баз данных не влияет на томе поврежденные работоспособном между временем действия повреждения и восстановления. Это повышает доступность базы данных, которые обычно влияния такие вопросы, повреждение диска.</span><span class="sxs-lookup"><span data-stu-id="33aea-p126">**Availability (Salvage)** - ReFS prioritizes the availability of data. Historically, file systems were often susceptible to data corruption that would require the system to be taken offline for repair. Although rare, if corruption does occur, ReFS implements salvage, a feature that removes the corrupt data from the namespace on a live volume and ensures that good data is not adversely affected by non-repairable corrupt data. Applying the Salvage feature and isolating data corruption to Exchange Online database volumes means that we can keep non-affected databases on a corrupted volume healthy between the time of corruption and repair action. This increases the availability of databases that would normally be affected by such disk corruption issues.</span></span> 