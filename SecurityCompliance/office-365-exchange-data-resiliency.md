---
title: Office 365 устойчивости данных Exchange
ms.author: robmazz
author: robmazz
manager: laurawi
ms.date: 8/21/2018
audience: ITPro
ms.topic: article
ms.service: Office 365 Administration
localization_priority: None
search.appverid:
- MET150
ms.collection: Strat_O365_Enterprise
description: Описание различных аспектов устойчивости данных в Exchange Online и Office 365.
ms.openlocfilehash: 8d0448a95f010b766faf852a374513a1c2da61fa
ms.sourcegitcommit: 36c5466056cdef6ad2a8d9372f2bc009a30892bb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/27/2018
ms.locfileid: "22534741"
---
# <a name="exchange-online-data-resiliency-in-office-365"></a>Устойчивость Exchange Online данных в Office 365

## <a name="introduction"></a>Введение
Существует два типа повреждения, которые могут влиять на базе Exchange: физическое повреждение, который обычно вызвано проблемами с оборудованием (в частности, устройств хранения данных), и логических повреждений, которое происходит из-за других факторов. Как правило существует два типа логических повреждений, которая может возникнуть в базе данных Exchange. 
- **Логическая повреждение базы данных** - соответствия контрольной суммой страницы базы данных, но данные на странице неверный логически. Это происходит при попытке записи страницы базы данных ядро базы данных (Extensible хранилищ (ESE)) и несмотря на то, что операционная система возвращает сообщение об успешном выполнении, данные либо никогда не записываются на диск или записывается в неправильное место. Это называется *flush потеряны*. ESE включает в себя ряд функций меры безопасности, которые позволяют предотвратить физическое повреждение базы данных и других сценариях потери данных. Для предотвращения потери данных потеряны удалений ESE включает в себя механизм потеряны сброса обнаружения в базе данных, а также компонент (восстановления одной страницы) и исправить. 
- **Хранилище логических повреждений** - данных добавлена, удаляется или таким образом, чтобы пользователь не нужны. Таких случаях, обычно вызваны приложениями сторонних производителей. Обычно это повреждение только в том смысле, что пользователь просматривает его как повреждение. Хранилище Exchange учитывает операции, произведено логического повреждения быть ряд допустимый операций MAPI. Функции [Хранения на месте](https://docs.microsoft.com/exchange/security-and-compliance/create-or-remove-in-place-holds) в Exchange Online обеспечивает защиту от логических повреждений store (так как он не содержимое удаляется без возможности восстановления пользователем или приложение). 

Exchange Online выполняет несколько проверку целостности в отношении файлов журнала реплицированной во время проверки журналов и преобразования журнала. Эти проверки согласованности запретить физическое повреждение из реплицируются системой. Например во время проверки журнала, производится проверка физической целостности которого проверяется файл журнала и проверяет, что контрольная сумма, записанные в файл журнала совпадает с контрольной суммой, созданных в памяти. Кроме того заголовок файла журнала проверить, чтобы соответствовать подписи файла журнала, записанные в журнал заголовок, файл журнала. Во время преобразования журнала файл журнала будет выполнена дальнейшей к критическому анализу. Например заголовок базы данных также содержит подпись журнала, который сравнивается с подписью файла журнала, чтобы убедиться, что они соответствуют. 

Защита от повреждения данных почтовых ящиков в Exchange Online выполняется с помощью собственного защиты данных Exchange, стратегии обеспечения устойчивости, использующая уровня приложения репликации между несколькими серверами и нескольких центрах обработки данных, а также другие функции, которые помогают защитить данные от потери из-за повреждения или по другим причинам. Эти возможности включают собственные функции, которые управляются корпорацией Майкрософт или Exchange Online самого приложения, такие как:

- [Группы обеспечения доступности данных](https://docs.microsoft.com/exchange/back-up-email)
- Исправление отдельного 
- Проверка Online баз данных 
- Обнаружение потерянных очистки 
- Восстановление одной страницы 
- Служба репликации почтовых ящиков 
- Проверка файлов журналов 
- Развертывание на устойчивое файловой системы 

Дополнительные сведения о перечисленных выше функций щелкните гиперссылки выше и ниже приведены дополнительные сведения и подробные сведения о элементов без гиперссылки. Помимо этих собственные функции Exchange Online также включает в себя функции устойчивости данных, которые могут управлять клиентами, таких как: 
- [Восстановления одного элемента (включена по умолчанию)](https://docs.microsoft.com/exchange/recipients-in-exchange-online/manage-user-mailboxes/recover-deleted-messages) 
- [Хранение на месте и хранение для судебного разбирательства](https://docs.microsoft.com/exchange/security-and-compliance/in-place-and-litigation-holds) 
- [Удаленный элемент удержания и почтовые ящики Soft-Deleted (оба включена по умолчанию)](https://docs.microsoft.com/exchange/recipients-in-exchange-online/delete-or-restore-mailboxes) 

## <a name="database-availability-groups"></a>Группы доступности базы данных 
Каждой базы данных почтовых ящиков в Office 365 размещены в [группе доступности базы данных (DAG)](https://docs.microsoft.com/exchange/back-up-email) и реплицировать отдельные географически центров обработки данных в пределах той же области. Наиболее распространенные конфигурации — это четыре копий базы данных в четырех центров обработки данных; Тем не менее некоторые области имеют меньше центров обработки данных (баз данных, реплицируются на три центров обработки данных в Индии и двух центров обработки данных в Австралия и Японии). Но во всех случаях каждой базы данных почтовых ящиков четыре копии, распределенных в нескольких центрах обработки данных, обеспечивая защиту данных почтовых ящиков из программного обеспечения, оборудования и даже сбои центра обработки данных. 

Из него эти четыре копии три из них настроены с высокой доступностью. Четвертая копии настроен как [Изолированная копия базы данных](https://docs.microsoft.com/Exchange/high-availability/manage-ha/activate-lagged-db-copies). Копии базы данных не предназначен для восстановления отдельных почтовых ящиков или восстановление элементов почтового ящика. Он предназначен для обеспечения редких случаях логических повреждений системных, аварийное восстановление. 

Изолированных копиях базы данных в Exchange Online настроены с времени задержки преобразования файлов журнала семь дней. Кроме того диспетчер запаздывания преобразования Exchange включен для обеспечения воспроизвести файл журнала динамических вниз для изолированные копии разрешить изолированных копиях базы данных самостоятельно восстановить и управлять ими увеличение размера файла журнала. Несмотря на то, что изолированные копии используются в Exchange Online, важно понимать, что они не гарантируется резервного копирования в момент. Доступность порогового значения, обычно около 90% из-за периоды, где диск, содержащий изолированной копии теряются из-за сбоя жесткого диска, изолированная копия становится высокой доступностью скопируйте (из-за автоматического воспроизведения вниз), а также имеют изолированных копиях базы данных в Exchange Online периоды, где копии базы данных повторное построение журнал воспроизведение очереди. 

## <a name="transport-resilience"></a>Устойчивость транспорта 
Exchange Online содержит две возможности устойчивости основной транспорта: теневая избыточность и системы безопасности. Теневая избыточность хранит избыточные копии сообщения, несмотря на то во время передачи. Системы безопасности хранит избыточные копии сообщения после сообщение успешно доставлено. 

С помощью теневая избыточность каждого Exchange Online транспортный сервер создает копию всех сообщений, полученных до его подтверждает успешно сообщения серверу. Это делает все сообщения в транспортном конвейере избыточных в процессе передачи. Если Exchange Online определяет, что исходное сообщение было потеряны во время передачи, — это отгрузки избыточные копии сообщения. 

Системы безопасности — это очереди транспорта, связанный со службой транспорта на сервере почтовых ящиков. Эта очередь сохранение копий сообщений, которые были успешно обработан сервером. Если сбой базы данных или сервера почтовых ящиков потребуется активация устаревшую копию базы данных почтовых ящиков, сообщения из очереди системы безопасности автоматически передаются повторно новой активной копии базы данных почтовых ящиков. Системы безопасности также является избыточной, что исключает транспорта как единственная точка отказа. При котором используется концепция основной сети Safety Net и тени Safety Net недоступность основной сети Safety Net более 12 часов, повторно отправить запросы становятся запросы на повторное представление теневой и сообщения, повторно доставлено из Safety Net теневой.

Resubmissions сообщений от сети Safety Net автоматически инициированных Active Manager компонент Служба репликации Microsoft Exchange, который управляет групп DAG и почтовых ящиков копии базы данных. Повторная отправка сообщений от сети Safety Net необходимые действия не вручную. 

## <a name="single-bit-correction"></a>Исправление отдельного 
ESE включает механизм для поиска и устранения ошибок контрольной СУММЫ незначительно (также называемого single-бита), которые являются результатом ошибок оборудования (и таким образом они представляют физическое повреждение). При возникновении этих ошибок ESE автоматически исправляет их и регистрирует событие в журнале событий. 

## <a name="online-database-scanning"></a>Проверка Online баз данных 
Проверка (также известной как *расчет контрольной суммы базы данных*) Online баз данных — это процесс, где ESE использует проверки согласованности базы данных для чтения каждой страницы и проверьте наличие повреждений страницы. Основной целью — для обнаружения физическое повреждение и потере удалений, которые не начало найдет транзакционные операции. Сканирование базы данных также выполняет операции хранилище после сбоя. Утечка пространства из-за сбоев и сканирования online базы данных выполняется поиск и восстанавливает потеряны пространства. Система разработана на основе предположения, что в каждой базе данных полностью сканируются один раз в неделю. 

## <a name="lost-flush-detection"></a>Обнаружение потерянных очистки 
Потеряны сброс происходит, когда операция записи базы данных, подсистемы и операционная система диск возвращаются как выполненное не фактически удалось записать на диск или был записан неверно. Утеряны сброса происшествия можно результатов в логической повреждение базы данных, таким образом, чтобы предотвратить потеряны удалений приведет к потере данных ESE включает в себя механизм потеряны сброса обнаружения. Оговоренные страниц базы данных для пассивной копии выполняется проверка выполняется для потеряны удалений в активной копии. В случае обнаружения потерянных Сброс ESE можно восстановить процесс, ссылаясь на страницу, процесс применения исправлений. 

## <a name="single-page-restore"></a>Восстановление одной страницы 
Восстановления одной страницы или *исправление страницы*, — это происходит автоматически, где страниц повреждение базы данных, заменяются работоспособных копий из работоспособном реплики. Процесс восстановления для поврежденные страницы зависит от копии базы данных активном или пассивном состоянии. При активной копии базы данных обнаруживает поврежденные страницы, его можно скопировать страницы из одного из его реплики условии, что страницы, которые копируются в этой версии. Для этого, поместив запрос для страницы в журнал поток, который является основой для репликации базы данных почтовых ящиков. Как только реплики обнаруживает запрос страницы отвечает, отправляя копии страницы запрашивающая копии базы данных. Восстановление одной страницы также предоставляет механизм асинхронной связи для активного для запроса на страницу с репликами, даже в том случае, если реплики в автономном режиме. 

В случае повреждения в пассивная копия базы данных включая копии базы данных, так как эти копии, всегда за их активной копии, всегда безопасно для копирования любую страницу из активной копии пассивной копии. Пассивная копия базы данных является с высокой доступностью, характер, поэтому во время страницы, процесс применения исправлений, приостановлен воспроизведения журналов и копирование журнала продолжает. Пассивная копия базы данных получает копии поврежденные страницы из активной копии, ждет, пока файл журнала, который отвечает требованиям поколения максимальное журналов копируются и проверить и затем исправления поврежденных страниц. После окончания доступ странице возобновляется воспроизведения журналов. Процесс одинаков для копии базы данных, за исключением того изолированной базы данных сначала преобразует все файлы журналов, которые необходимы для достижения исправлять состояний. 

## <a name="mailbox-replication-service"></a>Служба репликации почтовых ящиков 
Перемещение почтовых ящиков является основной частью управление большими объемами электронной почты службы. Всегда существуют обновленные технологии, а затем оборудования и версии обновления для смягчения последствий, поэтому необходимости надежную, регулирование систему, позволяющую наши инженеры для выполнения этих действий, сохраняя почтового ящика прозрачной для пользователей (, убедившись, что они остаются в оперативном режиме в процессе) — ключ и проверьте, что процесс масштабируются соответствующим образом как почтовые ящики получите размером и размером. 

Служба репликации почтовых ящиков Exchange (MRS) несет ответственность за перемещение почтовых ящиков из базы данных. Во время перемещения службы репликации почтовых ЯЩИКОВ выполняет проверку согласованности всех элементов в почтовом ящике. Если ошибки согласованности службы репликации почтовых ЯЩИКОВ будет устранить проблему либо пропустить поврежденные элементы, удаляя повреждения из почтового ящика. 

Так как службы репликации почтовых ЯЩИКОВ является компонентом версией Exchange через Интернет, мы можно внести изменения в коде адрес новых форм повреждения, обнаруженные в будущем. Например, если мы обнаружить согласованности проблему, которая не сможет исправить службы репликации почтовых ЯЩИКОВ, мы можно анализа повреждения, изменить код службы репликации почтовых ЯЩИКОВ и решения несоответствия (если мы понимаем, как). 

## <a name="log-file-checks"></a>Проверка файлов журналов 
Все файлы журналов транзакций, созданных функцией базы данных Exchange подвергаются несколько форм проверки согласованности. При создании файла журнала, первое, что Готово — записываться битовый шаблон, а затем выполнить ряд операций записи в журнал. Это позволяет Exchange Online, чтобы выполнить последовательность проверок (Очистка потерянных, контрольной СУММЫ и другие проверки) для проверки в каждый файл журнала будет записан и снова репликации. 

## <a name="deployment-on-resilient-file-system"></a>Развертывание на устойчивое файловой системы 
Чтобы предотвратить повреждение реестра на уровне файловой системы, Exchange Online развертывается в разделах устойчивое файловой системы (ссылки) для обеспечения возможностей улучшения восстановления. Ссылки — файловая система Windows Server 2012 и более поздних версий, предназначенный для более высокая устойчивость от повреждения данных максимально возможной доступность данных и целостности данных. В частности, ReFS сводит улучшения, как метаданные обновляется обеспечивает лучшую защиту данных и сокращает случаев повреждения данных. Также использует контрольные суммы для проверки целостности файлов данных и метаданных, проверка того, повреждение данных легко найти и восстановить. 

Exchange Online использует несколько преимуществ ссылки: 
- Дополнительные устойчивости в целостность данных означает, что не более чем происшествия повреждение данных. Уменьшение числа происшествия повреждение означает, что не более чем reseeds ненужные базы данных. 
- Контрольная сумма, запущенные на метаданных Включение обнаружения повреждения случаев быстрее и более образом создать ситуацию, позволяющего исправить данные клиента повреждение перед серую сбоях на тома для данных.
- Предназначена для работы, так и с очень большие наборы данных — петабайтах и большего — не влияет на производительность
- Поддержка для других компонентов, используемых Exchange Online, такие как шифрование BitLocker. 

Exchange Online также использует преимущества от других функций ссылки: 
- **Целостность (целостности потоков)** - ReFS хранит данные, чтобы защищает от многие из наиболее распространенных ошибок, которые обычно может привести к потере данных. Office 365 поиска используются потоки целостности для раннего обнаружения повреждение диска и копий содержимое файла. Также снижает происшествия повреждения, вызванные «Разрыва записывает» (при операции записи не завершается из-за имеет смысл использовать, и т.д.). 
- **Доступность (восстановленную)** — ссылки приоритет отдается доступности данных. С исторической точки зрения часто были подвержена повреждение данных, который требуется системы в автономном режиме для восстановления файловой системы. Несмотря на то что редко, если повреждение ReFS implements восстановить, функциональная возможность, которая удаляет поврежденных данных из пространства имен на томе live и гарантирует, что хороший данных — это не испытывает негативного влияния не исправить поврежденных данных. Применение функции восстановления и изоляция повреждение данных в Exchange Online тома для базы данных означает, что мы можно хранить баз данных не влияет на томе поврежденные работоспособном между временем действия повреждения и восстановления. Это повышает доступность базы данных, которые обычно влияния такие вопросы, повреждение диска. 