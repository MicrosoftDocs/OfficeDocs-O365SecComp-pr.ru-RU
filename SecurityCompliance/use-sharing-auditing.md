---
title: Использование общего доступа к аудит в журнале аудита Office 365
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: 2/13/2018
ms.audience: Admin
ms.topic: article
ms.service: o365-administration
localization_priority: Normal
search.appverid:
- SPO160
- MOE150
- BCS160
- MET150
ms.assetid: 50bbf89f-7870-4c2a-ae14-42635e0cfc01
description: 'Совместное использование — это ключевые действия в SharePoint Online и OneDrive для бизнеса. Администраторы могут теперь использовать общий доступ к аудит в журнале аудита Office 365 для определения, как общий доступ к используется в своей организации. '
ms.openlocfilehash: 511f8b0e61d450659d78177d5b87fac9ee636cd4
ms.sourcegitcommit: 36c5466056cdef6ad2a8d9372f2bc009a30892bb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/27/2018
ms.locfileid: "22534957"
---
# <a name="use-sharing-auditing-in-the-office-365-audit-log"></a>Использование общего доступа к аудит в журнале аудита Office 365

Совместное использование — это ключевые действия в SharePoint Online и OneDrive для бизнеса и его широко используются в организациях Office 365. Администраторы могут теперь использовать общий доступ к аудит в журнале аудита Office 365 для определения, как общий доступ к используется в своей организации. 
  
## <a name="the-sharepoint-sharing-schema"></a>Схема общего доступа к SharePoint

Общего доступа (за исключением политики общего доступа и общего доступа к ссылки на события) событий, отличаются от события, связанные с файлов и папок в одной основной способ: один пользователь занимает действие, которое некоторые влияет на другого пользователя. Например пользователь A предоставляет доступ пользователю В в файл. В этом примере пользователь A *будет действовать пользователя* и пользователь B — *конечного пользователя*. В этой схеме файла SharePoint действие действующего пользователя влияет только на сам файл. Когда пользователь открывает файл, только информацию, необходимую для события **FileAccessed** является действующего пользователя. С учетом разницы, существует отдельный файл схемы, называется *схемы общего доступа к SharePoint*, собирает Дополнительные сведения об общем доступе к событиям. Это гарантирует, что администраторы имеют несколько понять, общих ресурсов и предоставлен пользовательского ресурса. 
  
Схема общий доступ предоставляет два дополнительных полей в журнале аудита, относящиеся к совместному использованию событий: 
  
- **TargetUserOrGroupName** - Сохранение имени участника-пользователя или имя конечного пользователя или группы, что ресурс был предоставлен (пользователь В в предыдущем примере). 
    
- **TargetUserOrGroupType** - определяет, является ли конечного пользователя или группы члена, гостя, группы или партнера. 
    
Эти два поля, в дополнение к другим свойства из Office 365 аудита схема журнала, например, пользователь, операция и Дата сообщить чтение о *какой* пользователь выделил *какие* ресурсов с помощью *которого* , а *Когда*. 
  
Есть другой свойства схемы, важных для общего доступа сценариев. Свойство **того** хранит дополнительную информацию об общем доступе к событиям. Например когда пользователь использует совместно сайта с другим пользователем, для этого, добавив конечного пользователя в группу SharePoint. Свойство **того** позволяет получить дополнительные сведения для предоставления контекста для администраторов. 

## <a name="the-sharepoint-sharing-model-and-sharing-events"></a>Общий доступ к модели и общий доступ к событий SharePoint

Общий доступ к фактически определенного три разных событий: **SharingSet**, **SharingInvitationCreated**и **SharingInvitaitonAccepted**. Ниже рабочий процесс для общего доступа как событий записываются в журнал аудита Office 365. 
  
![Блок-схема работы общего доступа к аудит](media/d83dd40f-919b-484f-bfd6-5dc8de31bff6.png)
  
Когда пользователь (действующего пользователя), где требуется реализовать общего ресурса с другим пользователем (конечного пользователя), SharePoint (или OneDrive для бизнеса) сначала проверяет, если адрес электронной почты пользователя, конечного уже связан с учетной записи пользователя в каталоге организации. Если конечный пользователь находится в каталоге организации, SharePoint делает следующее:
  
-  Сразу же назначает разрешения конечного пользователя для доступа к ресурсу. 
    
- Отправляет уведомление общего доступа на адрес электронной почты конечного пользователя.
    
- Журналы событий **SharingSet** . 
    
 Если учетная запись пользователя для конечного пользователя не находится в каталоге организации, SharePoint делает следующее: 
  
- Создает приглашения на общий доступ и отправляет его на адрес электронной почты конечного пользователя.
    
- Журналы событий **SharingInvitationCreated** . 
    
    > [!NOTE]
    > Событие **SharingInvitationCreated** наиболее всегда связан с внешним или гостя общего доступа к при конечного пользователя нет доступа к ресурс, к которому предоставлен общий доступ. 
  
Когда целевой пользователь принимает приглашение к совместному использованию, который отправил их (, щелкнув ссылку в приглашении, полученном), SharePoint журналы событий **SharingInvitationAccepted** и назначает разрешения конечного пользователя для доступа к ресурсу. Дополнительные сведения о пользователе конечного регистрируется, такие как идентификатор пользователя, которое было отправлено приглашение и пользователя, который фактически принял приглашение. В некоторых случаях может отличаться этих пользователей (или адреса электронной почты). 
  

  
## <a name="how-to-identify-resources-shared-with-external-users"></a>Как определить ресурсы совместно с внешними пользователями

Общие требования для администраторов создает список всех ресурсов, которые предоставлен пользователей за пределами организации. С помощью общего доступа к аудита в Office 365, администраторы могут приступить к созданию этого списка. Вот как.
  
### <a name="step-1-search-for-sharing-events-and-export-the-results-to-a-csv-file"></a>Шаг 1: Поиск общий доступ к событиям и экспортировать результаты в CSV-файл

Первый шаг — это поиск в журнале аудита Office 365 для общего доступа к событиям. Дополнительные сведения (включая соответствующие разрешения) о поиске в журнал аудита, [Поиск в журнале аудита безопасности Office 365 &amp; центре соответствия требованиям](search-the-audit-log-in-security-and-compliance.md).
  
1. Последовательно выберите пункты [https://protection.office.com](https://protection.office.com).
    
2. Войдите в Office 365 с помощью учетной записи рабочего или школы.
    
3. В левой области безопасности &amp; центре соответствия требованиям, нажмите кнопку **поиска &amp; расследования**и нажмите кнопку **Поиск журнала аудита**.
    
    Отображается страница **поиска журнала аудита** . 
    
4. В области **действий**щелкните **действия общий доступ** для поиска только общий доступ к событиям. 
    
    ![В разделе действия выберите действия общий доступ](media/46bb25b7-1eb2-4adf-903a-cc9ab58639f9.png)
  
5.  Выберите дату и время диапазона поиска общего доступа событий, которые произошли в течение этого периода. 
    
6. Нажмите кнопку **поиска** , чтобы выполнить поиск. 
    
7. После завершения поиска выполнение и результаты отображаются, нажмите кнопку **экспортировать результаты** \> **Загрузите все результаты**.
    
    Когда вы выберете параметр экспорта, в нижней части окна, предлагающее открыть или сохранить CSV-файла отображается сообщение.
    
8. Нажмите кнопку **Сохранить** \> **Сохранить как** и сохраните CSV-файл в папку на локальном компьютере. 
    

  
### <a name="step-2-filter-the-csv-file-for-resources-shared-with-external-users"></a>Шаг 2: Фильтр в CSV-файле ресурсы совместно с внешними пользователями

Следующим шагом является для фильтрации CSV для событий **SharingSet** и **SharingInvitationCreated** и для отображения событий, где свойство **TargetUserOrGroupType** — **гостя**. Для этого будет использовать функцию Power запроса в Excel. Следующая процедура выполняется в Excel 2016. 
  
1. Откройте пустую книгу в Excel 2016.
    
2. Перейдите на вкладку **Данные**. 
    
3. Нажмите кнопку **Создать запрос** \> **из файла** \> **Из CSV**.
    
    ![На вкладке Данные выберите создать запрос, выберите файл и затем выберите из CSV](media/5170ab34-b449-40ea-bd3f-f1432c1c5973.png)
  
4. Откройте CSV-файла, который был загружен на шаге 1.
    
    CSV-файл открыт в редакторе запросов. Обратите внимание на то, что существует четыре столбца: **время**, **пользователь**, **Действие**и **сведений**. Столбец **данных** — это поле многозначного свойства. Следующим шагом является создание нового столбца для каждого свойства в столбце **подробностями** . 
    
5. Выберите в столбце **сведений о** и затем на вкладке **Главная** щелкните **Столбец с разделением** \> **С разделителем**.
    
    ![На вкладке Главная щелкните столбец с разделением и нажмите кнопку с разделителем](media/aeb503e8-565b-42ea-91e2-9f127a74c00c.png)
  
6. В окне **Столбец с разделением разделителем** выполните следующие действия. 
    
      - В разделе **Выберите или введите разделитель**выберите **их запятыми**.
    
      - В разделе **Split**выберите **при каждом возникновении разделителя**.
    
7. Нажмите кнопку **ОК**.
    
    В столбце **сведений о** делится на несколько столбцов. Каждый новый столбец называется **Detail.1**, **Detail.2**, **Detail.3**и т. д. Можно заметить, что значения в каждой ячейки в столбцах **Detail.n** начинаются с именем свойства; например **Операция: SharingSet**, **Операции: SharingInvitationAccepted**и **Операции: SharingInvitationCreated**.
    
    ![В столбце сведений о разбивается на несколько столбцов, другая — для каждого свойства](media/4b104ead-0313-4bd4-b2a9-f143ccb378ac.png)
  
8. На вкладке **файл** нажмите кнопку **Закрыть &amp; нагрузки** чтобы закрыть редактор запросов и откройте файл в книге Excel. 
    
    Следующим шагом является для фильтрации файлов для отображения только события **SharingSet** и **SharingInvitationCreated** . 
    
9. Перейдите на вкладку **Главная** и выберите в столбце **Действие** . 
    
10. В **сортировки &amp; фильтра** раскрывающегося списка, снимите все флажки, затем выберите **SharingSet** и **SharingInvitationCreated**и нажмите **кнопку ОК**.
    
    Excel отображает строки для событий **SharingSet** и **SharingInvitationCreated** . 
    
11. Перейдите к столбцу с именем **Detail.17** (или независимо от выбранного столбца содержит свойство **TargetUserOrGroupType** ), а затем выберите ее. 
    
12. В **сортировки &amp; фильтра** раскрывающегося списка, снимите все флажки, затем выберите **TargetUserOrGroupType:Guest**и нажмите **кнопку ОК**.
    
    Теперь Excel отображает строк для события **SharingInvitationCreated** и **SharingSet** и где конечного пользователя не из вашей организации, так как внешние пользователи идентифицируются по значению **TargetUserOrGroupType:Guest**. 
    
В следующей таблице показаны все пользователи в организации, который общих ресурсов с Гость в указанный диапазон дат.
  
![Журнал аудита событий общего доступа в Office 365](media/0e0ecbe3-c794-4ca6-a2ca-63478fb3bb34.png)
  
Несмотря на то, что не входит в предыдущей таблице, в столбце **Detail.10** (или независимо от выбранного столбца содержит свойство **ObjectId** ) идентифицирует ресурс, который был открыт для конечного пользователя. например `ObjectId:https:\/\/contoso-my.sharepoint.com\/personal\/sarad_contoso_com\/Documents\/Southwater Proposal.docx`.
  
> [!TIP]
> Если вы хотите определить при гостевой фактически назначения пользователю разрешения на доступ к ресурсу (а не только к ресурсам, которые совместно с ними), повторите шаги 10, 11 и 12 и фильтрации на **SharingInvitationAccepted** и **SharingSet **события в шаге 10. 
