---
title: Изоляция клиента Office 365 в поиске Office 365
ms.author: robmazz
author: robmazz
manager: laurawi
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
description: Сводка. Описание изоляции клиентов в поиске Office 365.
ms.openlocfilehash: 5254ffe2e6b92c6ba100a9e45b35b456ead1b000
ms.sourcegitcommit: 0017dc6a5f81c165d9dfd88be39a6bb17856582e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32262601"
---
# <a name="tenant-isolation-in-office-365-search"></a><span data-ttu-id="c1ac3-103">Изоляция клиента в поиске Office 365</span><span class="sxs-lookup"><span data-stu-id="c1ac3-103">Tenant Isolation in Office 365 Search</span></span>
<span data-ttu-id="c1ac3-104">Служба поиска SharePoint Online использует модель разделения клиентов, которая балансирует эффективность общих структур данных с защитой от утечки данных между клиентами.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-104">SharePoint Online search uses a tenant separation model that balances the efficiency of shared data structures with protection against information leaking between tenants.</span></span> <span data-ttu-id="c1ac3-105">С помощью этой модели мы не будем предотвращать функции поиска:</span><span class="sxs-lookup"><span data-stu-id="c1ac3-105">With this model, we prevent the Search features from:</span></span>
- <span data-ttu-id="c1ac3-106">Получение результатов запроса, содержащих документы от других клиентов</span><span class="sxs-lookup"><span data-stu-id="c1ac3-106">Returning query results that contain documents from other tenants</span></span>
- <span data-ttu-id="c1ac3-107">Предоставление достаточной информации в результатах запроса, которые квалифицированный пользователь может получить сведения о других клиентах</span><span class="sxs-lookup"><span data-stu-id="c1ac3-107">Exposing sufficient information in query results that a skilled user could infer information about other tenants</span></span>
- <span data-ttu-id="c1ac3-108">Показ схемы или параметров из другого клиента</span><span class="sxs-lookup"><span data-stu-id="c1ac3-108">Showing schema or settings from another tenant</span></span>
- <span data-ttu-id="c1ac3-109">Смешивание сведений об обработке аналитики между клиентами или сохранение результатов в неправильном клиенте</span><span class="sxs-lookup"><span data-stu-id="c1ac3-109">Mixing analytics processing information between tenants or store results in the wrong tenant</span></span>
- <span data-ttu-id="c1ac3-110">Использование записей словаря из другого клиента</span><span class="sxs-lookup"><span data-stu-id="c1ac3-110">Using dictionary entries from another tenant</span></span>

<span data-ttu-id="c1ac3-111">Для каждого типа данных клиента мы используем один или несколько уровней защиты в коде для предотвращения случайной утечки информации.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-111">For each type of tenant data, we use one or more layers of protection in the code to prevent accidental leaking of information.</span></span> <span data-ttu-id="c1ac3-112">Наиболее важные данные имеют большинство уровней защиты, чтобы убедиться в том, что одна ошибка не приводит к утечке фактических или воспринимаемых данных.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-112">The most critical data has the most layers of protection to make sure that a single defect doesn't result in actual or perceived information leakage.</span></span>

## <a name="tenant-separation-for-the-search-index"></a><span data-ttu-id="c1ac3-113">Разделение клиентов для индекса поиска</span><span class="sxs-lookup"><span data-stu-id="c1ac3-113">Tenant Separation for the Search Index</span></span>
<span data-ttu-id="c1ac3-114">Индекс поиска хранится на диске серверов, на которых размещаются компоненты индекса, а клиенты совместно используют файлы индекса.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-114">The search index is stored on disk in the servers hosting the index components and the tenants share the index files.</span></span> <span data-ttu-id="c1ac3-115">Индексированные документы клиента отображаются только для запросов для этого клиента.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-115">A tenant's indexed documents are visible only for queries for that tenant.</span></span> <span data-ttu-id="c1ac3-116">Три независимых механизма предотвращают утечку информации:</span><span class="sxs-lookup"><span data-stu-id="c1ac3-116">Three independent mechanisms prevent information leakage:</span></span>
- <span data-ttu-id="c1ac3-117">Фильтрация ИДЕНТИФИКАТОРов клиентов</span><span class="sxs-lookup"><span data-stu-id="c1ac3-117">Tenant ID filtering</span></span>
- <span data-ttu-id="c1ac3-118">Префикс термина идентификатора клиента</span><span class="sxs-lookup"><span data-stu-id="c1ac3-118">Tenant ID term prefixing</span></span>
- <span data-ttu-id="c1ac3-119">Проверки ACL</span><span class="sxs-lookup"><span data-stu-id="c1ac3-119">ACL checks</span></span>

<span data-ttu-id="c1ac3-120">Всем трем механизмам потребуется выполнить поиск, чтобы возвратить документы в неверном клиенте.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-120">All three mechanisms would have to fail for Search to return documents to the wrong tenant.</span></span>

## <a name="tenant-id-filtering-and-tenant-id-term-prefixing"></a><span data-ttu-id="c1ac3-121">Фильтрация ИД клиента и префикс идентификатора клиента</span><span class="sxs-lookup"><span data-stu-id="c1ac3-121">Tenant ID Filtering and Tenant ID Term Prefixing</span></span>
<span data-ttu-id="c1ac3-122">Поиск префиксов для каждого термина, индексируемого в полнотекстовом индексе, с ИДЕНТИФИКАТОРом клиента.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-122">Search prefixes every term that is indexed in the full-text index with the tenant ID.</span></span> <span data-ttu-id="c1ac3-123">Например, если термин "*foo*" индексируется для клиента с идентификатором "*123*", запись в полнотекстовом индексе будет иметь значение "*123foo".*</span><span class="sxs-lookup"><span data-stu-id="c1ac3-123">For example, when the term "*foo*" is indexed for a tenant with an ID of "*123*", the entry in the full-text index is "*123foo.*"</span></span>

<span data-ttu-id="c1ac3-124">Каждый запрос преобразуется, чтобы включить идентификатор клиента, используя процесс, называемый фильтрацией кода клиента.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-124">Every query is converted to include the tenant ID using a process called tenant ID filtering.</span></span> <span data-ttu-id="c1ac3-125">Например, запрос "*foo*" преобразуется в "_лт_*GUID*_гт_. *foo* И *tenantID*: _лт_*GUID*_Гт_ ", где _лт_*GUID*_гт_ представляет клиент, выполняющий запрос.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-125">For example, the query "*foo*" is converted to "<*guid*>.*foo* AND *tenantID*:<*guid*>", where <*guid*> represents the tenant performing the query.</span></span> <span data-ttu-id="c1ac3-126">Это преобразование запроса выполняется в каждом узле индекса, и на него не могут влиять ни запросы, ни обработка контента.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-126">This query conversion occurs within each index node and neither query nor content processing can influence it.</span></span> <span data-ttu-id="c1ac3-127">Так как идентификатор клиента добавляется в каждый запрос, то частота терминов в других клиентах не может быть определена при поиске ранжирования по наилучшему совпадению в одном клиенте.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-127">Because the tenant ID is added to every query, the frequency of a term in other tenants can't be inferred by looking at best match ranking in one tenant.</span></span>

<span data-ttu-id="c1ac3-128">Предварительное исправление терминов идентификатора клиента выполняется только в полнотекстовом индексе.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-128">Tenant ID term prefixing occurs only in the full-text index.</span></span> <span data-ttu-id="c1ac3-129">Поиск с полями, например "*Title: foo*", перейдите по искусственному индексу поиска, где термины не предВАРЯются идентификатором клиента.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-129">Fielded searches, such as "*title:foo*", go to a synthetic search index where terms aren't prefixed by tenant ID.</span></span> <span data-ttu-id="c1ac3-130">Вместо этого для поиска с полями указывается имя поля.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-130">Instead, fielded searches are prefixed with the field name.</span></span> <span data-ttu-id="c1ac3-131">Например, запрос "*Title: foo*" преобразуется в "Fields *. Title: foo и Fields. tenantID*: _лт_*GUID*_гт_".</span><span class="sxs-lookup"><span data-stu-id="c1ac3-131">For example, the query "*title:foo*" is converted to "*fields.title:foo AND fields.tenantID*:<*guid*>."</span></span> <span data-ttu-id="c1ac3-132">Так как частота терминов не влияет на ранжирование совпадений в индексе искусственного поиска, разделение клиентов по терминам не требуется.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-132">Because the frequency of a term doesn't influence ranking of hits in the synthetic search index, there's no need for tenant separation by term prefixing.</span></span> <span data-ttu-id="c1ac3-133">Для поиска по полям, например "*Title: foo*", разделение контента клиента зависит от фильтрации идентификатора клиента по преобразованию запроса.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-133">For a fielded search like "*title:foo*", tenant content separation depends on tenant ID filtering by query conversion.</span></span>

## <a name="document-access-control-list-checks"></a><span data-ttu-id="c1ac3-134">Проверки списка управления доступом к документам</span><span class="sxs-lookup"><span data-stu-id="c1ac3-134">Document Access Control List Checks</span></span>
<span data-ttu-id="c1ac3-135">Поиск управляет доступом к документам с помощью списков управления доступом, сохраненных в индексе поиска.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-135">Search controls access to documents through ACLs that are saved in the search index.</span></span> <span data-ttu-id="c1ac3-136">Каждый элемент индексируется с помощью набора терминов в специальном поле списка управления доступом (ACL).</span><span class="sxs-lookup"><span data-stu-id="c1ac3-136">Every item is indexed with a set of terms in a special ACL field.</span></span> <span data-ttu-id="c1ac3-137">Поле списка управления доступом содержит один термин для группы или пользователя, который может просматривать документ.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-137">The ACL field contains one term per group or user that can view the document.</span></span> <span data-ttu-id="c1ac3-138">Каждый запрос дополняется списком терминов элемента управления доступом (ACE), по одному для каждой группы, к которой принадлежит пользователь, прошедшему проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-138">Every query is augmented with a list of access control entry (ACE) terms, one for each group to which the authenticated user belongs.</span></span>

<span data-ttu-id="c1ac3-139">Например, запрос Like "_Лт_*GUID*_гт_. *foo и tenantID*: _лт_*GUID*_гт_ "выглядит следующим образом:" _лт_*GUID*_гт_. *foo и tenantID*: _лт_*GUID*> *и* (*докакл:*<*ace1*> *или докакл*: _лт_*ace2*> *или докакл*: _лт_*ace3*> \*... \*)"</span><span class="sxs-lookup"><span data-stu-id="c1ac3-139">For example, a query like "<*guid*>.*foo AND tenantID*:<*guid*>" becomes: "<*guid*>.*foo AND tenantID*:<*guid*> *AND* (*docACL:*<*ace1*> *OR docACL*:<*ace2*> *OR docACL*:<*ace3*> *...*)"</span></span>

<span data-ttu-id="c1ac3-140">Так как идентификаторы пользователей и групп, а также, следовательно, являются уникальными, это обеспечивает дополнительный уровень безопасности между клиентами для документов, которые видны только некоторым пользователям.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-140">Because user and group identifiers and hence ACEs are unique, this provides an extra level of security between tenants for documents that are only visible to some users.</span></span> <span data-ttu-id="c1ac3-141">То же самое относится к особым учетным ЗАПИСЯМ "все, кроме внешних пользователей", которые предоставляют доступ к обычным пользователям в клиенте.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-141">The same is the case for the special "Everyone except external users" ACE that grants access to regular users in the tenant.</span></span> <span data-ttu-id="c1ac3-142">Но поскольку ACE для "все" одинаковы для всех клиентов, разделение клиентов для общедоступных документов зависит от фильтрации идентификатора клиента.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-142">But since ACEs for "Everyone" are the same for all tenants, tenant separation for public documents depends on tenant ID filtering.</span></span> <span data-ttu-id="c1ac3-143">Кроме того, поддерживаются запрещенные элементы управления доступом.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-143">Deny ACEs are also supported.</span></span> <span data-ttu-id="c1ac3-144">При приращении запроса добавляется предложение, которое удаляет документ из результата, если найдено соответствующее значение ACE Deny.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-144">The query augmentation adds a clause that removes a document from the result when there is a match with a deny ACE.</span></span>

<span data-ttu-id="c1ac3-145">При поиске в Exchange Online индекс секционируется на идентификатор почтового ящика для отдельных почтовых ящиков пользователя, а не на идентификатор клиента (идентификатор подписки), как в SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-145">In Exchange Online search, the index is partitioned on mailbox ID for individual user's mailboxes instead of tenant ID (subscription ID) as in SharePoint Online.</span></span> <span data-ttu-id="c1ac3-146">Механизм секционирования аналогичен SharePoint Online, но фильтрация ACL отсутствует.</span><span class="sxs-lookup"><span data-stu-id="c1ac3-146">The partitioning mechanism is the same as SharePoint Online, but there is no ACL filtering.</span></span>
