---
title: Изоляция клиента Office 365 в поиске Office 365
ms.author: robmazz
author: robmazz
manager: laurawi
ms.date: 8/21/2018
audience: ITPro
ms.topic: article
ms.service: Office 365 Administration
localization_priority: None
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
description: Сводка. Описание изоляции клиентов в поиске Office 365.
ms.openlocfilehash: b9faae9f1d61af181807f60243890b5115c0d679
ms.sourcegitcommit: c94cb88a9ce5bcc2d3c558f0fcc648519cc264a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/20/2019
ms.locfileid: "30090811"
---
# <a name="tenant-isolation-in-office-365-search"></a><span data-ttu-id="93762-103">Изоляция клиента в поиске Office 365</span><span class="sxs-lookup"><span data-stu-id="93762-103">Tenant Isolation in Office 365 Search</span></span>
<span data-ttu-id="93762-p101">Служба поиска SharePoint Online использует модель разделения клиентов, которая балансирует эффективность общих структур данных с защитой от утечки данных между клиентами. С помощью этой модели мы не будем предотвращать функции поиска:</span><span class="sxs-lookup"><span data-stu-id="93762-p101">SharePoint Online search uses a tenant separation model that balances the efficiency of shared data structures with protection against information leaking between tenants. With this model, we prevent the Search features from:</span></span>
- <span data-ttu-id="93762-106">Получение результатов запроса, содержащих документы от других клиентов</span><span class="sxs-lookup"><span data-stu-id="93762-106">Returning query results that contain documents from other tenants</span></span>
- <span data-ttu-id="93762-107">Предоставление достаточной информации в результатах запроса, которые квалифицированный пользователь может получить сведения о других клиентах</span><span class="sxs-lookup"><span data-stu-id="93762-107">Exposing sufficient information in query results that a skilled user could infer information about other tenants</span></span>
- <span data-ttu-id="93762-108">Показ схемы или параметров из другого клиента</span><span class="sxs-lookup"><span data-stu-id="93762-108">Showing schema or settings from another tenant</span></span>
- <span data-ttu-id="93762-109">Смешивание сведений об обработке аналитики между клиентами или сохранение результатов в неправильном клиенте</span><span class="sxs-lookup"><span data-stu-id="93762-109">Mixing analytics processing information between tenants or store results in the wrong tenant</span></span>
- <span data-ttu-id="93762-110">Использование записей словаря из другого клиента</span><span class="sxs-lookup"><span data-stu-id="93762-110">Using dictionary entries from another tenant</span></span>

<span data-ttu-id="93762-p102">Для каждого типа данных клиента мы используем один или несколько уровней защиты в коде для предотвращения случайной утечки информации. Наиболее важные данные имеют большинство уровней защиты, чтобы убедиться в том, что одна ошибка не приводит к утечке фактических или воспринимаемых данных.</span><span class="sxs-lookup"><span data-stu-id="93762-p102">For each type of tenant data, we use one or more layers of protection in the code to prevent accidental leaking of information. The most critical data has the most layers of protection to make sure that a single defect doesn't result in actual or perceived information leakage.</span></span>

## <a name="tenant-separation-for-the-search-index"></a><span data-ttu-id="93762-113">Разделение клиентов для индекса поиска</span><span class="sxs-lookup"><span data-stu-id="93762-113">Tenant Separation for the Search Index</span></span>
<span data-ttu-id="93762-p103">Индекс поиска хранится на диске серверов, на которых размещаются компоненты индекса, а клиенты совместно используют файлы индекса. Индексированные документы клиента отображаются только для запросов для этого клиента. Три независимых механизма предотвращают утечку информации:</span><span class="sxs-lookup"><span data-stu-id="93762-p103">The search index is stored on disk in the servers hosting the index components and the tenants share the index files. A tenant's indexed documents are visible only for queries for that tenant. Three independent mechanisms prevent information leakage:</span></span>
- <span data-ttu-id="93762-117">Фильтрация ИДЕНТИФИКАТОРов клиентов</span><span class="sxs-lookup"><span data-stu-id="93762-117">Tenant ID filtering</span></span>
- <span data-ttu-id="93762-118">Префикс термина идентификатора клиента</span><span class="sxs-lookup"><span data-stu-id="93762-118">Tenant ID term prefixing</span></span>
- <span data-ttu-id="93762-119">Проверки ACL</span><span class="sxs-lookup"><span data-stu-id="93762-119">ACL checks</span></span>

<span data-ttu-id="93762-120">Всем трем механизмам потребуется выполнить поиск, чтобы возвратить документы в неверном клиенте.</span><span class="sxs-lookup"><span data-stu-id="93762-120">All three mechanisms would have to fail for Search to return documents to the wrong tenant.</span></span>

## <a name="tenant-id-filtering-and-tenant-id-term-prefixing"></a><span data-ttu-id="93762-121">Фильтрация ИД клиента и префикс идентификатора клиента</span><span class="sxs-lookup"><span data-stu-id="93762-121">Tenant ID Filtering and Tenant ID Term Prefixing</span></span>
<span data-ttu-id="93762-p104">Поиск префиксов для каждого термина, индексируемого в полнотекстовом индексе, с ИДЕНТИФИКАТОРом клиента. Например, если термин "*foo*" индексируется для клиента с идентификатором "*123*", запись в полнотекстовом индексе будет иметь значение "*123foo".*</span><span class="sxs-lookup"><span data-stu-id="93762-p104">Search prefixes every term that is indexed in the full-text index with the tenant ID. For example, when the term "*foo*" is indexed for a tenant with an ID of "*123*", the entry in the full-text index is "*123foo.*"</span></span>

<span data-ttu-id="93762-p105">Каждый запрос преобразуется, чтобы включить идентификатор клиента, используя процесс, называемый фильтрацией кода клиента. Например, запрос "*foo*" преобразуется в "_лт_*GUID*_гт_. *foo* И *tenantID*: _лт_*GUID*_Гт_ ", где _лт_*GUID*_гт_ представляет клиент, выполняющий запрос. Это преобразование запроса выполняется в каждом узле индекса, и на него не могут влиять ни запросы, ни обработка контента. Так как идентификатор клиента добавляется в каждый запрос, то частота терминов в других клиентах не может быть определена при поиске ранжирования по наилучшему совпадению в одном клиенте.</span><span class="sxs-lookup"><span data-stu-id="93762-p105">Every query is converted to include the tenant ID using a process called tenant ID filtering. For example, the query "*foo*" is converted to "<*guid*>.*foo* AND *tenantID*:<*guid*>", where <*guid*> represents the tenant performing the query. This query conversion occurs within each index node and neither query nor content processing can influence it. Because the tenant ID is added to every query, the frequency of a term in other tenants can't be inferred by looking at best match ranking in one tenant.</span></span>

<span data-ttu-id="93762-p106">Предварительное исправление терминов идентификатора клиента выполняется только в полнотекстовом индексе. Поиск с полями, например "*Title: foo*", перейдите по искусственному индексу поиска, где термины не предВАРЯются идентификатором клиента. Вместо этого для поиска с полями указывается имя поля. Например, запрос "*Title: foo*" преобразуется в "Fields *. Title: foo и Fields. tenantID*: _лт_*GUID*_гт_". Так как частота терминов не влияет на ранжирование совпадений в индексе искусственного поиска, разделение клиентов по терминам не требуется. Для поиска по полям, например "*Title: foo*", разделение контента клиента зависит от фильтрации идентификатора клиента по преобразованию запроса.</span><span class="sxs-lookup"><span data-stu-id="93762-p106">Tenant ID term prefixing occurs only in the full-text index. Fielded searches, such as "*title:foo*", go to a synthetic search index where terms aren't prefixed by tenant ID. Instead, fielded searches are prefixed with the field name. For example, the query "*title:foo*" is converted to "*fields.title:foo AND fields.tenantID*:<*guid*>." Because the frequency of a term doesn't influence ranking of hits in the synthetic search index, there's no need for tenant separation by term prefixing. For a fielded search like "*title:foo*", tenant content separation depends on tenant ID filtering by query conversion.</span></span>

## <a name="document-access-control-list-checks"></a><span data-ttu-id="93762-134">Проверки списка управления доступом к документам</span><span class="sxs-lookup"><span data-stu-id="93762-134">Document Access Control List Checks</span></span>
<span data-ttu-id="93762-p107">Поиск управляет доступом к документам с помощью списков управления доступом, сохраненных в индексе поиска. Каждый элемент индексируется с помощью набора терминов в специальном поле списка управления доступом (ACL). Поле списка управления доступом содержит один термин для группы или пользователя, который может просматривать документ. Каждый запрос дополняется списком терминов элемента управления доступом (ACE), по одному для каждой группы, к которой принадлежит пользователь, прошедшему проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="93762-p107">Search controls access to documents through ACLs that are saved in the search index. Every item is indexed with a set of terms in a special ACL field. The ACL field contains one term per group or user that can view the document. Every query is augmented with a list of access control entry (ACE) terms, one for each group to which the authenticated user belongs.</span></span>

<span data-ttu-id="93762-139">Например, запрос Like "_Лт_*GUID*_гт_. *foo и tenantID*: _лт_*GUID*_гт_ "выглядит следующим образом:" _лт_*GUID*_гт_. *foo и tenantID*: _лт_*GUID*> *и* (*докакл:*<*ace1*> *или докакл*: _лт_*ace2*> *или докакл*: _лт_*ace3*> \*... \*)"</span><span class="sxs-lookup"><span data-stu-id="93762-139">For example, a query like "<*guid*>.*foo AND tenantID*:<*guid*>" becomes: "<*guid*>.*foo AND tenantID*:<*guid*> *AND* (*docACL:*<*ace1*> *OR docACL*:<*ace2*> *OR docACL*:<*ace3*> *...*)"</span></span>

<span data-ttu-id="93762-p108">Так как идентификаторы пользователей и групп, а также, следовательно, являются уникальными, это обеспечивает дополнительный уровень безопасности между клиентами для документов, которые видны только некоторым пользователям. То же самое относится к особым учетным ЗАПИСЯМ "все, кроме внешних пользователей", которые предоставляют доступ к обычным пользователям в клиенте. Но поскольку ACE для "все" одинаковы для всех клиентов, разделение клиентов для общедоступных документов зависит от фильтрации идентификатора клиента. Кроме того, поддерживаются запрещенные элементы управления доступом. При приращении запроса добавляется предложение, которое удаляет документ из результата, если найдено соответствующее значение ACE Deny.</span><span class="sxs-lookup"><span data-stu-id="93762-p108">Because user and group identifiers and hence ACEs are unique, this provides an extra level of security between tenants for documents that are only visible to some users. The same is the case for the special "Everyone except external users" ACE that grants access to regular users in the tenant. But since ACEs for "Everyone" are the same for all tenants, tenant separation for public documents depends on tenant ID filtering. Deny ACEs are also supported. The query augmentation adds a clause that removes a document from the result when there is a match with a deny ACE.</span></span>

<span data-ttu-id="93762-p109">При поиске в Exchange Online индекс секционируется на идентификатор почтового ящика для отдельных почтовых ящиков пользователя, а не на идентификатор клиента (идентификатор подписки), как в SharePoint Online. Механизм секционирования аналогичен SharePoint Online, но фильтрация ACL отсутствует.</span><span class="sxs-lookup"><span data-stu-id="93762-p109">In Exchange Online search, the index is partitioned on mailbox ID for individual user's mailboxes instead of tenant ID (subscription ID) as in SharePoint Online. The partitioning mechanism is the same as SharePoint Online, but there is no ACL filtering.</span></span>
