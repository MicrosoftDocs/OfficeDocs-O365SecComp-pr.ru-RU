---
title: Поиск, копирование и удаление PST-файлов в Организации с помощью средства сбора PST-файлов
ms.author: markjjo
author: markjjo
manager: laurawi
ms.audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
ms.collection: ''
search.appverid: MOE150
ms.assetid: 7a150c84-049c-4a9c-8c91-22355b35f2a7
description: С помощью средства Microsoft PST Collection выполните поиск по сети организации, чтобы получить список PST-файлов, которые размещаются в пределах организации. После того как вы найдете PST-файлы, вы можете использовать средство сбора PST-файлов, чтобы скопировать их в центральном расположении, чтобы их можно было импортировать в Office 365.
ms.openlocfilehash: 87e13ec8a4c58f848ac2ff7a430a7532942ece74
ms.sourcegitcommit: 0017dc6a5f81c165d9dfd88be39a6bb17856582e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32255355"
---
# <a name="use-the-pst-collection-tool-to-find-copy-and-delete-pst-files-in-your-organization"></a>Поиск, копирование и удаление PST-файлов в Организации с помощью средства сбора PST-файлов

> [!IMPORTANT]
> Средство сбора PST-файлов, описанное в этой статье, не поддерживается в стандартной программе или службе поддержки Майкрософт. Средство предоставляется без каких-либо гарантий. Кроме того, корпорация Майкрософт отказывается от всех косвенных гарантий товарного качества. Весь риск, возникающий при использовании или производительности средства и документации, остается без вас. В противном случае корпорация Майкрософт, ее авторы или другие пользователи, участвующие в создании, производстве или доставке средства, не несут никакого ущерба (в том числе без ограничений, ущерба для потери прибыли бизнеса, перерыва в работе, потери Бизнес-информация или другие потери пекуниари), которые применяют или не могут использовать средство или документацию, даже если корпорация Майкрософт приходила к возможности такого ущерба.

С помощью средства Microsoft PST Collection можно искать PST-файлы в сети Организации. С помощью этого средства вы сможете получить список PST-файлов, которые будут разбросаны в пределах организации. После обнаружения PST-файлов вы можете скопировать их в одном месте с помощью средства сбора PST-файлов. Если PST-файлы в одном месте, вы можете импортировать их в почтовые ящики Exchange Online (или в один почтовый ящик Exchange Online), где вы можете применить обширный набор функций соответствия в Office 365. Это включает импорт PST-файлов в архивные почтовые ящики пользователей, поиск определенных сообщений в PST-файлах, импортированных с помощью средств поиска eDiscovery, сохранение сообщений с помощью удержаний eDiscovery и политик хранения Office 365, а также управление жизненным циклом цикл этих сообщений с помощью функций управления записями сообщений в Exchange Online. После того как вы уверены, что собранные вами PST-файлы были успешно импортированы в Office 365, можно воспользоваться этим средством, чтобы удалить их из исходного расположения в сети. 
  
Кроме того, вы можете сделать это с помощью средства сбора PST-файлов, чтобы пользователи не могли создавать новые PST-файлы и изменять существующие PST-файлы, найденные в вашей сети. Эти возможности позволяют найти, собрать и импортировать известный набор PST-файлов в Office 365 и предотвратить возможность дальнейшего распространения PST-файлов в Организации. 
  
## <a name="how-the-pst-collection-tool-works"></a>Принцип работы средства сбора PST-файлов

Ниже приведен краткий обзор процесса использования средства сбора PST-файлов для поиска, управления, сбора и удаления PST-файлов в Организации.
  
![Обзор процесса средства сбора PST-файлов](media/67a29f27-f83c-4f0a-9df4-7ed92d3086fe.png)
  
1. **[Шаг 1: Поиск PST-файлов в сети](#step-1-find-pst-files-on-your-network)** — при запуске средства для поиска PST-файлов указывается расположение, например подразделение, которое содержит объекты Active Directory для клиентских и серверных компьютеров. Вы также можете выполнять поиск на определенных компьютерах или сетевых общих файловых ресурсах. При запуске средства на конечных компьютерах устанавливается агент для работы со облегченной коллекцией. Этот агент выполняет поиск PST-файлов на целевом компьютере, а затем отправляет данные обратно в средство коллекции PST-файлов по любому найденному PST-файлу. Средство создает файлы журналов, содержащие сведения о PST-файлах, обнаруженных в указанных расположениях. Эти файлы используются при запуске средства на последующих этапах. 
    
2. **[(Необязательно) шаг 2: Управление доступом к PST-файлам](#optional-step-2-control-access-to-pst-files)** — средство создает объект групповой политики (GPO) с параметрами, которые запрещают пользователям создавать или изменять PST-файлы. Этот объект групповой политики применяется ко всем пользователям в вашем домене. Это необязательный шаг позволяет "заблокировать" PST-файлы, найденные на этапе 1, чтобы вы могли собирать, импортировать и удалять их, не создавая новые PST-файлы или не изменили существующие PST-файлы. 
    
3. **[Шаг 3: копирование PST-файлов в расположение коллекции](#step-3-copy-the-pst-files-to-a-collection-location)** — это позволяет собирать PST-файлы в одном расположении, чтобы их можно было импортировать в почтовые ящики Exchange Online с помощью службы импорта Office 365 на шаге 4. При запуске средства в режиме "сбор" каждый агент сбора данных копирует PST-файлы с целевого компьютера, на котором установлен агент, в расположение коллекции. 
    
4. **[Шаг 4: Импорт PST-файлов в Office 365](#step-4-import-the-pst-files-to-office-365)** -после того, как вы скопировали PST-файлы в одну папку, вы готовы импортировать их в почтовые ящики Exchange Online. 
    
5. **[Шаг 5: Удаление PST-файлов, найденных в сети](#step-5-delete-the-pst-files-found-on-your-network)** — после импорта PST-файлов, которые вы нашли и собрали, в почтовые ящики Exchange Online в Office 365 можно использовать средство коллекция PST-файлов для удаления PST-файлов из исходных расположений, где они были найдены на этапе 1. 

## <a name="before-you-begin"></a>До начала работы

- Выполните следующие действия, чтобы скачать средство сбора PST-данных на локальный компьютер. 
    
    1. [Скачайте средство сбора PST-файлов](https://aka.ms/pstcollectiontool).
    
    2. Во всплывающем окне нажмите **сохранить** \> **Сохранить как** , чтобы сохранить файл пстколлектионтул. zip в папку на локальном компьютере. 
    
    3. ИзВлеките файл Пстколлектионтул. zip в папку на локальном компьютере; имя папки по умолчанию — Пстколлектионтул.
    
- Для запуска средства коллекция PST в любом режиме (Поиск, блокировка, копирование или удаление) необходимо быть членом группы "Администраторы домена" в домене Active Directory. 

## <a name="step-1-find-pst-files-on-your-network"></a>Шаг 1: Поиск PST-файлов в сети

Первым шагом является запуск средства сбора PST-файлов для поиска PST-файлов в Организации. Средство можно использовать для поиска следующих типов расположений. 
  
- Подразделения (OU) в локальном домене Active Directory. Средство выполняет поиск на всех компьютерах, которые находятся в указанном подРАЗДЕЛЕНии. 
    
- Клиентские и серверные компьютеры. Средство выполняет поиск на указанных компьютерах. 
    
- Сетевые общие файловые ресурсы. Средство выполняет поиск в указанных сетевых общих папках. 
    
Ниже приведены примеры синтаксиса `Locations` , используемого для каждого из этих типов местоположения, в описании параметра в таблице. 
  
> [!IMPORTANT]
> Для выполнения других действий, таких как блокировка, сбор или удаление PST-файлов, необходимо запустить средство работы со коллекциями PST в режиме поиска. 
  
1. Откройте командную строку (Запуск от имени администратора) на локальном компьютере.
    
2. Откройте папку Пстколлектионтул (или папку, в которую был извлечен ZIP-файл Пстколлектионтул).
    
3. Перейдите к каталогу Датаколлектормастер.
    
4. Выполните следующую команду, чтобы найти PST-файлы в указанном расположении.
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Find -JobName <Name> -Locations <Locations to search for PSTs> -LogLocation <Location to store log files> -ConfigurationLocation <Location to store configuration files>
    ```

    В следующей таблице описываются параметры и их обязательные значения при выполнении команды Датаколлектормастер. exe для поиска PST-файлов. 
    
    |Параметр * * * *|****Описание****|Примеры * * * *|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |Указывает тип данных, которые требуется найти. В настоящее время вы можете использовать средство сбора PST-файлов для поиска PST-файлов.  <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |Указывает тип операции, которую будет выполнять средство. Используйте значение `Find` для обнаружения PST-файлов в указанных расположениях. Обратите внимание, что средство может находить и получать сведения о PST-файлах, которые открыты в Outlook и PST-файлах, подключенных к профилям Outlook.  <br/> | `-Mode Find` <br/> |
    | `JobName` <br/> |Задает имя задания коллекции PST-файлов. Это имя задания будет использоваться при запуске средства сбора PST-файлов для блокирования, сбора и удаления PST-файлов, найденных при запуске средства для поиска PST-файлов. Имя задания также будет добавлено в имена файлов журнала и конфигурации.  <br/> | `-JobName PstSearch1` <br/> |
    | `Locations` <br/> | Указывает одно или несколько расположений для поиска PST-файлов. При указании нескольких расположений используйте точку с запятой (;) для разделения отдельных расположений. Не забудьте заключить отдельные значения этого параметра с помощью двойных кавычек ("").  <br/><br/>   Ниже приведен необходимый формат значения идентификатора для типов расположений, которые можно искать.  <br/><br/>        **OU** — Используйте различающееся имя (DN) для определения подразделений; Например:`"OU=NorthAmerica,OU=NWRegion,OU=ITServices,DC=contoso,DC=com"` <br/> > [!IMPORTANT]_Гт_ нельзя указать встроенный контейнер Computers (например, CN = Computers, DC = contoso, DC = com), так как он не является подразделением.<br/> <br/> **Machines** — используйте DN или полное доменное имя (FQDN) для идентификации компьютеров клиентов и серверов в сети; Например:  <br/>  ИМЯ`"CN=FILESERVER01,CN=Computers,DC=contoso,DC=com"` <br/>  ИЛИ  <br/>  ПОЛНЫМ`"FILESERVER01.contoso.com"` <br/><br/>  **Сетевые общие папки** — используйте UNC-имя для определения общих сетевых файлов; Например`"\\FILESERVER02\Users"` <br/> | `-Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com";"CN=FILESERVER02,CN=Computers,DC=contoso,DC=com"` <br/> |
    | `LogLocation` <br/> |Указывает папку, в которую будут скопированы файлы журналов. Если папка не существует, она будет создана при запуске средства.  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `ConfigurationLocation` <br/> |Указывает папку, в которую будет скопирован XML-файл конфигурации. Этот файл содержит сведения о каждом PST-файле, который обнаруживается при запуске средства. Этот файл будет использоваться при запуске средства, описанного в шаге 3, для копирования найденных PST-файлов.  <br/> | `-ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration"` <br/> |
    | `ExcludedLocations` <br/> |Этот необязательный параметр указывает расположения, которые необходимо пропустить во время операции поиска. Вы можете исключить конкретные подразделения, машины и сетевые общие файловые ресурсы. Например, вы можете исключить компьютеры, такие как компьютер, настроенный как SQL Server (или другие серверы приложений), к которым у пользователей нет доступа. Если вы указали несколько расположений для исключения, используйте точку с запятой (;) для разделения отдельных расположений. Не забудьте заключить отдельные значения этого параметра с помощью двойных кавычек ("").  <br/> | `-ExcludedLocations "SQLSERVER01.contoso.com"` <br/> |
    | `ForceRestart` <br/> |Этот необязательный параметр позволяет запустить средство в режиме поиска для существующего задания сбора PST-файлов. При использовании `ForceRestart` переключателя результаты из предыдущей операции поиска для задания отбрасываются, а средство повторно сканирует указанные расположения и создает новые файлы журнала и конфигурации.  <br/> | `-ForceRestart` <br/> |
   
    Ниже приведен пример синтаксиса для команды Датаколлектормастер. exe, использующей фактические значения для каждого параметра:
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Find -JobName PstSearch1 -Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com";"CN=FILESERVER02,CN=Computers,DC=contoso,DC=com" -LogLocation "c:\users\admin\desktop\PSTCollection" -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration"
    ```

    После выполнения команды отображаются подробные сообщения о состоянии, в которых отображаются сведения о ходе поиска PST-файлов в указанных расположениях. Через некоторое время в итоговое сообщение о состоянии отображается общее количество найденных PST-файлов, завершенных по завершении работы, и если возникли ошибки. Такие же сообщения о состоянии копируются в файл журнала.
    
### <a name="results-of-running-datacollectormasterexe-in-the-find-mode"></a>Результаты выполнения Датаколлектормастер. exe в режиме поиска

После успешного запуска средства "коллекция PST" в режиме поиска создаются следующие файлы и хранятся в папках, `LogLocation` заданных параметрами и. `ConfigurationLocation` 
  
- **\>__ Жобнаме Find\<датетиместамп\>. log — файл журнала содержит отображаемые \<** сообщения о состоянии. Этот файл создается в папке, указанной `LogLocation` параметром. 
    
- **\>__ Жобнаме Find\<датетиместамп\>. CSV — CSV-файл содержит строку для каждого найденного \<** PST-файла. Сведения для каждого PST-файла включают компьютер, на котором был найден PST-файл, полный путь к файлу PST, владельца PST-файла и размер (в килобайтах, КБ) PST-файла. Этот файл создается в папке, указанной `LogLocation` параметром. 
    
    > [!TIP]
    > Используйте средство автоСуммирования в Excel, чтобы рассчитать общий размер всех PST-файлов, указанных в CSV-файле (в КБ). После этого вы можете использовать калькулятор преобразования, чтобы преобразовать общий размер в мегабайты (МБ) или гигабайт (ГБ). 
  
- **\>__ Жобнаме Find\<датетиместамп\>. XML — XML-файл содержит сведения о значениях параметров, которые использовались при запуске средства \<** в режиме поиска. Этот файл также содержит сведения о каждом найденном PST-файле. Данные в этом файле используются при повторном запуске средства для того же задания, чтобы заблокировать, собрать или удалить найденные PST-файлы. Этот файл создается в папке, указанной `ConfigurationLocation` параметром. 
    
    > [!IMPORTANT]
    > Не переименовывайте, не меняйте и не перемещайте этот файл. Он используется средством сбора PST-файлов при повторном запуске средства в режиме блокировки, копирования или удаления для того же задания. 

## <a name="optional-step-2-control-access-to-pst-files"></a>Необязательно Шаг 2: Управление доступом к PST-файлам

Это необязательный шаг позволяет "заблокировать" PST-файлы, найденные на этапе 1, чтобы вы могли собрать и импортировать известный набор PST-файлов в Office 365. При запуске средства сбора PST-файлов в блочном режиме происходят следующие действия: 
  
- Средство создает объект групповой политики (GPO) с именем " *элементы управления использованием PST* ". Этот объект групповой политики связан с доменом и применяется ко всем пользователям, прошедшим проверку подлинности в Организации. 
    
- ОБЪЕКТ групповой политики для управления использованием PST-файлов создает параметры реестра на компьютерах в Организации. В зависимости от используемого параметра можно создать параметр реестра, чтобы запретить пользователям создавать новые PST-файлы и параметры реестра, которые запрещают пользователям изменять существующие PST-файлы.
    
> [!NOTE]
> Если управление доступом к PST-файлам слишком мало для вашей организации, вы можете пропустить этот шаг и выполнить шаг 3 для копирования PST-файлов в центральное расположение. После этого вы можете повторить шаг 1 для того же задания (с помощью `ForceRestart` параметра), чтобы найти дополнительные PST-файлы, созданные после копирования PST-файлов в расположение коллекции. Если будут найдены новые PST-файлы, их можно скопировать в расположение коллекции. При использовании `ForceRestart` параметра при повторном запуске средства в режиме поиска результаты из предыдущей операции поиска для задания будут удалены, а средство повторно проверит указанные расположения. 

Чтобы заблокировать доступ к PST-файлам, выполните указанные ниже действия.

1. Откройте командную строку (Запуск от имени администратора) на локальном компьютере.
    
2. Перейдите в каталог, в который вы скачали средство сбора PST-файлов.
    
3. Выполните следующую команду, чтобы заблокировать доступ к PST-файлам, найденным на шаге 1.

    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Block -JobName <Name of job from Step 1> -ConfigurationLocation <Location of configuration files from Step 1> -BlockChangesToFiles -BlockNewFiles
    ```

    В следующей таблице описываются параметры и их обязательные значения при выполнении команды Датаколлектормастер. exe для блокирования создания и изменения PST-файлов. 
    
    |Параметр * * * *|****Описание****|Примеры * * * *|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |Указывает тип данных, которые требуется найти. В настоящее время вы можете использовать средство сбора PST-файлов для поиска PST-файлов.  <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |Указывает тип операции, которую будет выполнять средство. Используйте значение `Block` , чтобы запретить пользователям создавать новые PST-файлы и вносить изменения в существующие PST-файлы.  <br/> | `-Mode Block` <br/> |
    | `JobName` <br/> |Задает имя существующего задания сбора PST-файлов. Необходимо использовать такое же имя задания, которое использовалось при запуске средства в режиме поиска на шаге 1. Это имя задания также добавляется в имя файла журнала, который создается при запуске средства в режиме блокировки.  <br/> | `-JobName PstSearch1` <br/> |
    | `ConfigurationLocation` <br/> |Указывает папку, в которой находится XML-файл конфигурации, созданный при запуске средства в режиме поиска. Используйте то же значение, которое использовалось для этого параметра на шаге 1.  <br/> | `-ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration"` <br/> |
    | `LogLocation` <br/> |Указывает папку, в которую будет скопирован файл журнала для операции блокировки. Это необязательный параметр. Если он не указан, файл журнала копируется в папку, в которую вы скачали средство сбора PST-файлов. Рекомендуется использовать тот же путь к журналу, который использовался при запуске средства в режиме поиска на шаге 1, чтобы все файлы журнала сохранялись в одной папке.  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `BlockChangesToFiles` <br/> |Используйте этот параметр, чтобы запретить пользователям изменять PST-файл. При использовании этого параметра создается следующая запись реестра: `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\PST\PstDisableGrow` значение 1. Этот параметр реестра создается на компьютерах в Организации с помощью объекта групповой политики, созданного при запуске средства сбора PST-файлов в режиме блокировки.  <br/> | `-BlockChangesToFiles` <br/> |
    | `BlockNewFiles` <br/> |Используйте этот параметр, чтобы запретить пользователям создавать новые PST-файлы, открывать и импортировать PST-файлы в Outlook и экспортировать PST-файлы из Outlook. При использовании этого параметра создается следующая запись реестра: `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\DisablePst` значение 1. Этот параметр реестра создается на компьютерах в Организации с помощью объекта групповой политики, созданного при запуске средства сбора PST-файлов в режиме блокировки.  <br/> | `-BlockNewFiles` <br/> |
   
    Ниже приведен пример синтаксиса для команды Датаколлектормастер. exe, использующей фактические значения для каждого параметра:

    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Block -JobName PstSearch1 -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration" -LogLocation "c:\users\admin\desktop\PSTCollection" -BlockChangesToFiles -BlockNewFiles
    ```
    
    Вам будет предложено подтвердить блокировку новых PST-файлов или изменений существующих PST-файлов. После подтверждения того, что вы хотите продолжить и успешное выполнение команды, появится сообщение о том, что создан новый объект групповой политики с именем "элементы управления использованием PST".
    
## <a name="step-3-copy-the-pst-files-to-a-collection-location"></a>Шаг 3: копирование PST-файлов в расположение коллекции

Следующий шаг — копирование PST-файлов, которые были найдены при запуске средства сбора PST-файлов в режиме поиска. Это позволяет собирать PST-файлы в одном расположении, чтобы позже можно было импортировать их в Office 365. Перед копированием PST-файлов в расположение для сбора целесообразно определить общий объем дискового пространства, который требуется. Это можно сделать с помощью CSV-файла, созданного на шаге 1, чтобы рассчитать общий размер всех PST-файлов.
  
> [!NOTE]
> После того как вы импортировали PST-файлы в Office 365 и удалили их из исходного расположения, вы можете удалить их из расположения, скопированного на этом шаге. 
  
1. Откройте командную строку (Запуск от имени администратора) на локальном компьютере.
    
2. Перейдите в каталог, в который вы скачали средство сбора PST-файлов.
    
3. Выполните следующую команду, чтобы скопировать PST-файлы в указанное расположение.
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Collect -JobName <Name of job from Step 1> -Locations <same locations from Step 1> -ConfigurationLocation <Location of configuration files from Step 1> -CopyLocation <Location to copy PST files to>
    ```

    В следующей таблице описываются параметры и их обязательные значения при выполнении команды Датаколлектормастер. exe для копирования PST-файлов. 
    
    |Параметр * * * *|****Описание****|Примеры * * * *|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |Указывает тип данных, которые требуется найти. В настоящее время вы можете использовать средство сбора PST-файлов для поиска PST-файлов.  <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |Указывает тип операции, которую будет выполнять средство. Используйте значение `Collect` для копирования PST-файлов, найденных при запуске средства в режиме поиска. Обратите внимание, что средство может копировать PST-файлы, открытые в Outlook, и копировать PST-файлы, подключенные к профилям Outlook.  <br/> | `-Mode Collect` <br/> |
    | `JobName` <br/> |Задает имя существующего задания сбора PST-файлов. Необходимо использовать такое же имя задания, которое использовалось при запуске средства в режиме поиска на шаге 1. Это имя задания также добавляется в имя файла журнала, который создается при запуске средства в режиме сбора данных.  <br/> | `-JobName PstSearch1` <br/> |
    | `Locations` <br/> |Используйте то же значение, что и для параметра `Locations` , приведенного в шаге 1. Этот параметр включен при запуске средства в режиме сбора, если необходимо повторно запустить средство для удаления PST-файлов из исходного расположения на этапе 5.  <br/> | `-Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com"; "CN=FILESERVER02,CN=Computers,DC=contoso,DC=com"` <br/> |
    | `ConfigurationLocation` <br/> |Указывает папку, которая содержит XML-файл конфигурации, созданный при запуске средства в режиме поиска. Используйте то же значение, которое использовалось для этого параметра на шаге 1.  <br/> | `-ConfigurationLocation "c:\users\admin\desktop \PSTCollection\Configuration"` <br/> |
    | `CopyLocation` <br/> |Задает расположение коллекции, в которую будут скопированы PST-файлы. Можно копировать файлы на файловый сервер, в общую сетевую папку или на жесткий диск. Расположение должно существовать до запуска средства в режиме сбора данных. Средство не создает расположение и возвращает сообщение об ошибке, сообщающее о том, что оно не существует.  <br/> Кроме того, необходимо записать разрешения в расположение коллекции, заданное этим параметром.  <br/> | `-CopyLocation "\\FILESERVER03\PSTs"` <br/> |
    | `LogLocation` <br/> |Указывает папку, в которую будет скопирован файл журнала для режима сбора. Это необязательный параметр. Если он не указан, файл журнала копируется в папку, в которую вы скачали средство сбора PST-файлов. Рекомендуется использовать тот же путь к журналу, который использовался при запуске средства в режиме поиска на шаге 1, чтобы все файлы журнала сохранялись в одной папке.  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `ForceRestart` <br/> |Этот необязательный параметр позволяет повторно запустить средство в режиме коллекции для существующего задания сбора PST-файлов. Если вы ранее запустили средство в режиме сбора, а затем снова запустили его в режиме поиска с `ForceRestart` переключателем для повторного сканирования расположений для PST-файлов, можно использовать этот параметр для повторного запуска средства в режиме сбора и повторного копирования PST-файлов, обнаруженных при повторно просканировать расположения; При использовании `ForceRestart` параметра в режиме сбора средство игнорирует все предыдущие операции сбора и пытается скопировать PST-файлы с нуля.  <br/> | `-ForceRestart` <br/> |
   
    Ниже приведен пример синтаксиса для средства Датаколлектормастер. exe, использующего фактические значения для каждого параметра:
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Collect -JobName PstSearch1 -Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com";"CN=FILESERVER02,CN=Computers,DC=contoso,DC=com" -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration" -CopyLocation "\\FILESERVER03\PSTs" -LogLocation "c:\users\admin\desktop\PSTCollection"
    ```

    После выполнения команды отображаются подробные сообщения о состоянии, в которых отображаются сведения о ходе сбора PST-файлов, найденных на шаге 1. Через некоторое время в итоговое сообщение о состоянии отображается сообщение о том, что возникли ошибки, и место, куда копируется журнал. Такие же сообщения о состоянии копируются в файл журнала.
    
### <a name="results-of-running-datacollectormasterexe-in-the-collect-mode"></a>Результаты выполнения Датаколлектормастер. exe в режиме сбора

После успешного выполнения Датаколлектормастер. exe в режиме сбора создаются следующие файлы и хранятся в папках, заданных параметрами `LogLocation` и. `ConfigurationLocation` 
  
- **\>__ Жобнаме собрать\<датетиместамп\>. log — файл журнала содержит отображаемые \<** сообщения о состоянии. Этот файл создается в папке, указанной `LogLocation` параметром. 
    
- **\>__ Жобнаме Collect\<датетиместамп\>. XML — XML-файл содержит сведения о значениях параметров, которые используются средством при запуске \<** в режиме сбора. Данные в этом файле используются при выполнении повторного запуска средства Датаколлектормастер. exe для удаления PST-файлов; см. [Шаг 5](#step-5-delete-the-pst-files-found-on-your-network).
    

## <a name="step-4-import-the-pst-files-to-office-365"></a>Шаг 4: Импорт PST-файлов в Office 365

После того как вы собрали PST-файлы, найденные на этапе 1, необходимо импортировать их в почтовые ящики в Office 365. В процессе импорта вам потребуется создать файл сопоставления CSV, содержащий строку каждого PST-файла, который требуется импортировать. Информация в каждой строке указывает имя PST-файла, адрес электронной почты пользователя и необходимость импортировать PST-файл в основной или архивный почтовый ящик пользователя. Используйте сведения из файла **жобнаме\>_Find_\<датетиместамп. csv** (созданного на шаге) 1, чтобы создать CSV-файл сопоставления. 
  
Пошаговые инструкции по импорту PST-файлов в Office 365 можно найти в следующих статьях:
  
- [Импорт PST-файлов в Office 365 с помощью отправки по сети](use-network-upload-to-import-pst-files.md)
    
- [Импорт PST-файлов в Office 365 с помощью отправки дисков](use-drive-shipping-to-import-pst-files-to-office-365.md)
    

## <a name="step-5-delete-the-pst-files-found-on-your-network"></a>Шаг 5: Удаление PST-файлов, найденных в сети

После импорта PST-файлов, которые вы нашли и собрали, в почтовые ящики Exchange Online в Office 365 можно использовать средство коллекция PST-файлов для удаления PST-файлов из исходных расположений, где они были найдены на шаге 1. 
  
1. Откройте командную строку (Запуск от имени администратора) на локальном компьютере.
    
2. Перейдите в каталог, в который вы скачали средство сбора PST-файлов.
    
3. Выполните следующую команду, чтобы удалить PST-файлы.

    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Delete -JobName <Name of job from Step 1> -ConfigurationLocation <Location of configuration files from Step 1> -CopyLocation <Location to copy PST files to>
    ```

    В следующей таблице описываются параметры и их обязательные значения при выполнении команды Датаколлектормастер. exe для удаления PST-файлов. 
    
    |Параметр * * * *|****Описание****|Примеры * * * *|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |Указывает тип данных, которые требуется найти. В настоящее время вы можете использовать средство сбора PST-файлов для поиска PST-файлов. ![располнитель](media/b078d05c-3aee-4b9f-8805-6a8a9d8970ee.png)           <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |Указывает тип операции, которую будет выполнять средство. Используйте значение `Delete` , чтобы удалить PST-файлы, найденные при запуске средства в режиме поиска.  <br/> | `-Mode Delete` <br/> |
    | `JobName` <br/> |Задает имя существующего задания сбора PST-файлов. Необходимо использовать такое же имя задания, которое использовалось при запуске средства в режиме поиска и в режиме сбора на этапе 1 и на шаге 3. Это имя задания также добавляется в имя файла журнала, который создается при запуске средства в режиме удаления.  <br/> | `-JobName PstSearch1` <br/> |
    | `ConfigurationLocation` <br/> |Указывает папку, которая содержит XML-файл конфигурации, созданный при запуске средства в режиме сбора. Используйте то же значение, которое использовалось для этого параметра на шаге 3.  <br/> | `-ConfigurationLocation "c:\users\admin\ desktop\PSTCollection\Configuration"` <br/> |
    | `LogLocation` <br/> |Указывает папку, в которую будет скопирован файл журнала для режима удаления. Это необязательный параметр. Если он не указан, файл журнала копируется в папку, в которую вы скачали средство сбора PST-файлов. РасСмотрите использование того же расположения журнала, которое использовалось при запуске средства в режимах "найти и собрать" на этапе 1 и 3, чтобы все файлы журнала сохранялись в одной папке.  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `ForceRestart` <br/> |Этот необязательный параметр позволяет повторно запустить средство в режиме удаления для существующего задания сбора PST-файлов. Если вы ранее запустили средство в режиме удаления, а затем снова запустили его в режиме поиска с `ForceRestart` параметром для повторного сканирования расположений для PST-файлов, можно использовать этот параметр для повторного запуска средства в режиме удаления и удаления PST-файлов, найденных при повторной связи. ннед расположения. При использовании `ForceRestart` параметра в режиме удаления средство игнорирует все предыдущие операции удаления и пытается снова удалить PST-файлы.  <br/> | `-ForceRestart` <br/> 

    Ниже приведен пример синтаксиса для средства Датаколлектормастер. exe, использующего фактические значения для каждого параметра:
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Delete -JobName PstSearch1 -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration" -LogLocation "c:\users\admin\desktop\PSTCollection"
    ```
   
    После выполнения команды отображаются подробные сообщения о состоянии, показывающие ход удаления PST-файлов, найденных на этапе 1 и собранных на шаге 3. Через некоторое время в итоговое сообщение о состоянии отображается сообщение о том, что возникли ошибки, и место, куда копируется журнал. Такие же сообщения о состоянии копируются в файл журнала.
    
### <a name="results-of-running-datacollectormasterexe-in-the-delete-mode"></a>Результаты выполнения Датаколлектормастер. exe в режиме удаления

После успешного выполнения Датаколлектормастер. exe в режиме Delete создаются следующие файлы и сохраняются в папке, заданной параметрами `LogLocation` и. `ConfigurationLocation` 
  
- **\>__ Жобнаме DELETE\<датетиместамп\>. log — файл журнала содержит отображаемые \<** сообщения о состоянии. Этот файл создается в папке, указанной `LogLocation` параметром. 
    
- **\>__ Жобнаме DELETE\<датетиместамп\>. XML — XML-файл содержит сведения о значениях параметров, которые используются средством \<** в режиме удаления. Кроме того, в нем указаны имя и путь к файлам каждого удаленного PST-файла. Этот файл создается в папке, указанной `ConfigurationLocation` параметром. 
