---
title: Удаление элементов в папке элементов для восстановления облачные почтовые ящики на удержание - Admin справки
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
ms.audience: Admin
ms.topic: article
ms.service: o365-administration
localization_priority: Normal
ms.collection: Strat_O365_IP
search.appverid:
- MOE150
- MET150
ms.assetid: a85e1c87-a48e-4715-bfa9-d5275cde67b0
description: 'Для администраторов: удаление элементов в папке элементов для восстановления пользователя почтовый ящик Exchange Online, даже в том случае, если этот почтовый ящик размещен на удержания по юридическим причинам. Это эффективный способ удаления данных, который является был случайно распределяются в Office 365.'
ms.openlocfilehash: a10965ad088da98b4e4d84d823c124e5b192d505
ms.sourcegitcommit: b164d4af65709133e0b512a4327a70fae13a974d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/16/2018
ms.locfileid: "25577088"
---
# <a name="delete-items-in-the-recoverable-items-folder-of-cloud-based-mailboxes-on-hold---admin-help"></a>Удаление элементов в папке элементов для восстановления облачные почтовые ящики на удержание - Admin справки

Для защиты от случайного или намеренного удаления существует папка элементов для восстановления для почтовый ящик Exchange Online. Он также используется для хранения элементов, которые сохраняются и доступна для функции контроля соответствия требованиям Office 365, такие как удержания и eDiscovery операций поиска. Тем не менее в некоторых случаях организации могут иметь данные, которые были случайно сохраняется в папке элементов для восстановления, их необходимо удалить. К примеру пользователь может непреднамеренно отправить или пересылать сообщения электронной почты, который содержит конфиденциальные сведения или сведения, которые могут иметь business серьезные последствия. Даже в том случае, если сообщение будет удалено без возможности восстановления, его может храниться неограниченное время так как удержания по юридическим причинам было помещено в почтовый ящик. Этот сценарий называется spillage данных, так как данные были случайно распределяются в Office 365. В таких случаях можно удалить элементы в папке элементов для восстановления пользователя почтовый ящик Exchange Online даже в том случае, если этот почтовый ящик ставится на удержание с одним из разных удержания функции в Office 365. Эти типы удержаний включают Судебное удержание, удержание на месте, удержание электронных данных и политики хранения Office 365, созданные в Office 365 безопасность &amp; центре соответствия требованиям. 
  
 В этой статье объясняется, как удалить элементы из папки элементов для восстановления для облачные почтовые ящики, которые находятся на удержании. Эта процедура состоит из отключение доступа к почтовому ящику и отключить функцию восстановления отдельных элементов, отключение помощника для управляемых папок из обработки почтового ящика, временное удаление удержания, удаление элементов из папки элементов для восстановления и затем возврат почтовый ящик, чтобы его предыдущую конфигурацию. Вот как это делается: 
  
[Этап 1: Сбор информации о почтовом ящике](#step-1-collect-information-about-the-mailbox)

[Шаг 2: Подготовка почтового ящика](#step-2-prepare-the-mailbox)

[Шаг 3: Удаление всех удержаний из почтового ящика](#step-3-remove-all-holds-from-the-mailbox)

[Шаг 4: Снимать хранение задержки из почтового ящика](#step-4-remove-the-delay-hold-from-the-mailbox)

[Шаг 5: Удаление элементов в папке элементов для восстановления](#step-5-delete-items-in-the-recoverable-items-folder)

[Шаг 6: Возврат в предыдущее состояние почтового ящика](#step-6-revert-the-mailbox-to-its-previous-state)
  
> [!CAUTION]
> Процедуры, приведенные в этой статье приведет к данных, окончательно удалены (очистка) из почтовый ящик Exchange Online. Это означает, что сообщения, удалите из папки элементов для восстановления нельзя восстановить и не будут доступны для законодательной проверки или других целях соответствия требованиям. Если вы хотите удалить сообщения из почтового ящика, помещенные на удержание как часть Судебное удержание, хранение на месте, удержание электронных данных или политики хранения Office 365, созданные в Office 365 безопасность &amp; центре соответствия требованиям, проверка с помощью управления записями или legal отделы перед удалением удержания. Ваша организация может иметь политики, которая определяет, будет ли почтовый ящик на хранение или приоритет запроса технической spillage данных. 
  
## <a name="before-you-begin"></a>Перед началом работы

- Необходимо назначить обе следующие роли управления в Exchange Online для поиска и удаления сообщений из папки восстанавливаемых элементов на шаге 5.
    
  - **Поиск в почтовых ящиках** — эта роль позволяет выполнять поиск почтовых ящиков в организации. Администраторы Exchange не назначается эта роль по умолчанию. Чтобы назначить себя эта роль, добавьте себя в качестве должна быть членом группы ролей управления обнаружения в Exchange Online. 
    
  - **Импорт и экспорт почтового ящика** — эта роль позволяет удалить сообщения из почтового ящика пользователя. По умолчанию эта роль не будет назначен группе ролей. Для удаления сообщений из почтовых ящиков пользователей, можно добавить роли почтового ящика Импорт и экспорт в группу ролей управления организацией в Exchange Online. 
    
- Процедуры, описанные в этой статье не поддерживается для неактивные почтовые ящики. Который является, поскольку не может повторно применить удержания (или политики хранения Office 365) для неактивного почтового ящика после его удаления. При удалении удержания из неактивного почтового ящика изменено на обычных почтовых ящиков, удаленные и будут окончательно удалены из вашей организации после обработки помощником для управляемых папок.
    
- Невозможно выполнить эту процедуру для почтового ящика, которому назначена политика хранения Office 365, заблокирован с хранением блокировки. Это, поскольку сохранение блокировки не позволяет удалять или исключение почтового ящика из политики хранения Office 365 и отключение помощника для управляемых папок для почтового ящика. Дополнительные сведения о блокировке политики хранения в разделе [Блокировка политику хранения](retention-policies.md#locking-a-retention-policy).
    
- Если почтовый ящик не помещенных на удержание (или не включена функция восстановления отдельных элементов), можно просто удалить элементы из папки элементов для восстановления. Дополнительные сведения содержатся в разделе [Поиск и удаление сообщений ](https://go.microsoft.com/fwlink/?linkid=852453).
  
## <a name="step-1-collect-information-about-the-mailbox"></a>Этап 1: Сбор информации о почтовом ящике

Это первый шаг состоит в сборе выбранных свойств из целевого почтового ящика, которые будут влиять на эту процедуру. Обязательно запишите эти параметры или сохранять их в текстовый файл, так как вы будете изменить некоторые из этих свойств и восстановить исходные значения на шаге 6, пока не будет удален из папки элементов для восстановления элементов. Ниже приведен список свойств почтового ящика, которые необходимо собрать.
  
-  *SingleItemRecoveryEnabled* и *RetainDeletedItemsFor* ; При необходимости можно отключить функцию восстановления одного и увеличить срок хранения удаленных элементов в шаге 3. 
    
-  *LitigationHoldEnabled* и *InPlaceHolds* ; необходимо определить всех удержаний, помещенные на почтовый ящик, чтобы временно удалить на шаге 3. Советы по идентификации удержания тип, который может располагаться на почтовый ящик в разделе [Дополнительные сведения](delete-items-in-the-recoverable-items-folder-of-mailboxes-on-hold.md#moreinfo) . 
    
Кроме того необходимо для получения параметров клиентского доступа почтового ящика, поэтому можно временно отключить их, владелец (или другим пользователям) во время этой процедуры нельзя доступ к почтовому ящику. И, наконец можно получить текущего размера и числа элементов в папке элементов для восстановления. После удаления элементов в папке элементов для восстановления в шаге 5, будет использовать эти сведения для убедитесь, что элементы были фактически удалены.
  
1. [Подключение к Exchange Online PowerShell](https://go.microsoft.com/fwlink/?linkid=396554). Необходимо использовать имя пользователя и пароль для учетной записи администратора, назначенную роли соответствующие управления в Exchange Online. 
    
2. Выполните следующую команду для получения сведений о функцию восстановления отдельных элементов и срока хранения удаленного элемента.

    ```
    Get-Mailbox <username> | FL SingleItemRecoveryEnabled,RetainDeletedItemsFor
    ```

   Если включить функцию восстановления отдельных элементов, вам придется отключить его в шаге 2. Если срок хранения удаленного элемента не задано в течение 30 дней (максимальное значение в Exchange Online), а затем может быть выше в шаге 2. 
    
3. Выполните следующую команду, чтобы получить параметры доступа для почтового ящика в почтовый ящик. 
    
    ```
    Get-CASMailbox <username> | FL EwsEnabled,ActiveSyncEnabled,MAPIEnabled,OWAEnabled,ImapEnabled,PopEnabled
    ```

   Будет отключить все эти методы доступа на шаге 2.
    
4. Выполните следующую команду для получения сведений об удержаниях и политик хранения Office 365, применяемых к почтовому ящику.
    
    ```
    Get-Mailbox <username> | FL LitigationHoldEnabled,InPlaceHolds
    ```


   > [!TIP]
    > Если в свойстве *InPlaceHolds* слишком много значений, и не все из них отображаются, можно выполнить `Get-Mailbox <username> | Select-Object -ExpandProperty InPlaceHolds` команду, чтобы отобразить каждое значение в отдельной строке. 
  
5. Выполните следующую команду для получения сведений о любые политики хранения всей организации Office 365. 

    ```
    Get-OrganizationConfig | FL InPlaceHolds
    ```
   Если в организации имеются какие-либо политики хранения всей организации Office 365, необходимо исключить почтового ящика из этих политик на шаге 3.

   > [!TIP]
    > Если в свойстве *InPlaceHolds* слишком много значений, и не все из них отображаются, можно выполнить `Get-OrganizationConfig | Select-Object -ExpandProperty InPlaceHolds` команду, чтобы отобразить каждое значение в отдельной строке. 
  
6. Выполните следующую команду для получения текущего размера и общее число элементов в папках и вложенных папок в папке элементов для восстановления в основной почтовый ящик пользователя. 

    ```
    Get-MailboxFolderStatistics <username> -FolderScope RecoverableItems | FL Name,FolderAndSubfolderSize,ItemsInFolderAndSubfolders
    ```

   Если включена архивный почтовый ящик пользователя, выполните следующую команду, чтобы получить размер и общее число элементов в папках и вложенных папок в папке папки в почтовом ящике архива. 

    ```s
    Get-MailboxFolderStatistics <username> -FolderScope RecoverableItems -Archive | FL Name,FolderAndSubfolderSize,ItemsInFolderAndSubfolders
    ```

   При удалении элементов на шаге 5, вы можете удалить или не удалять элементы в папке элементов для восстановления в основной архивного почтового ящика пользователя. Обратите внимание, что если для почтового ящика включена развертываемым архивации, элементы дополнительный архивного почтового ящика не будут удалены.
  
## <a name="step-2-prepare-the-mailbox"></a>Шаг 2: Подготовка почтового ящика

После сбора и сохранения сведений о почтовом ящике, следующий шаг состоит в подготовке почтового ящика, выполнив следующие действия: 
  
- **Отключение клиентского доступа к почтовому ящику** , чтобы владелец почтового ящика не может получить доступ к своему почтовому ящику и вносите никаких изменений в данных почтовых ящиков во время этой процедуры. 
    
- **Увеличить срок хранения удаленного элемента** до 30 дней (максимальное значение в Exchange Online), чтобы элементы не очищены из папки элементов для восстановления, прежде чем удалять их на шаге 5. 
    
- **Отключение восстановления одного элемента** , так что товаров не должны сохраняться (Длительность срока хранения удаленного элемента) пока не будет удален из папки восстанавливаемых элементов на шаге 5. 
    
- **Отключение помощника для управляемых папок** , чтобы она не обработки почтового ящика и сохранение элементов, которые удаляют на шаге 5. 
    
В Exchange Online PowerShell выполните следующие действия.
  
1. Выполните следующую команду, чтобы отключить все клиентского доступа к почтовому ящику. Синтаксис команды предполагается, что все методы доступа клиента были включены в почтовом ящике.

    ```   
    Set-CASMailbox <username> -EwsEnabled $false -ActiveSyncEnabled $false -MAPIEnabled $false -OWAEnabled $false -ImapEnabled $false -PopEnabled $false
    ```
   
   > [!NOTE]
    > Выполнение может занять до 60 минут, чтобы отключить все методы клиентского доступа к почтовому ящику. Обратите внимание на то, что отключение эти методы доступа к не будет отключаться владельца почтового ящика, которые в настоящее время входа в. Если владелец не будет выполнен, они будут иметь доступ к своему почтовому ящику после отключения эти методы доступа. 
  
2. Выполните следующую команду, чтобы увеличить срок хранения удаленного элемента более 30 дней. Это предполагает, что текущее значение меньше, чем 30 дней. 

    ```
    Set-Mailbox <username> -RetainDeletedItemsFor 30
    ```

3. Выполните следующую команду, чтобы отключить функцию восстановления отдельных элементов.
    
    ```
    Set-Mailbox <username> -SingleItemRecoveryEnabled $false
    ```

   > [!NOTE]
    > Выполнение может занять более 60 минут, чтобы отключить функцию восстановления отдельных элементов. Не удаляйте элементов в папке элементов для восстановления, пока не истечет этого периода. 
  
4. Выполните следующую команду, чтобы предотвратить помощника для управляемых папок обработки почтового ящика. Как объяснялось ранее можно отключить помощника для управляемых папок только в том случае, если политика хранения Office 365 с хранением блокировки не применяются к почтовому ящику. 

    ```
    Set-Mailbox <username> -ElcProcessingDisabled $true
    ```

## <a name="step-3-remove-all-holds-from-the-mailbox"></a>Шаг 3: Удаление всех удержаний из почтового ящика

— Это последний этап, прежде чем удалять элементы из папки элементов для восстановления для удаления всех удержаний (, определенного на шаге 1) на почтовый ящик. Чтобы элементы не могут быть сохранены, пока не будет удален из папки элементов для восстановления, необходимо удалить всех удержаний. В следующих разделах содержатся сведения об удалении различных типов удержаний для почтового ящика. Советы по идентификации удержания тип, который может располагаться на почтовый ящик в разделе [Дополнительные сведения](#more-information) . Для получения дополнительных сведений см. [как определить тип удержания помещенных на почтовый ящик Exchange Online](identify-a-hold-on-an-exchange-online-mailbox.md).
  
> [!CAUTION]
> Как было сказано ранее обратитесь к управлению записями или юридических отделов перед удалением удержания из почтового ящика. 
  
 ### <a name="litigation-hold"></a>Хранение для судебного разбирательства
  
Выполните следующую команду в Exchange Online PowerShell для удаления хранение для судебного разбирательства из почтового ящика.

```
Set-Mailbox <username> -LitigationHoldEnabled $false
```

   
> [!NOTE]
> Как и отключение методы доступа клиентов и восстановления отдельных элементов, он может занять до 60 минут для удаления хранение для судебного разбирательства. Не удалять элементы из папки элементов для восстановления, до истечения этого периода. 
  
 ### <a name="in-place-hold"></a>Хранение на месте
  
Выполните следующую команду в Exchange Online PowerShell для идентификации хранение на месте, которое размещается на почтовый ящик. Используйте идентификатор GUID для хранения на месте, который был определен на шаге 1. 

```
Get-MailboxSearch -InPlaceHoldIdentity <hold GUID> | FL Name
```
   
После определения хранение на месте, можно использовать Центр администрирования Exchange (EAC) или Exchange Online PowerShell для удаления почтового ящика из удержания. Для получения дополнительных сведений см. [Создание и удаление хранение на месте](https://go.microsoft.com/fwlink/?linkid=852668).
  
 ### <a name="office-365-retention-policies-applied-to-specific-mailboxes"></a>Office 365 хранения политик, применяемых к определенным почтовым ящикам
  
Выполните следующую команду [безопасности Office 365 &amp; PowerShell центр соответствия](https://go.microsoft.com/fwlink/?linkid=627084) определить политику хранения Office 365, которая применяется к почтовому ящику. Используйте идентификатор GUID (без учета `mbx` или `skp` префикс) для политики хранения, который был определен на шаге 1. 

```
Get-RetentionCompliancePolicy <retention policy GUID without prefix> | FL Name
```
   
После определения политики хранения, перейдите к **дате управления** \> **хранения** страницы в системы &amp; центре соответствия требованиям, изменить политику хранения, который был определен на предыдущем шаге и удалить почтовый ящик из списка получателей, включенных в политику хранения. 
  
 ### <a name="organization-wide-office-365-retention-policies"></a>Политики хранения всей организации Office 365
  
Всей организации и политики хранения Exchange всей Office 365, применяются для всех почтовых ящиков в организации. Они применяются на уровне организации (не на уровне почтового ящика) и возвращаются при запуске командлета **Get-OrganizationConfig** на шаге 1. Выполните следующую команду [безопасности &amp; PowerShell центр соответствия](https://go.microsoft.com/fwlink/?linkid=627084) для определения политик хранения всей организации Office 365. Используйте идентификатор GUID (без учета `mbx` префикс) для политики хранения всей организации, определенного на шаге 1. 

```
Get-RetentionCompliancePolicy <retention policy GUID without prefix> | FL Name
```

После определения политик хранения всей организации Office 365 перейдите к **дате управления** \> **хранения** страницы в системы &amp; центре соответствия требованиям, изменение каждой политики хранения всей организации, который был определен предыдущий шаг и добавьте почтовый ящик в список исключенных получателей. Это приведет к удалению из политики хранения почтового ящика пользователя. 

### <a name="office-365-retention-labels"></a>Office 365 хранения меток

Каждый раз, когда пользователь применяет метки, который настроен на сохранение контента или сохранить, а затем удалите содержимое в любую папку или элемент в свой почтовый ящик, свойства почтового ящика *ComplianceTagHoldApplied* имеет значение **True**. В этом случае считается, что почтовый ящик будет отложен, как если он был помещенные на хранение для судебного разбирательства или назначенные политики хранения к Office 365.

Чтобы просмотреть значение свойства *ComplianceTagHoldApplied* , выполните следующую команду в Exchange Online PowerShell:

```
Get-Mailbox <username> |FL ComplianceTagHoldApplied
```

Определив, что почтовый ящик находится на удержание, так как метка хранения применяется к папке или элемента, можно использовать средство поиска контента в безопасности & центре соответствия требованиям для поиска с меткой элементов с помощью условия поиска ComplianceTag. Для получения дополнительных сведений обратитесь к разделу «Условия поиска» в [запросах по ключевым словам и условия поиска для поиска контента](keyword-queries-and-search-conditions.md#conditions-for-common-properties).

Дополнительные сведения о подписи можно [меток Обзор Office 365](labels.md).

 ### <a name="ediscovery-case-holds"></a>содержит случая обнаружения электронных данных
  
Выполните следующие команды [безопасности &amp; PowerShell центр соответствия](https://go.microsoft.com/fwlink/?linkid=627084) для идентификации удержания, связанные с вариантом eDiscovery, которая применяется к почтовому ящику. Используйте идентификатор GUID (без учета `UniH` префикс) для обнаружения электронных данных удержания, определенным в шаге 1. Обратите внимание на то, что вторая команда отображает имя случая обнаружения электронных данных удержания с которым связан; Третья команда отображает имя удержания. 
  
```
$CaseHold = Get-CaseHoldPolicy <hold GUID without prefix>
```

```
Get-ComplianceCase $CaseHold.CaseId | FL Name
```

```
$CaseHold.Name
```

Определив имя случая обнаружения электронных данных и удержания, перейдите к **поиска &amp; расследования** \> страницы **обнаружения электронных данных** в системы &amp; центре соответствия требованиям, откройте регистр и удалить почтовый ящик из удержания. Дополнительные сведения можно [Управление вариантах eDiscovery безопасности Office 365 &amp; центре соответствия требованиям](manage-ediscovery-cases.md).
  
## <a name="step-4-remove-the-delay-hold-from-the-mailbox"></a>Шаг 4: Снимать хранение задержки из почтового ящика

После любого типа удержания из почтового ящика, значение свойства почтового ящика *DelayHoldApplied* имеет значение **True**. Это возникает всякий раз помощника для управляемых папок обрабатывается почтовый ящик и обнаруживает, что удержания был удален. Это называется *Задержка удержания* и означает, что фактическое удаление удержания задерживается 30-дневная для предотвращения распространения данных за окончательно удаляется из почтового ящика. (Задержка удержания предназначен для предоставления возможности поиска или восстановить элементы почтовых ящиков, которые будут очищены после удаления удержания "Администраторы".)  Когда удержания задержки располагается на почтовый ящик, почтовый ящик по-прежнему считается при удержании в течение неограниченного периода времени, как было ли почтовый ящик на хранение для судебного разбирательства. Через 30 дней после истечения срока действия delay удержания и Office 365 автоматически попытаться удалить удержание delay (путем установки свойства *DelayHoldApplied* значение **False**), чтобы фактически будет снято удержание. 

Прежде чем удалить элементы в шаге 5, необходимо удалить удержание задержки из почтового ящика. Во-первых определите, если задержка удержания будет применяться к почтовому ящику, выполнив следующую команду в Exchange Online PowerShell:

```
Get-Mailbox <username> | FL DelayHoldApplied
```

Если значение свойства *DelayHoldApplied* задано значение **False**, удержание задержка не был включен в почтовом ящике. Можно перейти к шагу 5 и удаление элементов в папке элементов для восстановления.

Если значение свойства *DelayHoldApplied* задано значение **True**, выполните следующую команду, чтобы удалить удержание задержки.

```
Set-Mailbox <username> -RemoveDelayHoldApplied
```
Обратите внимание на то, что вам должна быть назначена роль юридическое удержание в Exchange Online для использования параметра *RemoveDelayHoldApplied* .

## <a name="step-5-delete-items-in-the-recoverable-items-folder"></a>Шаг 5: Удаление элементов в папке элементов для восстановления

Теперь вы готовы к фактически удаление элементов в папке элементов для восстановления с помощью командлета [Search-Mailbox](https://go.microsoft.com/fwlink/?linkid=852595) в Exchange Online PowerShell. У вас есть три варианта при запуске командлета **Search-Mailbox** . 
  
- Копирование элементов в целевой почтовый ящик, прежде чем удалять их, в котором можно просмотреть элементы, при необходимости, прежде чем удалять их.
    
- Копирование элементов в целевой почтовый ящик и удалите их в одной команде.
    
- Удаление элементов без копирования их в целевой почтовый ящик. 
    
Обратите внимание, что элементы в папке элементов для восстановления в основной архивного почтового ящика пользователя удаляются при запуске ** Search-Mailbox ** командлета. Чтобы предотвратить это, можно указывать параметр *DoNotIncludeArchive* . Как было сказано ранее, если развертываемым архивации включенном для почтового ящика и ** Search-Mailbox ** командлет не удаленные элементы в дополнительный архивного почтового ящика. Дополнительные сведения о развертываемым архивацию, просматривать [Общие сведения о неограниченном архивировании в Office 365](unlimited-archiving.md).
  
> [!NOTE]
> Если вы включите поисковый запрос (используя параметр  *SearchQuery*  ), командлет **Search-Mailbox** вернет максимум 10 000 элементов. Поэтому, чтобы удалить более 10 000 элементов, может потребоваться выполнить команду **Search-Mailbox** несколько раз. 
  
В следующих примерах показано синтаксис команды для каждого из этих параметров. Используйте эти примеры, `-SearchQuery size>0` значение параметра, который удаляет все элементы из всех вложенных папок в папке элементов для восстановления. Если требуется удалить только элементы, которые соответствуют определенным условиям, можно также использовать параметр *SearchQuery* для указания других условий, такие как темы сообщения или диапазон дат. Просмотрите [другие примеры использования параметр SearchQuery](#other-examples-of-using-the-searchquery-parameter) ниже. 
  
### <a name="example-1"></a>Пример 1

В этом примере копирует все элементы в папки восстанавливаемых элементов папки в почтовом ящике поиска обнаружения вашей организации. Это позволяет просматривать элементы перед их удалением без возможности восстановления.

```
Search-Mailbox <username> -SearchQuery size>0 -SearchDumpsterOnly -TargetMailbox "Discovery Search Mailbox" -TargetFolder "<foldername>"
```

В предыдущем примере он не требуется для копирования элементов в почтовый ящик поиска обнаружения. Можно скопировать сообщения любой целевой почтовый ящик. Тем не менее чтобы запретить доступ к данным потенциально конфиденциальных почтовых ящиков, рекомендуется копирование сообщений в почтовый ящик, который имеет доступ только авторизованный персонал. По умолчанию доступ к поиска почтового ящика обнаружения по умолчанию ограничен членов группы ролей управления обнаружения в Exchange Online. 
  
### <a name="example-2"></a>Пример 2

В этом примере копирует все элементы в папки восстанавливаемых элементов папки в почтовом ящике поиска обнаружения вашей организации, а затем удаляет элементы из папки элементов для восстановления.

```
Search-Mailbox <username> -SearchQuery size>0 -SearchDumpsterOnly -TargetMailbox "Discovery Search Mailbox" -TargetFolder "<foldername>" -DeleteContent
```
 
### <a name="example-3"></a>Пример 3

В этом примере удаляется все элементы в папке элементов для восстановления пользователя, без необходимости копирования их в целевой почтовый ящик. 

```
Search-Mailbox <username> -SearchQuery size>0 -SearchDumpsterOnly -DeleteContent
```

### <a name="other-examples-of-using-the-searchquery-parameter"></a>Другие примеры использования параметр SearchQuery

Вот несколько примеров использования параметр *SearchQuery* для поиска конкретных сообщений. Если параметр *SearchQuery* используется для поиска конкретных элементов, рассмотрите возможность копирования результатов поиска в целевой почтовый ящик, чтобы просмотреть результаты поиска и затем измените запрос при необходимости прежде чем удалять результаты поиска. 
  
Этот пример возвращает сообщения, которые содержат определенные фразу в поле Тема.
  
```
SearchQuery 'subject:"MAIL_BOX VALIDATION/UPGRADE!!!"' 
```

В этом примере возвращаются сообщений, отправленных в рамках за указанный диапазон дат.
  
```
SearchQuery 'sent>=06/01/2016 AND sent<=09/01/2016'
```
 
Этот пример возвращает сообщения, отправленные для указанного пользователя.

```
SearchQuery 'to:garthf@alpinehouse.com'
```
   
### <a name="verify-that-items-were-deleted"></a>Убедитесь, что элементы были удалены

Чтобы убедиться, что вы успешно удаленные элементы из папки элементов для восстановления почтового ящика, командлет **Get-MailboxFolderStatistics** в Exchange Online PowerShell Проверка размера и числа элементов в папке элементов для восстановления. Позволяет сравнивать статистику файлами, собранных на шаге 1. 
  
Выполните следующую команду для получения текущего размера и общее число элементов в папках и вложенных папок в папке элементов для восстановления в основной почтовый ящик пользователя. 
  
```
Get-MailboxFolderStatistics <username> -FolderScope RecoverableItems | FL Name,FolderAndSubfolderSize,ItemsInFolderAndSubfolders
```
   
Выполните следующую команду, чтобы получить размер и общее число элементов в папках и вложенных папок в папке элементов для восстановления в архивный почтовый ящик пользователя. 

```
Get-MailboxFolderStatistics <username> -FolderScope RecoverableItems -Archive | FL Name,FolderAndSubfolderSize,ItemsInFolderAndSubfolders
```
  
## <a name="step-6-revert-the-mailbox-to-its-previous-state"></a>Шаг 6: Возврат в предыдущее состояние почтового ящика

Последний этап заключается в возврат почтовых ящиков обратно в его предыдущую конфигурацию. Это означает, что сброс свойств, которые были изменены в шаге 2 и повторного применения удержаний, которые удалены в шаге 3. В том числе:
  
- Изменение срока хранения удаленного элемента назад к предыдущему значению. Кроме того можно просто оставить это значение 30 дней, максимальное значение в Exchange Online.
    
- Повторное включение восстановления одного элемента.
    
- Повторное включение методы доступа клиентов, чтобы владелец может получить доступ к своему почтовому ящику.
    
- Повторное применение удержаний и политики хранения Office 365, которые вы удалили.
    
- Повторное включение помощника для управляемых папок для обработки почтового ящика.
    
> [!IMPORTANT]
> Мы рекомендуем отложить 24 часа после повторного применения удержание или Office 365 хранения политики (и, проверка, что оно будет готова) прежде чем повторно включить помощника для управляемых папок для обработки почтового ящика. 
  
Выполните следующие действия (в указанной последовательности) в Exchange Online PowerShell.
  
1. Выполните следующую команду, чтобы изменить срок хранения удаленного элемента резервного исходное значение. Предполагается, что предыдущий параметр — меньше, чем 30 дней. Например, 14 дней. 
    
    ```
    Set-Mailbox <username> -RetainDeletedItemsFor 14
    ```
   
2. Выполните следующую команду, чтобы включить функцию восстановления отдельных элементов.
   
    ```
    Set-Mailbox <username> -SingleItemRecoveryEnabled $true
    ```

3. Выполните следующую команду, чтобы повторно включить все методы клиентского доступа к почтовому ящику.
    
    ```
    Set-CASMailbox <username> -EwsEnabled $true -ActiveSyncEnabled $true -MAPIEnabled $true -OWAEnabled $true -ImapEnabled $true -PopEnabled $true
    ```
   
4. Повторное применение удержаний, которые удалены в шаге 3. В зависимости от типа удержания используйте одну из следующих процедур.
    
    **Хранение для судебного разбирательства**
    
    Выполните следующую команду, чтобы повторно включить хранение для судебного разбирательства для почтового ящика.
    
    ```
    Set-Mailbox <username> -LitigationHoldEnabled $true
    ```

    **In-Place Hold**
    
    Использование центра администрирования Exchange (или Exchange Online PowerShell), чтобы добавить почтовый ящик обратно в режим хранения на месте. 
    
    **Office 365 хранения политик, применяемых к определенным почтовым ящикам**
    
    Использование безопасности &amp; центре соответствия требованиям, чтобы добавить почтовый ящик Office 365 политики хранения. Последовательно выберите пункты **Управление даты** \> **хранения** страницы в системы &amp; центре соответствия требованиям, изменить политику хранения и добавьте почтовый ящик в список получателей, к которым применяется политика хранения. 
    
    **Политики хранения всей организации Office 365**
    
    Если вы удалили всей организации или Exchange политики хранения, исключив из политики, используйте безопасности &amp; центре соответствия требованиям, чтобы удалить почтовый ящик из списка исключенных пользователей. Последовательно выберите пункты **Управление даты** \> **хранения** страницы в системы &amp; центре соответствия требованиям, изменить политику хранения всей организации и удалить почтовый ящик из списка исключенных получателей. При этом повторно применить политику хранения для почтового ящика пользователя. 
    
    **содержит случая обнаружения электронных данных**
    
    Использование безопасности &amp; центре соответствия требованиям, чтобы добавить почтовый ящик резервного удержания, связанной с вариантом eDiscovery. Последовательно выберите пункты **поиска &amp; расследования** \> страницы **обнаружения электронных данных** в системы &amp; центре соответствия требованиям, откройте регистр и добавить почтовый ящик в удержание. 
    
5. Выполните следующую команду, чтобы разрешить помощника для управляемых папок для обработки почтового ящика еще раз. Как уже упоминалось, рекомендуется отложить 24 часа после повторного применения удержание или Office 365 хранения политики (и, проверка, что оно будет готова) прежде чем повторно включить помощника для управляемых папок. 

    ```
    Set-Mailbox <username> -ElcProcessingDisabled $false
    ```
   
6. Чтобы убедиться в том, что почтовый ящик восстановлен обратно в его предыдущую конфигурацию, можно выполните следующие команды и сравните параметры тем, которые собираются на шаге 1.

    ```
    Get-Mailbox <username> | FL ElcProcessingDisabled,InPlaceHolds,LitigationHoldEnabled,RetainDeletedItemsFor,SingleItemRecoveryEnabled
    ```

    ```
    Get-CASMailbox <username> | FL EwsEnabled,ActiveSyncEnabled,MAPIEnabled,OWAEnabled,ImapEnabled,PopEnabled
    ```
  
## <a name="more-information"></a>Дополнительные сведения

Ниже приведена таблица, в которых описывается определение различных типов удержаний на основе значений в свойстве *InPlaceHolds* при запуске командлета **Get-Mailbox** или **Get-OrganizationConfig** . Для получения дополнительных сведений см. [как определить тип удержания помещенных на почтовый ящик Exchange Online](identify-a-hold-on-an-exchange-online-mailbox.md).

Как уже описано, необходимо удалить всех удержаний и политик хранения Office 365 из почтового ящика, прежде чем вы успешно можно удалить элементы в папке элементов для восстановления. 
  
|**Тип удержания**|**Пример значения**|**Как определить удержания**|
|:-----|:-----|:-----|
|Хранение для судебного разбирательства  <br/> | `True` <br/> |Свойство  *LitigationHoldEnabled*  имеет значение  `True`.  <br/> |
|Хранение на месте  <br/> | `c0ba3ce811b6432a8751430937152491` <br/> |Свойство *InPlaceHolds* содержит идентификатор GUID режима сохранения, помещенные на почтовый ящик. Чтобы узнать, что это хранение на месте, так как код GUID не начинается с префикса.<br/> С помощью команды  `Get-MailboxSearch -InPlaceHoldIdentity <hold GUID> | FL "в Exchange Online PowerShell для получения сведений о хранение на месте в почтовый ящик.  <br/> |
| Политики хранения Office 365 в безопасности &amp; центре соответствия требованиям применяется к определенным почтовым ящикам  <br/> | `mbxcdbbb86ce60342489bff371876e7f224` <br/> или  <br/>  `skp127d7cf1076947929bf136b7a2a8c36f` <br/> |При выполнении командлета **Get-Mailbox** , свойство *InPlaceHolds* также содержит политики хранения идентификаторов GUID Office 365, применяется к почтовому ящику. Можно определить политики хранения, так как код GUID начинается с `mbx` префикса. Обратите внимание, что если GUID политики хранения начинается с `skp` префикс, которое указывает, что политика хранения применяется к Скайп для бизнеса бесед.<br/> Политики хранения удостоверений Office 365, которая применяется к почтовому ящику, выполните следующую команду в безопасности &amp; PowerShell центр соответствия требованиям: <br/> <br/>"Get-RetentionCompliancePolicy<retention policy GUID without prefix> | Имя FL`<br/><br/>Be sure to remove the  `mbx` or  `skp "префикс при выполнении этой команды.  <br/> |
|Политики хранения всей организации Office 365 в безопасности &amp; центре соответствия требованиям  <br/> |Нет значения  <br/> или  <br/>  `-mbxe9b52bf7ab3b46a286308ecb29624696`(указывает на то, что почтовый ящик исключен из политики организации)  <br/> |Даже в том случае, если свойство *InPlaceHolds* пуст, при запуске командлета **Get-Mailbox** , по-прежнему могут возникнуть один или несколько всей организации Office 365 политики хранения применяется к почтовому ящику.  <br/> Чтобы проверить это, можно запустить "Get-OrganizationConfig | FL InPlaceHolds` command in Exchange Online PowerShell to get a list of the GUIDs for organization-wide Office 365 retention policies. The GUID for organization-wide retention policies applied to Exchange mailboxes start with the  `mbx` prefix; for example  `mbxa3056bb15562480fadb46ce523ff7b02`.  <br/> To identity the organization-wide Office 365 retention policy that's applied to the mailbox, run the following command in Security &amp; Compliance Center PowerShell: <br/><br/> `Get-RetentionCompliancePolicy<retention policy GUID without prefix> | Имя FL`<br/><br/>Note that if a mailbox is excluded from an organization-wide Office 365 retention policy, the GUID for the retention policy is displayed in the  *InPlaceHolds*  property of the user's mailbox when you run the **Get-Mailbox** cmdlet; it's identified by the prefix  `- mbx`; for example,  `-mbxe9b52bf7ab3b46a286308ecb29624696 " <br/> |
|хранение случая обнаружения электронных данных в безопасности &amp; центре соответствия требованиям  <br/> | `UniH7d895d48-7e23-4a8d-8346-533c3beac15d` <br/> |Свойство *InPlaceHolds* также содержит идентификатор GUID для любого удержания, связанные с вариантом eDiscovery в системы &amp; центре соответствия требованиям, который может располагаться на почтовый ящик. Можно указать это делами удержание электронных данных, так как код GUID начинается с `UniH` префикса.<br/> Можно использовать `Get-CaseHoldPolicy` командлет в безопасности &amp; PowerShell центр соответствия требованиям для получения сведений о случая обнаружения электронных данных, с которым связана удержание для почтового ящика. Например, можно выполнить команду "Get-CaseHoldPolicy<hold GUID without prefix> | Имя FL` to display the name of the case hold that's on the mailbox. Be sure to remove the  `UniH` prefix when you run this command.  <br/><br/> To identity the eDiscovery case that the hold on the mailbox is associated with, run the following commands:<br/><br/>`$CaseHold = Get-CaseHoldPolicy <hold GUID without prefix> `<br/><br/>`$CaseHold.CaseId Get-ComplianceCase | Имя FL "


